const pages={tools:{panel:{buildItem:function(e,t=null,n=null){let a=document.createElement("li"),s=document.createElement("a");return a.appendChild(s),s.classList.add("waves-effect"),t&&(s.href=t),n&&(s.onclick=n),s.innerText=e,a},buildLeftMenuItem:function(){}},buildNavigationPanel:function(){let e=document.getElementsByClassName("navbar-fixed")[0],t=document.getElementsByTagName("nav")[0];if(t.isDone)return t;t.classList=["light-blue lighten"];let n=document.createElement("div");if(n.classList.add("nav-wrapper"),t.appendChild(n),ui.isMobile()){let t=document.createElement("ul");n.appendChild(t);let a=document.createElement("li");t.appendChild(a);let s=document.createElement("a");s.classList.add("valign-wrapper"),a.appendChild(s),s.onclick=function(e){return ui.parseAction(s)},s.innerHTML='<i><svg id="nav_burger_icon" class="unt_icon" style="fill: white" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"></path><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg><svg id="nav_back_arrow_icon" style="fill: white" class="unt_icon" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"></path><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"></path></svg></i>';let l=document.createElement("div");l.id="nav_header_title",l.innerText="...",l.style.marginLeft="18px",s.appendChild(l);let i=document.createElement("ul");if(i.classList.add("sidenav"),i.id="langs",e.insertAdjacentElement("afterend",i),settings.users.current){let e=document.createElement("li");i.appendChild(e);let t=document.createElement("div");t.classList.add("user-view"),e.appendChild(t);let n=document.createElement("div");t.appendChild(n),n.classList.add("background"),n.style.background="currentColor";let a=document.createElement("a");a.href="/id"+settings.users.current.user_id,t.appendChild(a);let s=document.createElement("img");s.classList.add("circle"),s.id="user_avatar",s.alt="",s.src=settings.users.current.photo_url,a.appendChild(s);let l=document.createElement("a");l.href="/id"+settings.users.current.user_id,t.appendChild(l);let d=document.createElement("span");d.classList=["white-text name"],l.appendChild(d),d.innerText=settings.users.current.first_name+" "+settings.users.current.last_name;let r=document.createElement("a");r.href="/id"+settings.users.current.user_id,t.appendChild(r);let o=document.createElement("span");o.classList=["white-text email"],l.appendChild(o),settings.users.current.status&&(o.innerText=settings.users.current.status)}if(settings.users.current)return;i.appendChild(pages.tools.panel.buildItem(settings.lang.getValue("logstart"),"/",null)),i.appendChild(pages.tools.panel.buildItem("Русский",null,function(){return settings.lang.change("ru")})),i.appendChild(pages.tools.panel.buildItem("English",null,function(){return settings.lang.change("en")}))}else{let e=document.createElement("div");e.classList.add("container"),n.appendChild(e);let t=document.createElement("a");if(e.appendChild(t),t.classList.add("brand-logo"),t.innerText="dev.yunnet.ru"===window.location.host?"yunNet. Dev":"yunNet.",t.href="/","dev.yunnet.ru"===window.location.host)return;let a=document.createElement("ul");if(e.appendChild(a),a.id="langs_list",a.classList=["dropdown-content do-calc-width"],settings.users.current){let e=document.createElement("li");a.appendChild(e);let t=document.createElement("a");e.appendChild(t),t.classList.add("waves-effect"),t.href="/id"+settings.users.current.user_id;let n=document.createElement("div");n.classList.add("valign-wrapper"),t.appendChild(n);let s=document.createElement("img");s.classList.add("circle"),s.style.marginRight="10px",s.width=s.height=36,s.id="user_avatar",s.src=settings.users.current.photo_url,n.appendChild(s);let l=document.createElement("div");l.classList.add("profile-credentials"),n.appendChild(l),l.innerText=settings.users.current.first_name+" "+settings.users.current.last_name}settings.users.current?(settings.users.current.is_banned||(a.appendChild(pages.tools.panel.buildItem(settings.lang.getValue("edit"),"/edit",null)),a.appendChild(pages.tools.panel.buildItem(settings.lang.getValue("settings"),"/settings",null)),settings.users.current.user_level>0&&a.appendChild(pages.tools.panel.buildItem(settings.lang.getValue("management"),"/dev",null))),a.appendChild(pages.tools.panel.buildItem(settings.lang.getValue("logout"),null,function(){return settings.Logout(this)}))):(a.appendChild(pages.tools.panel.buildItem(settings.lang.getValue("logstart"),"/",null)),a.appendChild(pages.tools.panel.buildItem("Русский",null,function(){return settings.lang.change("ru")})),a.appendChild(pages.tools.panel.buildItem("English",null,function(){return settings.lang.change("en")})));let s=document.createElement("ul");s.classList.add("right"),e.appendChild(s);let l=document.createElement("li");s.appendChild(l);let i=document.createElement("a");i.classList.add("dropdown-trigger"),l.appendChild(i),i.id="langs",i.setAttribute("data-target","langs_list");let d=document.createElement("div");if(d.classList.add("valign-wrapper"),i.appendChild(d),settings.users.current){let e=document.createElement("img");e.classList.add("circle"),e.style.marginRight="10px",e.width=e.height=25,e.src=settings.users.current.photo_url,d.appendChild(e);let t=document.createElement("div");t.classList.add("profile-credentials"),d.appendChild(t),t.innerText=settings.users.current.first_name+" "+settings.users.current.last_name}else d.innerText=settings.lang.getValue("actions");let r=document.createElement("div");r.classList.add("arrow-icon"),d.appendChild(r),r.innerHTML='<i class="right"><svg class="unt_icon" style="fill: white" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M7 10l5 5 5-5z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></i>'}return t.isDone=!0,t},buildLeftMenu:function(){let e,t=ui.isMobile()?document.getElementById("langs"):document.getElementsByClassName("col s3")[0],n=[],a=[],s=[],l=[],i=[];if("dev.yunnet.ru"===window.location.host)n=["main","api","apps","bots"],a=["main","api","apps","bots"],l=["/","/methods","/apps","/bots"],s=['<svg class="unt_icon" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 4h5v8l-2.5-1.5L6 12V4z"/></svg>','<svg class="unt_icon" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"/></svg>','<svg class="unt_icon" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24" viewBox="0 0 24 24" width="24"><g><rect fill="none" height="24" width="24"/><path d="M17.6,9.48l1.84-3.18c0.16-0.31,0.04-0.69-0.26-0.85c-0.29-0.15-0.65-0.06-0.83,0.22l-1.88,3.24 c-2.86-1.21-6.08-1.21-8.94,0L5.65,5.67c-0.19-0.29-0.58-0.38-0.87-0.2C4.5,5.65,4.41,6.01,4.56,6.3L6.4,9.48 C3.3,11.25,1.28,14.44,1,18h22C22.72,14.44,20.7,11.25,17.6,9.48z M7,15.25c-0.69,0-1.25-0.56-1.25-1.25 c0-0.69,0.56-1.25,1.25-1.25S8.25,13.31,8.25,14C8.25,14.69,7.69,15.25,7,15.25z M17,15.25c-0.69,0-1.25-0.56-1.25-1.25 c0-0.69,0.56-1.25,1.25-1.25s1.25,0.56,1.25,1.25C18.25,14.69,17.69,15.25,17,15.25z"/></g></svg>','<svg class="unt_icon" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M20 3H4v10c0 2.21 1.79 4 4 4h6c2.21 0 4-1.79 4-4v-3h2c1.11 0 2-.9 2-2V5c0-1.11-.89-2-2-2zm0 5h-2V5h2v3zM4 19h16v2H4z"/></svg>'],i=[1,2,3,4];else{if(!settings.users.current)return;i=settings.currentSettings.theming.menu_items,n=["news","notifications","friends","messages","groups","archive","audios","settings"],a=["news_item","notifications_item","friends_item","messages_item","archive_item","audios_item","settings_item"],s=['<svg class="unt_icon" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/><path d="M0 0h24v24H0z" fill="none"/></svg>','<svg class="unt_icon" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/></svg>','<svg class="unt_icon" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/><path d="M0 0h24v24H0z" fill="none"/></svg>','<svg class="unt_icon" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/><path d="M0 0h24v24H0z" fill="none"/></svg>','<svg class="unt_icon" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24" viewBox="0 0 24 24" width="24"><rect fill="none" height="24" width="24"/><g><path d="M12,12.75c1.63,0,3.07,0.39,4.24,0.9c1.08,0.48,1.76,1.56,1.76,2.73L18,18H6l0-1.61c0-1.18,0.68-2.26,1.76-2.73 C8.93,13.14,10.37,12.75,12,12.75z M4,13c1.1,0,2-0.9,2-2c0-1.1-0.9-2-2-2s-2,0.9-2,2C2,12.1,2.9,13,4,13z M5.13,14.1 C4.76,14.04,4.39,14,4,14c-0.99,0-1.93,0.21-2.78,0.58C0.48,14.9,0,15.62,0,16.43V18l4.5,0v-1.61C4.5,15.56,4.73,14.78,5.13,14.1z M20,13c1.1,0,2-0.9,2-2c0-1.1-0.9-2-2-2s-2,0.9-2,2C18,12.1,18.9,13,20,13z M24,16.43c0-0.81-0.48-1.53-1.22-1.85 C21.93,14.21,20.99,14,20,14c-0.39,0-0.76,0.04-1.13,0.1c0.4,0.68,0.63,1.46,0.63,2.29V18l4.5,0V16.43z M12,6c1.66,0,3,1.34,3,3 c0,1.66-1.34,3-3,3s-3-1.34-3-3C9,7.34,10.34,6,12,6z"/></g></svg>','<svg class="unt_icon" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><path d="M0 0h24v24H0z" fill="none"/><path d="M0 0h24v24H0z" fill="none"/><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>','<svg class="unt_icon" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 3v9.28c-.47-.17-.97-.28-1.5-.28C8.01 12 6 14.01 6 16.5S8.01 21 10.5 21c2.31 0 4.2-1.75 4.45-4H15V6h4V3h-7z"/></svg>','<svg class="unt_icon" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24" viewBox="0 0 24 24" width="24"><g><path d="M0,0h24v24H0V0z" fill="none"/><path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/></g></svg>'],l=["/","/notifications","/friends","/messages","/groups","/archive","/audios","/settings"]}ui.isMobile()||((e=document.createElement("div")).classList.add("collection"),e.style.marginLeft="20%",t.appendChild(e)),i.forEach(function(a){if(settings.users.current&&settings.users.current.is_banned)return;let i=a-1;if(ui.isMobile()){let e=document.createElement("li"),a=document.createElement("a");e.appendChild(a),a.classList.add("waves-effect"),a.href=l[i],a.innerHTML="<i>"+s[i]+"</i>"+(settings.lang.getValue(n[i])||"API"),t.appendChild(e)}else{if(8===a)return;let t=document.createElement("a");t.classList=["collection-item waves-effect"],t.innerText=settings.lang.getValue(n[i])||"API",t.href=l[i],e.appendChild(t)}}),settings.users.current&&settings.users.current.user_level>0&&ui.isMobile()&&"dev.yunnet.ru"!==window.location.host&&t.appendChild(pages.tools.panel.buildItem(settings.lang.getValue("management"),"https://yunnet.ru/dev",null)),settings.users.current&&settings.users.current.is_banned&&ui.isMobile()&&"dev.yunnet.ru"!==window.location.host&&t.appendChild(pages.tools.panel.buildItem(settings.lang.getValue("logout"),null,function(){return settings.Logout(this)}))}},chats:{elements:{window:function(e=!0){let t=document.createElement("div");t.classList=["card full_section"];let n=document.createElement("div");t.appendChild(n),n.classList.add("valign-wrapper");let a=document.createElement("div"),s=new Image;a.appendChild(s),n.appendChild(a),s.width=s.height=64,s.alt="",s.classList.add("circle");let l=document.createElement("div");n.appendChild(l),l.style.width="100%",l.style.marginLeft="10px";let i=document.createElement("div");l.appendChild(i),i.classList.add("input-field");let d=document.createElement("input");if(i.appendChild(d),d.type="text",d.placeholder=settings.lang.getValue("chat_title"),e){let e=document.createElement("div");t.appendChild(e),e.style.width="100%";let n=pages.elements.createFAB(unt.Icon.SAVE,new Function);n.classList.remove("fixed-action-btn"),n.style.textAlign="end",e.appendChild(n),n.classList.add("scale-transition"),n.classList.add("scale-out"),t.getCreateButton=function(){return n};let a=pages.elements.getLoader();a.classList.remove("center"),a.style.textAlign="end",e.appendChild(a),a.style.display="none",t.setLoading=function(e){e?(n.style.display="none",a.style.display=""):(a.style.display="none",n.style.display="")}}return t},permissionsWindow:function(e={},t=null,n=!1,a=9){let s={can_change_title:4,can_change_photo:4,can_kick:7,can_invite:7,can_invite_bots:8,can_mute:5,can_pin_message:4,delete_messages_2:7,can_change_levels:9,can_link_join:0};for(let t in s)void 0!==e[t]&&e[t]>=0&&e[t]<=9&&(s[t]=e[t]);n&&(s=e);let l=document.createElement("ul");l.classList.add("collapsible");for(let e in s){let n=document.createElement("li");l.appendChild(n);let i=document.createElement("div");i.classList.add("collapsible-header"),n.appendChild(i),i.innerText=settings.lang.getValue(e);let d=document.createElement("div");d.classList.add("collapsible-body"),n.appendChild(d);let r=document.createElement("form");r.action="#",d.appendChild(r);for(let n=0;n<=a;n++){let a=document.createElement("p");r.appendChild(a);let l=document.createElement("label");a.appendChild(l);let i=document.createElement("input");i.oninput=function(){if(t)return t(e,n)},l.appendChild(i),i.classList.add("with-gap"),i.type="radio",i.name=e,n===s[e]&&i.setAttribute("checked","true");let d=document.createElement("span");l.appendChild(d),d.innerText=n}}return l}},create:function(e={}){if(!settings.users.current)return pages.news();let t=pages.elements.menuBody().clear();ui.isMobile()||(document.getElementsByClassName("col s3")[1].innerHTML=""),ui.urls.push("https://"+window.location.host+"/messages"),ui.canBack=!0,document.title="yunNet. - "+settings.lang.getValue("create_chat");let n=pages.elements.buildRightMenu().append(),a=n.addItem(settings.lang.getValue("main"),function(t){return e.section="main",pages.chats.create(e)}),s=n.addItem(settings.lang.getValue("info"),function(t){return e.section="info",pages.chats.create(e)});if(ui.isMobile())nav_burger_icon.style.display="none",nav_back_arrow_icon.style.display="",nav_header_title.innerText=settings.lang.getValue("create_chat");else{let e=settings.get();e&&e.theming.backButton&&!ui.isMobile()&&t.appendChild(pages.elements.backArrowButton(settings.lang.getValue("back")),function(e){return ui.go(null,!0)})}let l=e.data;l||(l=e.data={title:"",src:"https://dev.yunnet.ru/images/default.png",photo:"",members:[],permissions:{can_change_title:4,can_change_photo:4,can_kick:7,can_invite:7,can_invite_bots:8,can_mute:5,can_pin_message:4,delete_messages_2:7,can_change_levels:9,can_link_join:0}});let i="main";if(e.section&&(i=e.section),"main"===i){a.select();let n=pages.chats.elements.window();n.getElementsByTagName("input")[0].value=l.title,unt.updateTextFields(),n.getElementsByTagName("img")[0].src=l.src,n.getElementsByTagName("input")[0].oninput=function(){l.title=this.value,l.title.isEmpty()||l.members.length<2?n.getCreateButton().classList.add("scale-out"):n.getCreateButton().classList.remove("scale-out"),e.isCreating=!0},n.getElementsByTagName("img")[0].onclick=function(){return pages.elements.fileUploader({onFileSelected:function(t,a,s){return s.setLoading(!0),uploads.getURL().then(function(t){return uploads.upload(t,a[0],function(e){return codes.callbacks.uploadResolve(e,s)}).then(function(t){return s.setLoading(!1),e.data.photo="photo"+t.photo.owner_id+"_"+t.photo.id+"_"+t.photo.access_key,e.data.src=t.photo.url.main,n.getElementsByTagName("img")[0].src=l.src,s.close()}).catch(function(e){return s.setLoading(!1),unt.toast({html:settings.lang.getValue("upload_error")})})})},afterClose:function(){}}).open().addFooterItem(settings.lang.getValue("delete_a_photo"),function(t,a,s){return n.getElementsByTagName("img")[0].src="https://dev.yunnet.ru/images/default.png",e.data.src=n.getElementsByTagName("img")[0].src,e.data.photo="",s.close()})},t.appendChild(n);let s=pages.elements.getLoader();t.appendChild(s);let i=document.createElement("div");return i.style.display="none",i.classList=["card collection"],t.appendChild(i),l.title.isEmpty()||l.members.length<2?n.getCreateButton().classList.add("scale-out"):n.getCreateButton().classList.remove("scale-out"),n.getCreateButton().onclick=function(){return n.getElementsByTagName("input")[0].setAttribute("disabled","true"),n.getCreateButton().classList.add("scale-out"),i.style.display="none",n.setLoading(!0),messages.createChat(e.data).then(function(e){return ui.go("https://"+window.location.host+"/messages?s="+e)}).catch(function(t){n.getElementsByTagName("input")[0].removeAttribute("disabled"),n.getCreateButton().classList.remove("scale-out"),i.style.display="",n.setLoading(!1),e.isCreating=!1;let a=settings.lang.getValue("upload_error"),s=t.errorCode;return-1===s&&(a=settinga.lang.getValue("title_error")),-2===s&&(a=settings.lang.getValue("users_error")),unt.toast({html:a})})},settings.users.friends.get(settings.users.current.user_id,"friends",1).then(function(t){t.forEach(function(t){if(!t.can_invite_to_chat)return;let a=pages.elements.userItem(t);a.href="";let s=document.createElement("div");a.appendChild(s),s.classList.add("secondary-content");let d=document.createElement("form");s.appendChild(d);let r=document.createElement("p");d.appendChild(r);let o=document.createElement("label");r.appendChild(o);let c=document.createElement("input");c.type="checkbox",o.appendChild(c);let u=document.createElement("span");o.appendChild(u),u.innerHTML="",a.onclick=function(e){return e.preventDefault(),c.oninput(e)},c.oninput=function(){"checked"===c.getAttribute("checked")?c.removeAttribute("checked"):c.setAttribute("checked","checked"),-1===e.data.members.indexOf(t.user_id)?e.data.members.push(t.user_id):e.data.members.splice(e.data.members.indexOf(t.user_id),1),l.title.isEmpty()||l.members.length<2?n.getCreateButton().classList.add("scale-out"):n.getCreateButton().classList.remove("scale-out")},-1!==e.data.members.indexOf(t.user_id)&&c.setAttribute("checked","checked"),i.appendChild(a)}),s.hide(),i.style.display=""}).catch(function(e){let n=pages.elements.uploadError();i.style.display="none",t.appendChild(n),s.hide(),ui.bindItems()})}if("info"===i){s.select();let e=pages.chats.elements.permissionsWindow(l.permissions,function(e,t){void 0!==l.permissions[e]&&(t<0||t>9||(l.permissions[e]=t))});t.appendChild(e),unt.Collapsible.init(e)}console.log(l),e.data=l}},unauth:{banned:function(){if(!settings.users.current)return pages.news();if(!settings.users.current.is_banned)return pages.news();let e=pages.elements.menuBody().clear();document.title="yunNet. - "+settings.lang.getValue("banned");let t=document.createElement("div");e.appendChild(t),t.classList=["card full_section"];let n=document.createElement("div");t.appendChild(n),n.classList.add("center"),n.innerText=settings.users.current.first_name+", "+settings.lang.getValue("your_account_banned")},authPage:function(){if(settings.users.current)return pages.news();let e=pages.elements.menuBody().clear(),t=document.createElement("img");e.appendChild(t),t.src="https://yunnet.ru/favicon.ico",t.width=t.height=96,t.style.borderRadius="120px",t.style.boxShadow="0 0 2px black",t.style.marginLeft="calc(50% - 48px)",t.style.marginTop="10%",e.appendChild(document.createElement("br"));let n=document.createElement("div");e.appendChild(n),n.classList=["collection incorrect_message"],n.style.display="none";let a=document.createElement("a");n.appendChild(a),a.classList.add("collection-item"),a.style="background-color: #42a5f5 !important; color: white; margin-left: 3% !important; margin-right: 3% !important",a.innerHTML=settings.lang.getValue("incorrect_login");let s=document.createElement("div");ui.isMobile()||(s.style.width="400px",s.style.marginLeft="calc(50% - 200px)",s.classList.add("card")),e.appendChild(s);let l=document.createElement("form");s.appendChild(l),l.method="POST",l.name="login",l.classList.add("container"),l.action="/?action=login",l.appendChild(document.createElement("br"));let i=document.createElement("div");i.classList.add("input-field"),l.appendChild(i);let d=document.createElement("i");i.appendChild(d),d.innerHTML='<svg class="unt_icon" style="height: 40 !important" xmlns="http://www.w3.org/2000/svg" height="40" viewBox="0 0 32 32" width="40"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg>',d.classList.add("prefix");let r=document.createElement("input");i.appendChild(r),r.id="login_field",r.placeholder="E-mail or phone",r.placeholder=settings.lang.getValue("login"),r.type="email",r.name="email",r.autocomplete="off";let o=document.createElement("div");o.classList.add("input-field"),l.appendChild(o);let c=document.createElement("i");o.appendChild(c),c.innerHTML='<svg class="unt_icon" style="height: 40 !important" xmlns="http://www.w3.org/2000/svg" height="40" viewBox="0 0 32 32" width="40"><path d="M0 0h24v24H0z" fill="none"></path><path d="M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z"></path></svg>',c.classList.add("prefix");let u=document.createElement("input");o.appendChild(u),u.id="password_field",u.placeholder="Password",u.placeholder=settings.lang.getValue("password"),u.type="password",u.name="password",u.autocomplete="off";let p=document.createElement("div");l.appendChild(p),p.classList.add("center");let g=document.createElement("a");p.appendChild(g),g.href="/restore",g.innerText="Forgot password?",g.innerText=settings.lang.getValue("forgot_password"),l.appendChild(document.createElement("br"));let m=document.createElement("div");l.appendChild(m),m.classList.add("center");let h=document.createElement("button");m.appendChild(h),h.style.backgroundColor="#64b5f6 !important",h.classList=["btn modal-trigger waves-effect btn-large waves-light"];let f=document.createElement("div");h.appendChild(f),f.id="auth_text";let y=document.createElement("t");f.appendChild(y),y.innerText=settings.lang.getValue("logstart");let _=document.createElement("i");f.appendChild(_),_.innerHTML='<svg style="fill: white" class="unt_icon" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg>',_.classList.add("right"),_.style.marginTop="3px";let v=document.createElement("div");h.appendChild(v),v.style="display: none; margin-top: 20%",v.id="auth_loader";let w=document.createElement("div");v.appendChild(w),w.innerHTML='<svg width="40" height="40" viewBox="0 0 50 50"><path fill="white" transform="rotate(61.2513 25 25)" d="M25,5A20.14,20.14,0,0,1,45,22.88a2.51,2.51,0,0,0,2.49,2.26h0A2.52,2.52,0,0,0,50,22.33a25.14,25.14,0,0,0-50,0,2.52,2.52,0,0,0,2.5,2.81h0A2.51,2.51,0,0,0,5,22.88,20.14,20.14,0,0,1,25,5Z" fill="#42a5f5"><animateTransform attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.4s" repeatCount="indefinite"></animateTransform></path></svg>',h.onclick=function(e){return account.auth(h,e)},l.appendChild(document.createElement("br"));let E=document.createElement("div");l.appendChild(E),E.classList.add("center");let b=document.createElement("a");return E.appendChild(b),b.style.cursor="pointer",b.innerText=settings.lang.getValue("regstart"),b.onclick=function(e){return e.preventDefault(),pages.elements.confirm("",settings.lang.getValue("reg_privacy_warning"),function(e){if(e)return ui.go("https://"+window.location.host+"/register")})},l.appendChild(document.createElement("br")),ui.bindItems()}},cookies:function(){if(!settings.users.current)return pages.news();if(settings.users.current.is_banned)return pages.unauth.banned();ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("cookies_manage"));let e=pages.elements.menuBody().clear(),t=settings.get();t&&t.theming.backButton&&!ui.isMobile()&&ui.canBack&&e.appendChild(pages.elements.backArrowButton(settings.lang.getValue("cookies_manage")),function(e){return ui.go(null,!0)}),e.appendChild(pages.elements.createButton(null,null,null,"black",[[unt.Icon.COOKIE,settings.lang.getValue("cookies")+": <b>"+t.account.balance.cookies+"</b>",new Function],[unt.Icon.BITE_COOKIE,settings.lang.getValue("half_cookies")+": <b>"+t.account.balance.half_cookies+"</b>",new Function]]))},aboutPage:function(){ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("about"));let e=pages.elements.menuBody().clear(),t=settings.get();t&&t.theming.backButton&&!ui.isMobile()&&ui.canBack&&e.appendChild(pages.elements.backArrowButton(settings.lang.getValue("about")),function(e){return ui.go(null,!0)});let n=document.createElement("div");n.classList.add("card"),e.appendChild(n);let a=document.createElement("div");n.appendChild(a),a.style.width="100%";let s=new Image;s.counter=0,s.needed=8,s.onclick=function(){if(s.counter++,s.needed<=s.counter)return s.counter=0,welcome.to.something.out()},s.src="/favicon.ico",a.appendChild(s),s.classList.add("circle"),a.style.textAlign="-webkit-center",a.style.padding="20px",s.width=s.height=64;let l=document.createElement("div");n.appendChild(l),l.innerHTML="<b>yunNet.</b>",l.classList.add("center");let i=document.createElement("div");n.appendChild(i),i.innerHTML="<p>"+settings.lang.getValue("project-description")+"</p>";let d=document.createElement("i");d.classList.add("center"),i.appendChild(d),d.innerText="yunNet[alpha] 6.0.1 (2019-2021)",i.style.padding="20px";let r=pages.elements.getLoader();e.appendChild(r),settings.getStats().then(function(t){let n=pages.elements.createCollapsible([[unt.Icon.STATS,settings.lang.getValue("stats")]]),a=n.getBody(0),s=document.createElement("div");s.classList.add("collection"),a.appendChild(s);let l=document.createElement("div");l.classList.add("collection-item"),s.appendChild(l),l.innerText=settings.lang.getValue("registered_users")+": ";let i=document.createElement("b");l.appendChild(i),i.innerText=t.users.toLocaleString("en-US");let d=document.createElement("div");d.classList.add("collection-item"),s.appendChild(d),d.innerText=settings.lang.getValue("sent_messages")+": ";let o=document.createElement("b");d.appendChild(o),o.innerText=t.messages.toLocaleString("en-US");let c=document.createElement("div");c.classList.add("collection-item"),s.appendChild(c),c.innerText=settings.lang.getValue("registered_bots")+": ";let u=document.createElement("b");c.appendChild(u),u.innerText=t.bots.toLocaleString("en-US"),e.appendChild(n),unt.AutoInit(),r.hide()}).catch(function(e){return r.hide()})},chatsPage:function(e){if(settings.users.current&&settings.users.current.is_banned)return pages.unauth.banned();ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("chat")),document.title="yunNet. - "+settings.lang.getValue("chat");let t=pages.elements.menuBody().clear(),n=window.location.href.split(window.location.host)[1].split("?")[1].split("c=")[1],a=settings.get();a&&a.theming.backButton&&ui.canBack&&!ui.isMobile()&&t.appendChild(pages.elements.backArrowButton(settings.lang.getValue("chat")),function(e){return ui.go(null,!0)});let s=pages.elements.getLoader();return t.appendChild(s),s.style.marginTop="15px",messages.utils.getChatInfoByLink(n).then(function(e){s.hide();let a=document.createElement("div");a.classList.add("card"),a.classList.add("full_section"),a.classList.add("valign-wrapper"),a.style.width="100%",t.appendChild(a);let l=document.createElement("img");l.classList.add("circle"),l.width=l.height=64,l.src=e.photo,a.appendChild(l);let i=document.createElement("div");i.style.marginLeft="15px",i.style.width="100%",i.classList.add("halign-wrapper"),a.appendChild(i);let d=document.createElement("div");i.appendChild(d),d.style.width="calc(100% - 150px)",d.style.whiteSpace="nowrap",d.style.overflow="hidden",d.style.textOverflow="ellipsis";let r=document.createElement("b");d.appendChild(r),r.innerText=e.title;let o=document.createElement("div");i.appendChild(o),o.innerText=e.members_count+" "+("ru"===settings.lang.getValue("id")?pages.parsers.morph(e.members_count,pages.parsers.forms.MEMBERS_RUSSIAN):settings.lang.getValue("members")),settings.users.current?(t.appendChild(pages.elements.createButton(unt.Icon.SAVE,settings.lang.getValue("chat_join"),function(){let e=pages.elements.loadingMode().getInstance();return messages.utils.joinByLink(n).then(function(t){return e.close(),ui.go("https://"+window.location.host+"/messages?s="+t)}).catch(function(t){return e.close(),unt.toast({html:settings.lang.getValue("upload_error")})})})),ui.canBack&&t.appendChild(pages.elements.createButton(unt.Icon.CLOSE,settings.lang.getValue("cancel"),function(){return ui.go(null,!0)}),"red")):t.appendChild(pages.elements.createButton(unt.Icon.GROUP,settings.lang.getValue("login_to_join_chat"),function(){return pages.unauth.authPage()}))}).catch(function(e){if(s.hide(),1===e.errorCode)return t.appendChild(pages.elements.uploadError());if(2===e.errorCode)return ui.go("https://"+window.location.host+"/messages?s="+e.chatId);if(3===e.errorCode){let e=document.createElement("div");e.classList.add("card"),e.classList.add("full_section");let n=document.createElement("div");return e.appendChild(n),n.innerText=settings.lang.getValue("error_join"),n.classList.add("center"),t.appendChild(e)}})},rules:function(){ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("rules"));let e=pages.elements.menuBody().clear(),t=pages.elements.getLoader();t.style.marginTop="15px",e.appendChild(t);let n=new FormData;return n.append("action","get_rules_text"),ui.Request({url:"/rules",method:"POST",data:n,success:function(n){t.hide();try{if(rulesText=JSON.parse(n).rules,!rulesText)throw new Error;let t=document.createElement("div");return t.classList=["card full_section"],e.appendChild(t),t.innerHTML=rulesText}catch(t){return e.appendChild(pages.elements.uploadError())}}})},terms:function(){ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("terms"));let e=pages.elements.menuBody().clear(),t=pages.elements.getLoader();t.style.marginTop="15px",e.appendChild(t);let n=new FormData;return n.append("action","get_terms_text"),ui.Request({url:"/terms",method:"POST",data:n,success:function(n){t.hide();try{if(termsText=JSON.parse(n).terms,!termsText)throw new Error;let t=document.createElement("div");return t.classList=["card full_section"],e.appendChild(t),t.innerHTML=termsText}catch(t){return e.appendChild(pages.elements.uploadError())}}})},news:function(){if(!settings.users.current)return pages.unauth.authPage();if(settings.users.current.is_banned)return pages.unauth.banned();ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("news")),ui.userVisited=settings.users.current.user_id;let e=pages.elements.menuBody().clear(),t=pages.elements.wallInput({photoUrl:settings.users.current.photo_url,hideInputButton:!0,pasteCallback:function(e,n){return attachments.getElementsByTagName("div").length>=10?unt.toast({html:settings.lang.getValue("error_atts")}):uploads.getURL().then(function(e){return uploads.upload(e,n[0],function(e){}).then(function(e){return attachments.appendChild(pages.parsers.attachment(e,function(){return pages.parsers.attachmentsValid(attachments,write_text)?t.showInputButton():t.hideInputButton()})),pages.parsers.attachmentsValid(attachments,write_text)?t.showInputButton():t.hideInputButton()}).catch(function(e){let t=settings.lang.getValue("upload_error");unt.toast({html:t})})}).catch(function(e){let t=settings.lang.getValue("upload_error");unt.toast({html:t})})},attachFileCallback:function(e,n){return attachments.getElementsByTagName("div").length>=10?unt.toast({html:settings.lang.getValue("error_atts")}):pages.elements.contextMenu([[settings.lang.getValue("photo"),function(){return pages.elements.fileUploader({onFileSelected:function(e,n,a){return a.setLoading(!0),uploads.getURL().then(function(e){return uploads.upload(e,n[0],function(e){return codes.callbacks.uploadResolve(e,a)}).then(function(e){return a.setLoading(!1),attachments.appendChild(pages.parsers.attachment(e,function(){return pages.parsers.attachmentsValid(attachments,write_text)?t.showInputButton():t.hideInputButton()})),pages.parsers.attachmentsValid(attachments,write_text)?t.showInputButton():t.hideInputButton(),a.close()}).catch(function(e){let t=settings.lang.getValue("upload_error");return unt.toast({html:t}),a.setLoading(!1)})}).catch(function(e){let t=settings.lang.getValue("upload_error");return unt.toast({html:t}),a.setLoading(!1)})},afterClose:function(e,n){return pages.parsers.attachmentsValid(attachments,write_text)?t.showInputButton():t.hideInputButton()}}).open()}],[settings.lang.getValue("poll"),function(){return poll.pinned(attachments)?unt.toast({html:settings.lang.getValue("upload_error")}):poll.creator(function(e,n){let a=pages.elements.createPollElement(e.poll,function(){return pages.parsers.attachmentsValid(attachments,write_text)?t.showInputButton():t.hideInputButton()});return attachments.appendChild(a),pages.parsers.attachmentsValid(attachments,write_text)?t.showInputButton():t.hideInputButton()}).show()}]]).open(e,!0)},publishSettingsCallback:function(e,t){},publishCallback:function(e,n){let a=pages.parsers.attachmentsString(attachments);return(!String(document.getElementById("write_text").value).isEmpty()||!a.isEmpty())&&(n.setLoading(!0),posts.actions.create(ui.userVisited,String(document.getElementById("write_text").value),a).then(function(e){let a=pages.elements.post(e),s=document.getElementById("alertWindow");return s&&s.remove(),n.setLoading(!1),t.hideInputButton(),document.getElementById("write_text").value="",document.getElementById("write_text").innerHTML="",unt.updateTextFields(),attachments.innerHTML="",unt.Collapsible.getInstance(t).close(),news_list.style.display="",news_list.prepend(a)}).catch(function(e){n.setLoading(!1);let t=settings.lang.getValue("upload_error");return unt.toast({html:t})}))},inputTextCallback:function(e,n){return pages.parsers.attachmentsValid(attachments,write_text)?t.showInputButton():t.hideInputButton()}}),n=pages.elements.getLoader();e.innerHTML="",n.style.marginTop="20px",e.appendChild(t),e.appendChild(n),unt.updateTextFields();let a=document.createElement("div");return a.id="news_list",e.appendChild(a),a.style.display="none",posts.getAll(0,1,1).then(function(t){if(t.length>0){for(let e=0;e<t.length;e++){let n=pages.elements.post(t[e]);a.appendChild(n)}return n.hide(),ui.bindItems(),a.style.display=""}{let t=pages.elements.alertWindow(unt.Icon.CLEAR,settings.lang.getValue("no_posts"),settings.lang.getValue("no_posts_t"));return n.hide(),e.appendChild(t)}}).catch(function(t){let s=pages.elements.uploadError();return a.style.display="none",e.appendChild(s),n.hide(),ui.bindItems()})},restore:function(){if(settings.users.current)return pages.news();pages.unauth.authPage(),ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("restore_account")),document.title="yunNet - "+settings.lang.getValue("restore_account");let e=document.createElement("div");e.classList.add("carousel"),e.classList.add("carousel-slider"),e.classList.add("center"),document.getElementById("menu").prepend(e);let t=function(){let t=document.createElement("a");return t.classList.add("carousel-item"),t.classList.add(["red","blue","green"][getRandomInt(0,2)]),e.appendChild(t)}();unt.Carousel.init(e,{fullWidth:!0}),e.style.position="fixed",e.style.height="100%",e.style.zIndex=1e3;let n=document.createElement("div");t.appendChild(n),n.classList.add("container");let a=document.createElement("div");n.appendChild(a);let s=document.createElement("div");n.appendChild(s),s.classList.add("right");let l=document.createElement("a");l.innerHTML=unt.Icon.CLOSE,s.appendChild(l);let i=document.createElement("a");return i.innerHTML=unt.Icon.ARROW_FWD,s.appendChild(i),l.getElementsByTagName("svg")[0].style.fill="white",i.getElementsByTagName("svg")[0].style.fill="white",i.getElementsByTagName("svg")[0].style.marginTop="28%",l.getElementsByTagName("svg")[0].style.marginTop="28%",i.classList=l.classList=["btn-floating btn-large waves-effect waves-light"],i.style.marginLeft=l.style.marginLeft="15px",t.style.width=t.style.height="100%",l.onclick=function(e){return pages.elements.confirm("",settings.lang.getValue("confirm_exit"),function(e){if(e)return account.restore.closeSession().then(function(){return ui.go("https://"+window.location.host+"/")})})},a.classList.add("white-text"),account.restore.getCurrentStage().then(function(t){let n=arguments.callee,s=unt.Carousel.getInstance(e);s&&s.destroy();let d=new URLParser(window.location.href).parse();if(d.query&&t<3&&d.query.length>32){a.innerHTML="";let e=pages.elements.getLoader();return e.style.padding="50px",e.getElementsByTagName("path")[0].style.fill="white",i.style.display="none",a.appendChild(e),account.restore.validateQuery(d.query).then(function(e){return null===e?a.innerHTML="<h2>"+settings.lang.getValue("error")+"<h2><p>"+settings.lang.getValue("link_is_bad")+"</p>":n(e)})}if(0===t){a.innerHTML="<h2>"+settings.lang.getValue("welcome_message")+"<h2><p>"+settings.lang.getValue("validate_you")+"</p>";let e=document.createElement("div");e.classList.add("input-field");let t=document.createElement("input");e.appendChild(t),t.type="email",t.classList.add("validate"),t.placeholder=settings.lang.getValue("email"),t.style.color="white",a.appendChild(e),i.onclick=function(e){if(t.value.isEmpty())return t.classList.add("wrong");t.classList.remove("wrong");let a=new FormData;return t.setAttribute("disabled","true"),a.append("email",t.value),account.restore.sendSessionData(a).then(function(e){return n(e)}).catch(function(e){t.removeAttribute("disabled"),2===e.errorCode&&t.classList.add("wrong"),e.errorText&&unt.toast({html:e.errorText})})}}if(1===t){a.innerHTML="<h2>"+settings.lang.getValue("lets_continue")+"<h2><p>"+settings.lang.getValue("need_some_more")+"</p>";let e=document.createElement("div");e.classList.add("input-field");let t=document.createElement("input");e.appendChild(t),t.type="text",t.classList.add("validate"),t.placeholder=settings.lang.getValue("last_name"),t.style.color="white",a.appendChild(e),i.onclick=function(e){if(t.value.isEmpty()||t.value.match(/[^a-zA-Zа-яА-ЯёЁ'-]/iu))return t.classList.add("wrong");t.classList.remove("wrong");let a=new FormData;return t.setAttribute("disabled","true"),a.append("last_name",t.value),account.restore.sendSessionData(a).then(function(e){return n(e)}).catch(function(e){if(t.removeAttribute("disabled"),1!==e.errorCode&&2!==e.errorCode||t.classList.add("wrong"),e.errorText)return unt.toast({html:e.errorText})})}}if(2===t&&(a.innerHTML="<h2>"+settings.lang.getValue("restore_account")+"<h2><p>"+settings.lang.getValue("i_sent_email")+"</p>",i.style.display="none"),3===t){a.innerHTML="<h2>"+settings.lang.getValue("good_work")+"<h2><p>"+settings.lang.getValue("glad_to_see_you")+"</p>";let e=document.createElement("div");e.classList.add("input-field");let t=document.createElement("input");e.appendChild(t),t.type="password",t.classList.add("validate"),t.placeholder=settings.lang.getValue("password"),t.style.color="white";let s=document.createElement("div");s.classList.add("input-field");let d=document.createElement("input");s.appendChild(d),d.type="password",d.classList.add("validate"),d.placeholder=settings.lang.getValue("password2"),d.style.color="white",a.appendChild(e),a.appendChild(s),i.style.display="",l.style.display="none",i.onclick=function(e){if(t.value.isEmpty())return t.classList.add("wrong");if(t.classList.remove("wrong"),d.value.isEmpty())return d.classList.add("wrong");d.classList.remove("wrong"),t.value!==d.value?(t.classList.add("wrong"),d.classList.add("wrong")):(t.classList.remove("wrong"),d.classList.remove("wrong"));let a=new FormData;return t.setAttribute("disabled","true"),d.setAttribute("disabled","true"),a.append("password",t.value),a.append("repeat_password",d.value),account.restore.sendSessionData(a).then(function(e){return n(e)}).catch(function(e){if(t.removeAttribute("disabled"),d.removeAttribute("disabled"),5===e.errorCode&&t.classList.add("wrong"),6===e.errorCode&&d.classList.add("wrong"),e.errorText&&unt.toast({html:e.errorText}),e.requestedStage)return n(e.requestedStage);10===e.errorCode&&unt.toast({html:"Unable to restore: Internal server error."})})}}if(4===t)return a.innerHTML="<h2>"+settings.lang.getValue("thanks")+"<h2>",l.style.display="none",i.style.display="",i.onclick=function(e){let t=new FormData;return account.restore.sendSessionData(t).then(function(e){if(5===e)return unt.toast({html:"Loading..."}),i.style.display="none",setTimeout(function(){return window.location.href="/"},1e3)})}})},register:function(){if(window.opener&&window.addEventListener("beforeunload",function(){return window.opener.postMessage("cancelled","https://auth.yunnet.ru/")}),settings.users.current)return pages.news();pages.unauth.authPage(),ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("regstart")),document.title="yunNet. - "+settings.lang.getValue("regstart");let e=document.createElement("div");e.classList.add("carousel"),e.classList.add("carousel-slider"),e.classList.add("center"),e.classList.add("white-text"),e.id="regInfo",document.getElementById("menu").prepend(e);let t=function(){let t=document.createElement("div");return t.classList.add("carousel-item"),t.classList.add(["red","blue","green"][getRandomInt(0,2)]),e.appendChild(t)&&t}();unt.Carousel.init(regInfo,{fullWidth:!0}),e.style.position="fixed",e.style.height="100%",e.style.zIndex=1e3;let n=document.createElement("div");t.appendChild(n),n.classList.add("container");let a=document.createElement("div");n.appendChild(a);let s=document.createElement("div");n.appendChild(s),s.classList.add("right");let l=document.createElement("a");l.innerHTML=unt.Icon.CLOSE,s.appendChild(l);let i=document.createElement("a");return i.innerHTML=unt.Icon.ARROW_FWD,s.appendChild(i),l.getElementsByTagName("svg")[0].style.fill="white",i.getElementsByTagName("svg")[0].style.fill="white",i.getElementsByTagName("svg")[0].style.marginTop="28%",l.getElementsByTagName("svg")[0].style.marginTop="28%",i.classList=l.classList=["btn-floating btn-large waves-effect waves-light"],i.style.marginLeft=l.style.marginLeft="15px",t.style.width=t.style.height="100%",l.onclick=function(e){return pages.elements.confirm("",settings.lang.getValue("confirm_exit"),function(e){if(e)return account.register.closeSession().then(function(){return window.opener?window.opener.postMessage("cancelled","https://auth.yunnet.ru/"):ui.go("https://"+window.location.host+"/")})})},account.register.getCurrentStage().then(function(e){let t=arguments.callee,n=unt.Carousel.getInstance(regInfo);if(n&&n.destroy(),-1===e&&(a.innerHTML="<h2>"+settings.lang.getValue("error_closed_register")+"<h2><p>"+settings.lang.getValue("error_closed_register_message")+"</p>",i.style.display="none"),0===e){a.innerHTML="<h2>"+settings.lang.getValue("welcome_message")+"<h2><p>"+settings.lang.getValue("thanks_for_reg")+"</p>";let e=document.createElement("div");e.classList.add("input-field");let n=document.createElement("input");e.appendChild(n),n.type="text",n.classList.add("validate"),n.placeholder=settings.lang.getValue("first_name"),n.style.color="white";let s=document.createElement("div");s.classList.add("input-field");let l=document.createElement("input");s.appendChild(l),l.type="text",l.classList.add("validate"),l.placeholder=settings.lang.getValue("last_name"),l.style.color="white",a.appendChild(e),a.appendChild(s),i.onclick=function(e){if(n.value.isEmpty()||n.value.match(/[^a-zA-Zа-яА-ЯёЁ'-]/iu))return n.classList.add("wrong");if(n.classList.remove("wrong"),l.value.isEmpty()||l.value.match(/[^a-zA-Zа-яА-ЯёЁ'-]/iu))return l.classList.add("wrong");l.classList.remove("wrong");let a=new FormData;return n.setAttribute("disabled","true"),l.setAttribute("disabled","true"),a.append("first_name",n.value),a.append("last_name",l.value),account.register.sendSessionData(a).then(function(e){return settings.users.temp={},settings.users.temp.first_name=n.value,settings.users.temp.last_name=l.value,t(e)}).catch(function(e){return n.removeAttribute("disabled"),l.removeAttribute("disabled"),0===e.errorCode&&n.classList.add("wrong"),1===e.errorCode&&l.classList.add("wrong"),e.errorText&&unt.toast({html:e.errorText}),unt.toast({html:e.errorMessage})})}}1===e&&account.register.restoreData().then(function(e){settings.users.temp=e,a.innerHTML="<h2>"+settings.lang.getValue("lets_continue")+"<h2><p>"+htmlspecialchars(settings.lang.getValue("lets_welcome").replace("%first_name%",settings.users.temp.first_name))+"</p>";let n=document.createElement("div");n.classList.add("input-field");let s=document.createElement("input");n.appendChild(s),s.type="email",s.classList.add("validate"),s.placeholder=settings.lang.getValue("email"),s.style.color="white",a.appendChild(n),i.onclick=function(e){if(s.value.isEmpty())return s.classList.add("wrong");s.classList.remove("wrong");let n=new FormData;return s.setAttribute("disabled","true"),n.append("email",s.value),account.register.sendSessionData(n).then(function(e){return t(e)}).catch(function(e){s.removeAttribute("disabled"),2===e.errorCode&&s.classList.add("wrong"),e.errorText&&unt.toast({html:e.errorText})})}}),2===e&&account.register.restoreData().then(function(e){settings.users.temp=e,a.innerHTML="<h2>"+settings.lang.getValue("email_activation")+"<h2><p>"+htmlspecialchars(settings.lang.getValue("please_activate").replace("%first_name%",settings.users.temp.first_name))+"</p>";let n=document.createElement("div");n.classList.add("input-field");let s=document.createElement("input");n.appendChild(s),s.type="number",s.classList.add("validate"),s.placeholder=settings.lang.getValue("code"),s.style.color="white",a.appendChild(n),i.onclick=function(e){if(s.value.isEmpty())return s.classList.add("wrong");s.classList.remove("wrong");let n=new FormData;return s.setAttribute("disabled","true"),n.append("email_code",s.value),account.register.sendSessionData(n).then(function(e){return t(e)}).catch(function(e){s.removeAttribute("disabled"),3===e.errorCode&&s.classList.add("wrong"),e.errorText&&unt.toast({html:e.errorText})})}}),3===e&&account.register.restoreData().then(function(e){settings.users.temp=e,a.innerHTML="<h2>"+settings.lang.getValue("good_work")+"<h2><p>"+htmlspecialchars(settings.lang.getValue("finish_data").replace("%first_name%",settings.users.temp.first_name))+"</p>",l.style.display="none",i.style.display="";let n=document.createElement("div");n.classList.add("input-field");let s=document.createElement("input");n.appendChild(s),s.type="password",s.classList.add("validate"),s.placeholder=settings.lang.getValue("password"),s.style.color="white";let d=document.createElement("div");d.classList.add("input-field");let r=document.createElement("input");d.appendChild(r),r.type="password",r.classList.add("validate"),r.placeholder=settings.lang.getValue("password2"),r.style.color="white",a.appendChild(n),a.appendChild(d),i.onclick=function(e){if(s.value.isEmpty())return s.classList.add("wrong");if(s.classList.remove("wrong"),r.value.isEmpty())return r.classList.add("wrong");r.classList.remove("wrong"),s.value!==r.value?(s.classList.add("wrong"),r.classList.add("wrong")):(s.classList.remove("wrong"),r.classList.remove("wrong"));let n=new FormData;return s.setAttribute("disabled","true"),r.setAttribute("disabled","true"),n.append("password",s.value),n.append("repeat_password",r.value),account.register.sendSessionData(n).then(function(e){return t(e)}).catch(function(e){if(s.removeAttribute("disabled"),r.removeAttribute("disabled"),5===e.errorCode&&s.classList.add("wrong"),6===e.errorCode&&r.classList.add("wrong"),e.errorText&&unt.toast({html:e.errorText}),e.requestedStage)return t(e.requestedStage);10===e.errorCode&&unt.toast({html:"Unable to register: Internal server error."})})}}),4===e&&account.register.restoreData().then(function(e){return settings.users.temp=e,a.innerHTML="<h2>"+settings.lang.getValue("thanks")+"<h2>",l.style.display="none",i.style.display="",i.onclick=function(e){let t=new FormData;return account.register.sendSessionData(t).then(function(e){if(5===e)return unt.toast({html:"Loading..."}),i.style.display="none",setTimeout(function(){return window.opener?window.opener.postMessage("success","https://auth.yunnet.ru/"):window.location.href="/"},1e3)})}})})},edit:function(){if(!settings.users.current)return pages.unauth.authPage();if(settings.users.current.is_banned)return pages.unauth.banned();ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("edit")),history.replaceState(null,document.title,"/edit?section=main");let e=pages.elements.menuBody().clear();e.innerHTML="",pages.elements.buildRightMenu().append().addItem(settings.lang.getValue("main"),function(){return ui.go("https://"+window.location.host+"/edit?section=main")}).select();let t=document.createElement("div");t.classList.add("card");let n=document.createElement("div");t.appendChild(n),n.classList.add("full_section"),n.classList.add("valign-wrapper");let a=document.createElement("div");n.appendChild(a);let s=document.createElement("img");a.appendChild(s),s.classList.add("circle"),s.width=s.height=64,s.src=settings.users.current.photo_url;let l=document.createElement("div");n.appendChild(l),l.style="margin-left: 20px; width: 100%";let i=document.createElement("form");l.appendChild(i);let d=document.createElement("div");d.classList.add("input-field");let r=document.createElement("input");d.appendChild(r),r.type="text",r.classList.add("validate");let o=document.createElement("div");o.classList.add("input-field");let c=document.createElement("input");o.appendChild(c),c.type="text",c.classList.add("validate"),i.appendChild(d),i.appendChild(o),r.value=settings.users.current.first_name,c.value=settings.users.current.last_name,e.appendChild(t);let u=document.createElement("div");u.classList.add("card"),u.classList.add("full_section");let p=document.createElement("div");p.style.paddingBottom="5px",p.innerText=settings.lang.getValue("gender"),u.appendChild(p);let g=document.createElement("form");g.classList.add("valign-wrapper"),u.appendChild(g);let m=document.createElement("p");g.appendChild(m),m.style.marginRight="20px";let h=document.createElement("p");g.appendChild(h);let f=document.createElement("label"),y=document.createElement("label");m.appendChild(f),h.appendChild(y);let _=document.createElement("input"),v=document.createElement("input");_.classList.add("with-gap"),v.classList.add("with-gap"),f.appendChild(_),y.appendChild(v),_.name=v.name="gender",_.type=v.type="radio";let w=document.createElement("span"),E=document.createElement("span");f.appendChild(w),y.appendChild(E),w.innerText=settings.lang.getValue("gen_sel_1"),E.innerText=settings.lang.getValue("gen_sel_2"),e.appendChild(u),1===settings.users.current.gender&&(_.checked=!0),2===settings.users.current.gender&&(v.checked=!0),_.oninput=function(){return _.disabled=!0,v.disabled=!0,_.checked=!_.checked,v.checked=!v.checked,settings.users.setGender(1).then(function(e){return _.disabled=!1,v.disabled=!1,e.unauth?settings.reLogin():e.error?unt.toast({html:settings.lang.getValue("upload_error")}):_.checked=!0}).catch(function(e){return unt.toast({html:settings.lang.getValue("upload_error")})})},v.oninput=function(){return _.disabled=!0,v.disabled=!0,_.checked=!_.checked,v.checked=!v.checked,settings.users.setGender(2).then(function(e){return _.disabled=!1,v.disabled=!1,e.unauth?settings.reLogin():e.error?unt.toast({html:settings.lang.getValue("upload_error")}):v.checked=!0})};let b=document.createElement("div");e.appendChild(b),b.classList.add("card");let L=document.createElement("div");b.appendChild(L),L.classList.add("full_section"),L.classList.add("valign-wrapper");let C=document.createElement("div");L.appendChild(C);let T=document.createElement("div");L.appendChild(T);let x=document.createElement("div");x.classList.add("input-field");let I=document.createElement("input");x.appendChild(I),I.type="text",I.classList.add("validate"),C.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M0 0h24v24H0V0z" fill="none"/><path d="M18 1.01L8 1c-1.1 0-2 .9-2 2v3h2V5h10v14H8v-1H6v3c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99zM10 15h2V8H5v2h3.59L3 15.59 4.41 17 10 11.41z"/></svg>',C.style.marginRight="15px",T.style.width="100%",I.value=settings.users.current.screen_name||"id"+settings.users.current.user_id;let V=document.createElement("label"),k=document.createElement("label"),M=document.createElement("label");d.appendChild(V),o.appendChild(k),x.appendChild(M),r.id="first_name",c.id="last_name",I.id="screen_name",r.setAttribute("maxlength",64),c.setAttribute("maxlength",64),I.setAttribute("maxlength",32),V.setAttribute("for",r.id),k.setAttribute("for",c.id),M.setAttribute("for",I.id),V.innerHTML=settings.lang.getValue("first_name"),k.innerHTML=settings.lang.getValue("last_name"),M.innerHTML=settings.lang.getValue("screen_name"),V.classList.add("active"),k.classList.add("active"),M.classList.add("active"),T.appendChild(x);let B=document.createElement("div");t.appendChild(B);let A=document.createElement("a");A.innerHTML=unt.Icon.SAVE,B.appendChild(A),A.getElementsByTagName("svg")[0].style.fill="white",A.getElementsByTagName("svg")[0].style.marginTop="28%",A.classList=["btn-floating btn-large waves-effect waves-light"],A.style.marginLeft,B.style.width="100%",B.style.textAlign="-webkit-right",B.style.padding="0 20px 20px";let S=pages.elements.getLoader();B.appendChild(S),S.style.display="none";let H=document.createElement("div");b.appendChild(H);let N=document.createElement("a");N.innerHTML=unt.Icon.SAVE,H.appendChild(N),N.getElementsByTagName("svg")[0].style.fill="white",N.getElementsByTagName("svg")[0].style.marginTop="28%",N.classList=["btn-floating btn-large waves-effect waves-light"],N.style.marginLeft,H.style.width="100%",H.style.textAlign="-webkit-right",H.style.padding="0 20px 20px";let R=pages.elements.getLoader();H.appendChild(R),R.style.display="none",S.classList.remove("center"),R.classList.remove("center"),A.onclick=function(e){return r.value.isEmpty()||r.value.match(/[^a-zA-Zа-яА-ЯёЁ'-]/iu)?r.classList.add("wrong"):(r.classList.remove("wrong"),c.value.isEmpty()||c.value.match(/[^a-zA-Zа-яА-ЯёЁ'-]/iu)?c.classList.add("wrong"):(c.classList.remove("wrong"),A.style.display="none",S.style.display="",settings.users.edit({first_name:r.value,last_name:c.value}).then(function(e){A.style.display="",S.style.display="none",settings.users.current.first_name=r.value,settings.users.current.last_name=c.value,settings.users.profiles[settings.users.current.user_id].first_name=r.value,settings.users.profiles[settings.users.current.user_id].last_name=c.value}).catch(function(e){return A.style.display="",S.style.display="none",unt.toast({html:e.errorMessage?e.errorMessage:settings.lang.getValue("upload_error")})})))},N.onclick=function(e){if(!I.value.isEmpty()){if(!I.value.match(/^[a-z]{1}[a-z_\d\s]*[a-z_\s\d]{1}$/i))return I.classList.add("wrong");I.classList.remove("wrong")}if(I.value!==settings.users.current.screen_name)return N.style.display="none",R.style.display="",settings.users.edit({screen_name:I.value}).then(function(e){N.style.display="",R.style.display="none",settings.users.current.screen_name=I.value,settings.users.profiles[settings.users.current.user_id].screen_name=I.value}).catch(function(e){return N.style.display="",R.style.display="none",unt.toast({html:e.errorMessage?e.errorMessage:settings.lang.getValue("upload_error")})})},s.onclick=function(e){let t=pages.elements.fileUploader({onFileSelected:function(e,t,n){return n.setLoading(!0),uploads.getURL().then(function(e){return uploads.upload(e,t[0],function(e){return codes.callbacks.uploadResolve(e,n)}).then(function(e){let t="photo"+e.photo.owner_id+"_"+e.photo.id+"_"+e.photo.access_key;return settings.users.edit({photo:t}).then(function(e){return n.setLoading(!1),s.src=e.photo.url.main,settings.users.current.photo_url=s.src,settings.users.profiles[settings.users.current.user_id].photo_url=s.src,n.close()}).catch(function(e){return n.setLoading(!1),unt.toast({html:settings.lang.getValue("upload_error")})})}).catch(function(e){let t=settings.lang.getValue("upload_error");return unt.toast({html:t}),n.setLoading(!1)})}).catch(function(e){let t=settings.lang.getValue("upload_error");return unt.toast({html:t}),n.setLoading(!1)})},afterClose:function(){}});return t.addFooterItem(settings.lang.getValue("delete_a_photo"),function(e,n){return n.setLoading(!0),settings.users.edit({photo:""}).then(function(e){return n.setLoading(!1),s.src="https://dev.yunnet.ru/images/default.png",settings.users.current.photo_url=s.src,settings.users.profiles[settings.users.current.user_id].photo_url=s.src,t.close()}).catch(function(e){return t.setLoading(!1),unt.toast({html:settings.lang.getValue("upload_error")})})}),t.open()}},notifications:function(){if(!settings.users.current)return pages.unauth.authPage();if(settings.users.current.is_banned)return pages.unauth.banned();ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("notifications"));let e=pages.elements.menuBody().clear();e.innerHTML="";let t=pages.elements.getLoader();t.style.marginTop="10px",e.appendChild(t);let n=document.createElement("div");return n.classList.add("card"),n.classList.add("collection"),n.style.display="none",n.id="notifications_list",e.appendChild(n),ui.bindItems(),notifications.get(0,30).then(function(a){return t.hide(),a.length<=0?e.appendChild(pages.elements.alertWindow(unt.Icon.NO_NOTES,settings.lang.getValue("no_notes"),settings.lang.getValue("no_notes_text"))):(a.forEach(function(e){let t=pages.elements.notification(e);return n.appendChild(t)}),e.appendChild(pages.elements.createFAB(unt.Icon.CLOSE,function(e){console.log(e)})),n.style.display="",ui.bindItems())}).catch(function(n){let a=pages.elements.uploadError();return t.hide(),e.appendChild(a)})},friends:function(e){if(e||(e={}),!settings.users.current)return pages.unauth.authPage();if(settings.users.current.is_banned)return pages.unauth.banned();ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("friends"));let t=pages.elements.menuBody().clear();t.innerHTML="";let n=e&&e.subaction?e.subaction:null;if("write"===n&&ui.canBack){let e=settings.get();e&&e.theming.backButton&&t.appendChild(pages.elements.backArrowButton(settings.lang.getValue("select_to_write")),function(e){return ui.go(null,!0)})}if("invite_user"===n&&ui.canBack){let e=settings.get();e&&e.theming.backButton&&t.appendChild(pages.elements.backArrowButton(settings.lang.getValue("select_to_invite")),function(e){return ui.go(null,!0)})}let a=pages.elements.buildRightMenu().append(),s=settings.users.current.user_id,l="friends";e&&(e.user_id&&(s=e.user_id),e.action&&(l=e.action));let i=a.addItem(settings.lang.getValue("friends"),function(){let e={action:"friends",user_id:s};return n&&(e.subaction=n),ui.go(window.location.href,!0,!0,!0,!1,e)}),d=null,r=null;"invite_user"!==n&&(d=a.addItem(settings.lang.getValue("subs"),function(){let e={action:"subscribers",user_id:s};return n&&(e.subaction=n),ui.go(window.location.href,!0,!0,!0,!1,e)}),r=null,s===settings.users.current.user_id&&(r=a.addItem(settings.lang.getValue("outcoming_requests"),function(){let e={action:"outcoming",user_id:settings.users.current.user_id};return n&&(e.subaction=n),ui.go(window.location.href,!0,!0,!0,!1,e)}))),"friends"===l&&i.select(),"subscribers"===l&&d.select(),"outcoming"===l&&r.select();let o=document.createElement("div");if(t.appendChild(o),"friends"===l){let t=pages.elements.createTabs([[settings.lang.getValue("friends"),function(){return e.subFriends="friends",ui.go(window.location.href,!1,!1,!1,!0,e)}],[settings.lang.getValue("friends_online"),function(){return e.subFriends="online",ui.go(window.location.href,!1,!1,!1,!0,e)}],[settings.lang.getValue("search_text"),function(){return e.subFriends="search",ui.go(window.location.href,!1,!1,!1,!0,e)}]]);o.insertAdjacentElement("beforebegin",t)}let c=pages.elements.getLoader(!0);c.style.marginTop="10px",t.appendChild(c),o.id=l,o.style.display="none",o.classList.add("card"),o.classList.add("collection");let u=pages.elements.createFAB(unt.Icon.SAVE,function(){return u.classList.add("scale-out"),e.chat.addMembers(e.members).then(function(t){return ui.go("https://"+window.location.host+"/messages?s="+e.chat.peer_id)}).catch(function(e){let t=e.errorCode,n=settings.lang.getValue("upload_error");return 2===t&&(n=settings.lang.getValue("level_error")),3===t&&(n=settings.lang.getValue("uninvitable_1")),4===t&&(n=settings.lang.getValue("uninvitable_2")),unt.toast({html:n}),u.classList.remove("scale-out")})});u.classList.add("scale-transition"),u.classList.add("scale-out"),t.appendChild(u);let p=e.subFriends||"friends";return"search"===p?(c.hide(),subPages.searchFriends(t)):settings.users.friends.get(s,l,1).then(function(a){if("online"===p){let e=[];a.forEach(function(t){t.online.is_online&&e.push(t)}),a=e}if(a.length>0){o.style.display="";for(let t=0;t<a.length;t++){let i=pages.elements.userItem(a[t]);i.id=a[t].user_id||-1*a[t].bot_id;let d=a[t];if("friends"===p||"online"===p)if("write"===n)i.href="/messages?s="+d.user_id,o.appendChild(i);else if("invite_user"===n){i.href="";let t=document.createElement("div");i.appendChild(t),t.classList.add("secondary-content");let n=document.createElement("form");t.appendChild(n);let a=document.createElement("p");n.appendChild(a);let s=document.createElement("label");a.appendChild(s);let l=document.createElement("input");l.type="checkbox",s.appendChild(l);let r=document.createElement("span");s.appendChild(r),r.innerHTML="",i.onclick=function(e){return e.preventDefault(),l.oninput(e)},l.oninput=function(){"checked"===l.getAttribute("checked")?l.removeAttribute("checked"):l.setAttribute("checked","checked"),-1===e.members.indexOf(d.user_id)?e.members.push(d.user_id):e.members.splice(e.members.indexOf(d.user_id),1),e.members.length<1?u.classList.add("scale-out"):u.classList.remove("scale-out")},-1!==e.members.indexOf(d.user_id)&&l.setAttribute("checked","checked"),d.can_invite_to_chat&&o.appendChild(i)}else if("subscribers"===l&&s===settings.users.current.user_id){let e=document.createElement("div");e.classList.add("secondary-content"),i.appendChild(e),i.onclick=function(e){if(e.preventDefault(),"svg"!==e.target.nodeName&&"path"!==e.target.nodeName)return ui.go("https://"+window.location.host+"/id"+d.user_id)};let t=document.createElement("div");t.classList.add("valign-wrapper"),e.appendChild(t);let n=!1;if(!d.friend_state.is_hidden){let e=document.createElement("div");e.classList.add("hide-item"),e.innerHTML=unt.Icon.CLOSE,t.appendChild(e),e.style.cursor="pointer",e.onclick=function(t){if(n)return;n=!0;let a=pages.elements.getLoader();return a.setArea(20),e.getElementsByTagName("svg")[0].style.display="none",e.appendChild(a),settings.users.friends.hideRequest(d.user_id)}}let a=document.createElement("div");a.classList.add("accept-item"),a.innerHTML=unt.Icon.SAVE,t.appendChild(a),a.style.marginLeft="10px",a.style.cursor="pointer",a.onclick=function(e){if(n)return;n=!0;let t=pages.elements.getLoader();return t.setArea(20),a.getElementsByTagName("svg")[0].style.display="none",a.appendChild(t),settings.users.friends.acceptRequest(d.user_id)},o.appendChild(i)}else o.appendChild(i)}}else{let e=pages.elements.alertWindow(unt.Icon.FRIENDS,settings.lang.getValue("no_friends"),settings.lang.getValue("no_friends_text"));e.style.display="",t.appendChild(e)}return ui.bindItems(),c.hide()}).catch(function(e){return c.hide(),ui.go("https://"+window.location.host+"/id"+s),unt.toast({html:settings.lang.getValue("upload_error")})})},audios:function(e={}){if(!settings.users.current)return pages.unauth.authPage();if(settings.users.current.is_banned)return pages.unauth.banned();ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("audios"));let t=pages.elements.menuBody().clear();t.innerHTML="";let n=pages.elements.buildRightMenu().append(),a=n.addItem(settings.lang.getValue("audios"),function(){return ui.go("https://"+window.location.host+"/audios",!1,!1,!1,!0,{section:"audios"})}),s=null,l=pages.elements.getLoader();l.style.marginTop="15px",t.appendChild(l);let i=e?e.section:"audios";return"audios"===i&&a.select(),settings.accounts.get().then(function(a){return a[0].bound&&(s=n.addItem("VK",function(){return ui.go("https://"+window.location.host+"/audios",!1,!1,!1,!0,{section:"vk_audios"})}),"vk_audios"===i&&s.select()),subPages.audios.manage(i,e,n,t,l,a)}).catch(function(e){let n=pages.elements.uploadError();return l.hide(),t.appendChild(n)})},sessions:function(){if(!settings.users.current)return pages.unauth.authPage();if(settings.users.current.is_banned)return pages.unauth.banned();ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("activity_history"));let e=pages.elements.menuBody().clear(),t=settings.get();if(t&&t.theming.backButton&&ui.canBack&&!ui.isMobile()){let t=pages.elements.backArrowButton();e.appendChild(t),ui.bindItems()}let n=document.createElement("div");n.classList=["card collection"],e.appendChild(n),n.style.display="none";let a=pages.elements.getLoader();return a.style.marginTop="20px",e.appendChild(a),settings.data.getSessions().then(function(e){return e.forEach(function(e){let t=document.createElement("div");t.classList=["card collection-item full_section waves-effect waves-light"],t.style.cursor="pointer",t.style.width="100%";let a=document.createElement("b");t.appendChild(a),a.innerText=e.id,e.is_current&&(a.innerText+=" ("+settings.lang.getValue("online")+")"),t.appendChild(document.createElement("br"));let s=document.createElement("div");s.innerText="IP: "+e.ip,t.appendChild(s);let l=document.createElement("div");l.innerText=settings.lang.getValue("session_mobile")+": "+(e.data.mobile?settings.lang.getValue("yes"):settings.lang.getValue("no")),t.appendChild(l);let i=document.createElement("div");i.innerText=settings.lang.getValue("session_time")+": "+pages.parsers.time(e.data.time),t.appendChild(i),t.addEventListener("click",function(n){let a=pages.elements.createWindow(),s=a.getContent(),l=a.getFooter(),i=document.createElement("div");s.appendChild(i),i.innerHTML=settings.lang.getValue("session_info")+" <b>"+e.id+"</b>",s.appendChild(document.createElement("br"));let d=document.createElement("div");d.innerHTML=settings.lang.getValue("session_mobile")+": <b>"+(e.data.mobile?settings.lang.getValue("yes"):settings.lang.getValue("no"))+"</b>",s.appendChild(d);let r=document.createElement("div");r.innerHTML=settings.lang.getValue("online")+": <b>"+(e.is_current?settings.lang.getValue("yes"):settings.lang.getValue("no"))+"</b>",s.appendChild(r),s.appendChild(document.createElement("br"));let o=document.createElement("div");o.innerHTML="IP: <b>"+e.ip+"</b>",s.appendChild(o);let c=document.createElement("div");c.innerHTML=settings.lang.getValue("session_time")+": <b>"+pages.parsers.time(e.data.time)+"</b>",s.appendChild(c),s.appendChild(document.createElement("br"));let u=document.createElement("div");if(u.innerHTML=settings.lang.getValue("session_headers")+": <b>"+e.login_data+"</b>",s.appendChild(u),e.is_closeable){let n=document.createElement("a");n.classList=["btn btn-flat waves-effect"],n.innerText=settings.lang.getValue("session_end"),l.appendChild(n),n.addEventListener("click",function(){return pages.elements.confirm("",settings.lang.getValue("session_end_confirm"),function(n){if(n)return settings.data.endSession(e.id).then(function(){return a.getInstance().close(),t.remove()}).catch(function(e){return pages.elements.alert(settings.lang.getValue("unable_to_end_session"))})})})}let p=document.createElement("a");p.classList=["btn btn-flat waves-effect modal-close"],p.innerText="OK",l.appendChild(p)}),n.appendChild(t)}),n.style.display="",a.hide()}).catch(function(t){let n=pages.elements.uploadError();return a.hide(),e.appendChild(n)})},themes:function(e){if(!settings.users.current)return pages.unauth.authPage();if(settings.users.current.is_banned)return pages.unauth.banned();ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("account_themes")),document.title="yunNet. - "+settings.lang.getValue("account_themes");let t=pages.elements.menuBody().clear(),n=settings.get();if(n&&n.theming.backButton&&ui.canBack&&!ui.isMobile()){let e=pages.elements.backArrowButton();t.appendChild(e),ui.bindItems()}let a=new URLParser(window.location.href).parse();return"installed"===a.section?subPages.themes.installed(t,a,e):"repo"===a.section?subPages.themes.repo(t):void t.appendChild(pages.elements.createButton(null,null,null,null,[[unt.Icon.PALETTE,settings.lang.getValue("installed_themes"),function(){return ui.go("https://"+window.location.host+"/themes?section=installed")},"black"],[unt.Icon.GROUP,settings.lang.getValue("theme_repos"),function(){return ui.go("https://"+window.location.host+"/themes?section=repo")},"black"]]))},wall:function(){if(settings.users.current&&settings.users.current.is_banned)return pages.unauth.banned();let e=1;ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("wall"));let t,n=pages.elements.menuBody().clear();try{t=settings.get()}catch(e){t=null}let a=document.createElement("div");if(n.appendChild(a),t){if(t.theming.backButton&&ui.canBack&&!ui.isMobile()){let e=pages.elements.backArrowButton();a.appendChild(e),ui.bindItems()}}else if(ui.canBack&&!ui.isMobile()){let e=pages.elements.backArrowButton();a.appendChild(e),ui.bindItems()}a.style.display="flex",a.style.flexDirection="column",a.style.height="100%";let s=pages.elements.getLoader();s.style.marginTop="20px",a.appendChild(s),a.id="post",a.addEventListener("dragenter",function(e){e.preventDefault();let t=document.getElementById("drag-manager");t&&""!==t.style.display&&(t.style.display="")}),document.body.addEventListener("drop",function(e){let t=document.getElementById("drag-manager");t&&"none"!==t.style.display&&(t.style.display="none")}),window.onblur=function(e){let t=document.getElementById("drag-manager");t&&"none"!==t.style.display&&(t.style.display="none")},document.onmouseout=function(e){let t=document.getElementById("drag-manager");t&&"none"!==t.style.display&&(t.style.display="none")};let l=String(window.location.href.split("wall")[1]).split("_");return posts.data.get(Number(l[0]),Number(l[1])).then(function(t){let n=pages.elements.post(t,!0,!0);a.appendChild(n);let l=document.createElement("div");a.appendChild(l),l.style.height="100%";let i=document.createElement("div");if(i.classList.add("collection"),l.appendChild(i),t.fields&&t.fields.can_comment){let e=pages.elements.inputForm(settings.lang.getValue("write_a_comment"),{onInputCallback:function(t,n){return pages.parsers.attachmentsValid(attachments_list,write_data)?e.getSendItem().enable():e.getSendItem().disable()},pasteCallback:function(t,n){return attachments_list.getElementsByTagName("div").length>=10?unt.toast({html:settings.lang.getValue("error_atts")}):pages.elements.fileUploader({onFileSelected:function(t,n,a){return uploads.getURL().then(function(t){return a.setLoading(!0),uploads.upload(t,n[0],function(e){return codes.callbacks.uploadResolve(e,a)}).then(function(t){return a.setLoading(!1),a.close(),attachments_list.appendChild(pages.parsers.attachment(t,function(){return pages.parsers.attachmentsValid(attachments_list,write_data)?e.getSendItem().enable():e.getSendItem().disable()})),pages.parsers.attachmentsValid(attachments_list,write_data)?e.getSendItem().enable():e.getSendItem().disable()}).catch(function(e){let t=settings.lang.getValue("upload_error");unt.toast({html:t}),a.setLoading(!1),a.close()})}).catch(function(e){let t=settings.lang.getValue("upload_error");unt.toast({html:t}),a.setLoading(!1),a.close()})},afterClose:function(){return pages.parsers.attachmentsValid(attachments_list,write_data)?e.getSendItem().enable():e.getSendItem().disable()}}).selectFile(n).open()},attachmentsItemCallback:function(t,n){return attachments_list.getElementsByTagName("div").length>=10?unt.toast({html:settings.lang.getValue("error_atts")}):pages.elements.fileUploader({onFileSelected:function(t,n,a){return a.setLoading(!0),uploads.getURL().then(function(t){return uploads.upload(t,n[0],function(e){return codes.callbacks.uploadResolve(e,a)}).then(function(t){return a.setLoading(!1),attachments_list.appendChild(pages.parsers.attachment(t,function(){return pages.parsers.attachmentsValid(attachments_list,write_data)?e.getSendItem().enable():e.getSendItem().disable()})),pages.parsers.attachmentsValid(attachments_list,write_data)?e.getSendItem().enable():e.getSendItem().disable(),a.close()}).catch(function(e){let t=settings.lang.getValue("upload_error");return unt.toast({html:t}),a.setLoading(!1)})}).catch(function(e){let t=settings.lang.getValue("upload_error");return unt.toast({html:t}),a.setLoading(!1)})},afterClose:function(){return pages.parsers.attachmentsValid(attachments_list,write_data)?e.getSendItem().enable():e.getSendItem().disable()}}).open()},sendItemCallback:function(e,n){n.setLoading(!0);let a=pages.parsers.attachmentsString(attachments_list),s=write_data.value;return posts.comments.send(t.user_id,t.id,s.toString(),a.toString()).then(function(e){n.setLoading(!1);let t=pages.elements.comment(e);return attachments_list.innerHTML="",write_data.innerHTML="",write_data.value="",unt.updateTextFields(),i.appendChild(t),window.scrollTo(0,i.scrollHeight)}).catch(function(e){n.setLoading(!1);let t=settings.lang.getValue("upload_error");return unt.toast({html:t})})}});e.getSendItem().disable(),e.style="margin: 0px; bottom: 0px; position: sticky !important;",a.appendChild(e),i.onscroll=function(e){console.log(e)}}let d=pages.elements.getLoader();i.appendChild(d);let r=Number(t.comments.count)||0;return posts.comments.get(t.user_id,t.id,30,Number(r)-(30*e>r?r:30*e)).then(function(e){return d.remove(),e.forEach(function(e){let t=pages.elements.comment(e);return ui.bindItems(),i.appendChild(t)})}),ui.bindItems(),s.hide()}).catch(function(e){return s.hide(),ui.canBack?ui.go(null,!0):window.location.href="/"})},photo:function(){if(settings.users.current&&settings.users.current.is_banned)return pages.unauth.banned();ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("photo"));let e=pages.elements.menuBody().clear(),t=pages.elements.getLoader();t.style.marginTop="10px",e.appendChild(t);let n=window.location.href.split(window.location.host)[1].split("/")[1].split("?")[0];return photos.getByCredentials(n).then(function(a){let s=a.photo.url.main;return settings.users.get(a.photo.owner_id).then(function(l){let i=document.createElement("div");i.classList.add("card"),i.classList.add("full_section");let d=document.createElement("div");d.classList.add("valign-wrapper"),i.appendChild(d);let r=document.createElement("img");r.classList.add("circle"),r.width=r.height=32,r.src=l.photo_url,d.appendChild(r),e.appendChild(i);let o=document.createElement("a");o.classList.add("alink-name"),o.style.marginLeft="15px",d.appendChild(o),o.innerText=l.name||l.first_name+" "+l.last_name,o.href="user"===l.account_type?"/id"+l.user_id:"/bot"+l.bot_id,ui.bindItems();let c=document.createElement("img");i.appendChild(c),c.style.width="100%",c.style.marginTop="15px",c.src=s,c.setAttribute("attachment","photo"+a.photo.owner_id+"_"+a.photo.id+"_"+a.photo.access_key),c.onclick=function(e){return photos.show(c,a.photo)},i.appendChild(document.createElement("br"));let u=document.createElement("div");u.classList.add("valign-wrapper"),i.appendChild(u);let p=document.createElement("div"),g=document.createElement("div");u.appendChild(p),u.appendChild(g),p.innerHTML=unt.Icon.LIKE,g.innerHTML=unt.Icon.LIKE_SET,p.getElementsByTagName("path")[1].style.stroke="white",g.getElementsByTagName("svg")[0].style.display="",a.photo&&a.photo.meta.likes.liked_by_me?(p.style.display="none",g.style.display=""):(p.style.display="",g.style.display="none");let m=document.createElement("div");u.appendChild(m),m.innerText=a.photo.meta.likes.count>0?pages.parsers.niceString(a.photo.meta.likes.count):"",m.style.marginLeft="10px",m.style.marginBottom="7px",p.onclick=g.onclick=function(e){return photos.like(n).then(function(e){m.innerText=e.new_count>0?pages.parsers.niceString(e.new_count):"",0===e.state?(p.style.display="",g.style.display="none"):(p.style.display="none",g.style.display="")}).catch(function(e){})},t.hide()}).catch(function(e){throw new TypeError("Unable to show deleted accounts")})}).catch(function(n){return t.hide(),e.appendChild(pages.elements.uploadError())})},profile:function(){if(settings.users.current&&settings.users.current.is_banned)return pages.unauth.banned();function e(e,t){let n=new FormData;return n.append("action",e.toString()),ui.Request({data:n,method:"POST",success:function(){return delete settings.users.profiles[t],ui.go(window.location.href,!1,!1,!0)}})}let t=window.location.href.split(window.location.host)[1];if("/"===t)return;ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("profile"));let n=pages.elements.menuBody().clear(),a=document.createElement("div"),s=document.createElement("div");s.classList=["card full_section"],a.appendChild(s);let l=document.createElement("div");l.classList=["valign-wrapper"];let i=document.createElement("div"),d=document.createElement("img");d.width=64,d.height=64,d.classList.add("circle"),d.alt="",i.appendChild(d),l.appendChild(i);let r=document.createElement("div");r.classList.add("halign-wrapper"),r.style.marginLeft="15px",l.appendChild(r);let o=document.createElement("div");o.classList.add("valign-wrapper"),r.appendChild(o);let c=document.createElement("b");o.appendChild(c),c.innerText=settings.lang.getValue("loading");let u=document.createElement("div");r.appendChild(u);let p=document.createElement("small");u.appendChild(p),p.innerText="...",s.appendChild(l),n.appendChild(a);let g=document.createElement("div");return g.style.width="100%",g.classList.add("valign-wrapper"),g.classList.add("hidet-aone"),s.appendChild(g),settings.users.resolveScreenName(t).then(function(t){if(t.screen_name&&history.replaceState(null,document.title,"/"+t.screen_name),ui.userVisited=t.user_id?t.user_id:-1*t.bot_id,t.status){g.style.cursor="pointer",g.style.marginTop="20px",g.innerHTML=unt.Icon.STATS;let e=document.createElement("div");e.classList.add("credentials"),e.classList.add("hidet-aone"),g.appendChild(e),e.innerText=t.status,e.style.width="100%",g.onclick=function(){return pages.elements.alert(t.status)}}if(settings.users.current&&ui.userVisited===settings.users.current.user_id){if(!t.status){g.style.cursor="pointer",g.style.marginTop="20px",g.innerHTML=unt.Icon.EDIT;let e=document.createElement("div");e.classList.add("credentials"),e.classList.add("hidet-aone"),g.appendChild(e),e.innerText=settings.lang.getValue("edit_status"),e.style.width="100%"}g.onclick=function(){let e=pages.elements.createWindow(),n=document.createElement("a");n.classList=["btn btn-flat waves-effect"],n.innerText=settings.lang.getValue("continue"),e.getFooter().appendChild(n);let a=document.createElement("div");e.getContent().appendChild(a),a.classList.add("valign-wrapper"),a.style.width="100%";let s=document.createElement("div");a.appendChild(s),s.style.width="100%",s.innerText=settings.lang.getValue("edit_status");let l=document.createElement("div");l.style.cursor="pointer",l.style.marginTop="5px",a.appendChild(l),l.innerHTML=unt.Icon.CLOSE,l.addEventListener("click",function(){e.getInstance().close()});let i=pages.elements.createInputField("HMMM :///",!!t.status);t.status&&i.setText(t.status),e.getContent().appendChild(i),n.onclick=function(){n.innerText=settings.lang.getValue("loading"),n.classList.add("disabled"),i.setDisabled(!0),settings.users.setStatus(i.getValue()).then(function(t){return e.getInstance().close(),t.isEmpty()||(settings.users.profiles[settings.users.current.user_id].status=t),pages.profile()}).catch(function(e){return n.innerText=settings.lang.getValue("continue"),n.classList.remove("disabled"),i.setDisabled(!1),unt.toast({html:settings.lang.getValue("upload_error")})})}}}t.photo_object?d.setAttribute("attachment","photo"+t.photo_object.owner_id+"_"+t.photo_object.id+"_"+t.photo_object.access_key):d.setAttribute("attachment","photo"+ui.userVisited+"_1_all"),d.onclick=function(){return photos.show(d,t.photo_object)};let n=ui.userVisited;d.src=t.photo_url;let s=pages.parsers.getOnlineState(t);if(c.innerText="user"===t.account_type?t.first_name+" "+t.last_name:t.name,document.title="yunNet. - "+c.innerText,p.innerText=s,t.is_verified){let e=document.createElement("div");e.classList.add("credentials"),o.appendChild(e);let t=document.createElement("div");t.classList.add("card"),t.style.margin=0,t.style.cursor="pointer",t.style.width=t.style.height="20px",t.style.borderRadius="30px",t.innerHTML=unt.Icon.PALETTE_ANIM,e.appendChild(t)}if(settings.users.current){let s=[],l=!1;if("user"===t.account_type){if(t.user_id===settings.users.current.user_id)s.push([settings.lang.getValue("edit"),function(){return ui.go("https://"+window.location.host+"/edit")}]);else{if(!t.is_banned&&(!t.can_write_messages||t.is_me_blacklisted||t.is_blacklisted||s.push([settings.lang.getValue("write_p"),function(){return ui.go("https://"+window.location.host+"/messages?s="+(ui.userVisited>0?ui.userVisited:"b"+-1*ui.userVisited))}]),!t.is_me_blacklisted&&!t.is_blacklisted&&"object"==typeof t.friend_state)){if(2===t.friend_state.state&&s.push([settings.lang.getValue("delete_friend"),function(){return e("delete",n)}]),1===t.friend_state.state){let a=t.friend_state.user1;t.friend_state.user2;a===settings.users.current.user_id?s.push([settings.lang.getValue("cancel_request"),function(){return e("delete",n)}]):s.push([settings.lang.getValue("accept_request"),function(){return e("add",n)}])}0===t.friend_state.state&&s.push([settings.lang.getValue("add_to_the_friends"),function(){return e("add",n),unt.Notification(unt.Icon.SAVE,settings.lang.getValue("done"),settings.lang.getValue("friends_request_sent"),[],{timeout:3,sound:!1})}])}s.push([t.is_blacklisted?settings.lang.getValue("unblock"):settings.lang.getValue("block"),function(){return e("block",n)}])}!t.is_me_blacklisted&&t.can_access_closed&&s.push([settings.lang.getValue("show_friends"),function(){return ui.go("https://"+window.location.host+"/friends?id="+ui.userVisited,!1,!1,!1,!0,{action:"friends",user_id:ui.userVisited})}]),t.is_me_blacklisted&&(l=!0)}if("bot"===t.account_type&&(!t.can_write_messages||t.is_banned||t.is_deleted||(t.bot_can_write_messages&&s.push([settings.lang.getValue("write_p"),function(){return ui.go("https://"+window.location.host+"/messages?s="+(ui.userVisited>0?ui.userVisited:"b"+-1*ui.userVisited))}]),t.can_invite_to_chat&&s.push([settings.lang.getValue("invite_to_the_chat"),function(){return ui.go("https://"+window.location.host+"/messages",!1,!1,!1,!0,{action:"invite_to_chat",user_id:ui.userVisited})}])),t.owner_id===settings.users.current.user_id&&s.push([settings.lang.getValue("edit"),function(){return window.location.href="https://dev.yunnet.ru/bots"}]),t.bot_can_write_messages?s.push([settings.lang.getValue("block_messages"),function(){return e("toggle_send_access",n)}]):s.push([settings.lang.getValue("unblock_messages"),function(){return e("toggle_send_access",n)}])),a.appendChild(pages.elements.actionsMenu(s,l,!0)),t.can_write_on_wall){let e=pages.elements.wallInput({photoUrl:settings.users.current.photo_url,hideInputButton:!0,attachFileCallback:function(t,n){return attachments.getElementsByTagName("div").length>=10?unt.toast({html:settings.lang.getValue("error_atts")}):pages.elements.contextMenu([[settings.lang.getValue("photo"),function(){return pages.elements.fileUploader({onFileSelected:function(t,n,a){return a.setLoading(!0),uploads.getURL().then(function(t){return uploads.upload(t,n[0],function(e){return codes.callbacks.uploadResolve(e,a)}).then(function(t){return a.setLoading(!1),attachments.appendChild(pages.parsers.attachment(t,function(){return pages.parsers.attachmentsValid(attachments,write_text)?e.showInputButton():e.hideInputButton()})),pages.parsers.attachmentsValid(attachments,write_text)?e.showInputButton():e.hideInputButton(),a.close()}).catch(function(e){let t=settings.lang.getValue("upload_error");return unt.toast({html:t}),a.setLoading(!1)})}).catch(function(e){let t=settings.lang.getValue("upload_error");return unt.toast({html:t}),a.setLoading(!1)})},afterClose:function(t,n){return pages.parsers.attachmentsValid(attachments,write_text)?e.showInputButton():e.hideInputButton()}}).open()}],[settings.lang.getValue("poll"),function(){return poll.pinned(attachments)?unt.toast({html:settings.lang.getValue("upload_error")}):poll.creator(function(t,n){let a=pages.elements.createPollElement(t.poll,function(){return pages.parsers.attachmentsValid(attachments,write_text)?e.showInputButton():e.hideInputButton()});return attachments.appendChild(a),pages.parsers.attachmentsValid(attachments,write_text)?e.showInputButton():e.hideInputButton()}).show()}]]).open(t,!0)},publishSettingsCallback:function(e,t){},publishCallback:function(t,n){let a=pages.parsers.attachmentsString(attachments);return(!String(document.getElementById("write_text").value).isEmpty()||!a.isEmpty())&&(n.setLoading(!0),posts.actions.create(ui.userVisited,String(document.getElementById("write_text").value),a).then(function(t){let a=pages.elements.post(t),s=document.getElementById("alertWindow");return s&&s.remove(),n.setLoading(!1),e.hideInputButton(),document.getElementById("write_text").value="",document.getElementById("write_text").innerHTML="",unt.updateTextFields(),attachments.innerHTML="",unt.Collapsible.getInstance(e).close(),posts_list.style.display="",posts_list.prepend(a),ui.bindItems()}).catch(function(e){n.setLoading(!1);let t=settings.lang.getValue("upload_error");return unt.toast({html:t})}))},inputTextCallback:function(t,n){return pages.parsers.attachmentsValid(attachments,write_text)?e.showInputButton():e.hideInputButton()}});a.appendChild(e)}unt.AutoInit(),unt.updateTextFields()}else a.appendChild(pages.elements.actionsMenu(null,!1,!1));if(t.is_banned){let e=pages.elements.alertWindow(unt.Icon.CLEAR,settings.lang.getValue("user_banned"),settings.lang.getValue("user_banned_text"));return a.appendChild(e)}if(t.is_me_blacklisted||!t.can_access_closed&&"bot"!==t.account_type){if(!t.can_access_closed&&!t.is_me_blacklisted){let e=pages.elements.alertWindow(unt.Icon.LOCKED,settings.lang.getValue("closed_profile"),settings.lang.getValue("closed_profile_message"));return a.appendChild(e)}t.is_me_blacklisted}else{let e=pages.elements.getLoader();e.id="posts_loader";let t=document.createElement("div");t.id="posts_list",a.appendChild(e),a.appendChild(t),posts.getAll(n,0,20).then(function(n){if(t.style.display="none",n.length>0){for(let e=0;e<n.length;e++){let a=pages.elements.post(n[e]);t.appendChild(a)}return e.hide(),t.style.display="",ui.bindItems()}{let t=pages.elements.alertWindow(unt.Icon.CLEAR,settings.lang.getValue("no_posts"),settings.lang.getValue("no_posts_t"));return e.hide(),a.appendChild(t)}})}}).catch(function(e){ui.userVisited=0,s.innerHTML="";let t=document.createElement("div");s.appendChild(t),t.innerText=settings.lang.getValue("user_not_found"),t.classList.add("center"),document.title="yunNet."})},archive:function(){if(!settings.users.current)return pages.unauth.authPage();if(settings.users.current.is_banned)return pages.unauth.banned();pages.elements.menuBody().clear();ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("archive"))},groups:function(){if(!settings.users.current)return pages.unauth.authPage();if(settings.users.current.is_banned)return pages.unauth.banned();pages.elements.menuBody().clear();ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("groups"))},settings:function(){if(!settings.users.current)return pages.unauth.authPage();if(settings.users.current.is_banned)return pages.unauth.banned();let e=pages.elements.menuBody().clear();document.title="yunNet. - "+settings.lang.getValue("settings");let t=new URLParser(window.location.href).parse(),n=[],a=["main","notifications","privacy","security","blacklist","accounts","theming","about"],s=t.section;if(ui.isMobile()||-1!==a.indexOf(s)||(s="main"),ui.isMobile())if(-1===a.indexOf(s)){nav_header_title.innerText=settings.lang.getValue("settings");let t=document.createElement("div");t.classList=["card full_section"],e.appendChild(t);let n=document.createElement("div");n.classList.add("valign-wrapper"),t.appendChild(n);let a=document.createElement("div"),s=document.createElement("div");n.appendChild(a),n.appendChild(s);let l=document.createElement("img");a.appendChild(l),l.classList.add("circle"),l.alt="",l.width=l.height=48,l.src=settings.users.current.photo_url;let i=document.createElement("div");s.appendChild(i),i.classList.add("alink-name"),s.style.marginLeft="15px";let d=document.createElement("b");i.appendChild(d),d.innerText=settings.users.current.first_name+" "+settings.users.current.last_name;let r=document.createElement("div");s.appendChild(r),s.classList.add("halign-wrapper"),r.innerHTML='<small style="color: gray">'+pages.parsers.getOnlineState(settings.users.current)+"</small>",e.appendChild(pages.elements.createButton(null,null,null,null,[[unt.Icon.ACCOUNT,settings.lang.getValue("main"),function(){return ui.go("https://"+window.location.host+"/settings?section=main")}],[unt.Icon.NOTIFICATIONS,settings.lang.getValue("notifications"),function(){return ui.go("https://"+window.location.host+"/settings?section=notifications")}]])),e.appendChild(pages.elements.createButton(null,null,null,null,[[unt.Icon.LOCKED,settings.lang.getValue("privacy"),function(){return ui.go("https://"+window.location.host+"/settings?section=privacy")}],[unt.Icon.SECURITY,settings.lang.getValue("security"),function(){return ui.go("https://"+window.location.host+"/settings?section=security")}],[unt.Icon.LIST,settings.lang.getValue("blacklist"),function(){return ui.go("https://"+window.location.host+"/settings?section=blacklist")}]])),e.appendChild(pages.elements.createButton(null,null,null,null,[[unt.Icon.GROUP,settings.lang.getValue("accounts"),function(){return ui.go("https://"+window.location.host+"/settings?section=accounts")}],[unt.Icon.PALETTE,settings.lang.getValue("theming"),function(){return ui.go("https://"+window.location.host+"/settings?section=theming")}]])),e.appendChild(pages.elements.createButton(null,null,null,null,[[unt.Icon.STATS,settings.lang.getValue("about"),function(){return ui.go("https://"+window.location.host+"/settings?section=about")}]])),e.appendChild(pages.elements.createButton("",settings.lang.getValue("logout"),function(){return pages.elements.confirm("",settings.lang.getValue("logout_qq"),function(e){if(e)return settings.Logout()})},"red"))}else nav_header_title.innerText=settings.lang.getValue(a[a.indexOf(s)]),document.title="yunNet. - "+nav_header_title.innerText;else{let e=pages.elements.buildRightMenu().append();a.forEach(function(t){let a=e.addItem(settings.lang.getValue(t),function(e,t){return ui.go("https://"+window.location.host+"/settings?section="+t.getAttribute("category"))});a.setAttribute("category",t),n.push(a)}),-1!==a.indexOf(s)&&n[a.indexOf(s)].select()}return codes.callbacks.Settings(s,e,null,t,a)},messages:function(e={}){if(!settings.users.current)return pages.unauth.authPage();if(settings.users.current.is_banned)return pages.unauth.banned();let t=pages.elements.menuBody().clear(),n=new URLParser(window.location.href).parse(),a=1;if("info"===n.action&&n.s){if(ui.isMobile())nav_header_title.innerText=settings.lang.getValue("chat");else{let e=settings.get();e&&e.theming.backButton&&!ui.isMobile()&&ui.canBack&&t.appendChild(pages.elements.backArrowButton(settings.lang.getValue("chat")),function(e){return ui.go(null,!0)})}let a=messages.utils.getChatInstance(n.s);if(!a)return ui.go(null,!0);let s=pages.elements.getLoader();s.style.marginTop="10px",t.appendChild(s),e||(e={}),a.getInfo().then(function(l){a.getPermissions().then(function(i){a.getCurrentPermissionsLevel().then(function(d){return"management"===n.mode?codes.callbacks.showManagementPage(l,i,d,t,s,a):"edit"===n.mode&&e.userObject&&e.menuBody&&e.chat?codes.callbacks.showUserManagementPage(e.userObject,l,d,i,e.menuBody,s,e.chat):codes.callbacks.chatInfoCallback(l,i,d,t,s,a)}).catch(function(e){return codes.callbacks.chatInfoCallback(l,{},-1,t,s,a)})}).catch(function(e){return codes.callbacks.chatInfoCallback(l,{},-1,t,s,a)})})}else if(n.s){t.style.height="100%";let a=1;document.title="yunNet. - "+settings.lang.getValue("message"),messages.getChatByPeer(n.s).then(function(s){if(!s)return ui.go("https://"+window.location.host+"/messages");let l=document.createElement("div");l.addEventListener("dragenter",function(e){e.preventDefault();let t=document.getElementById("drag-manager");t&&""!==t.style.display&&(t.style.display="")}),document.body.addEventListener("drop",function(e){let t=document.getElementById("drag-manager");t&&"none"!==t.style.display&&(t.style.display="none")}),window.onblur=function(e){let t=document.getElementById("drag-manager");t&&"none"!==t.style.display&&(t.style.display="none")},document.onmouseout=function(e){let t=document.getElementById("drag-manager");t&&"none"!==t.style.display&&(t.style.display="none")},l.id="chat",l.classList.add("hidesc"),l.style.height="100%",l.style.display="flex",l.style.flexDirection="column";let i=pages.elements.messages.buildChatHeader(s),d=pages.elements.messages.buildActionsHeader("0/100",[],function(){let e=document.querySelectorAll(".selected");for(let t=0;t<e.length;t++){let n=e[t],a=Number(n.id);n.classList.remove("selected"),o.selectedMessages.splice(o.selectedMessages.indexOf(a),1)}return chatHeader.style.display="",d.style.display="none",r.style.display="none",d.setText(o.selectedMessages.length+"/100")}),r=pages.elements.messages.buildEditHeader(function(){if(o.isSaving)return;let e=document.querySelectorAll(".selected");for(let t=0;t<e.length;t++){let n=e[t],a=Number(n.id);n.classList.remove("selected"),o.selectedMessages.splice(o.selectedMessages.indexOf(a),1)}chatHeader.style.display="",d.style.display="none",r.style.display="none",o.editMode=!1,u.getSendItem().setIcon(unt.Icon.SEND),write_data.value="",unt.textareaAutoResize(write_data),unt.updateTextFields(),attachments_list.innerHTML="",document.getElementById("fwditem")&&fwditem.remove(),u.getSendItem().disable()});r.style.display="none";let o=messages.utils.getChatInstance(n.s);if(!o)return ui.go("https://"+window.location.host+"/messages");d.style.display="none",d.id="actsHeader",ui.isMobile()?(document.getElementsByClassName("nav-wrapper")[0].getElementsByTagName("ul")[0].appendChild(i),document.getElementsByClassName("nav-wrapper")[0].insertAdjacentElement("afterend",d),document.getElementsByClassName("nav-wrapper")[0].insertAdjacentElement("afterend",r)):(l.appendChild(i),l.appendChild(d),l.appendChild(r));let c=document.createElement("div");c.id="messages_"+n.s,l.appendChild(c),c.classList=["messages hidesc center"],c.style="flex-wrap: wrap; overflow-x: hidden; height: 100%",pages.messages.alreadyTyping=!1;let u=pages.elements.inputForm(settings.lang.getValue("write_a_message"),{onInputCallback:function(e){if("this is the sad unt :("===write_data.value?u.getAttachmentsItem().innerHTML=unt.Icon.SMILE_BAD:u.getAttachmentsItem().innerHTML=unt.Icon.ATTACHMENT,pages.parsers.attachmentsValid(attachments_list,write_data)?u.getSendItem().enable():u.getSendItem().disable(),pages.messages.alreadyTyping)return!1;pages.messages.alreadyTyping=!0,pages.messages.lastTimeout=setTimeout(function(){pages.messages.alreadyTyping=!1},5e3);let t=new FormData;return t.append("action","set_typing_state"),t.append("state","typing"),t.append("peer_id",n.s),ui.Request({data:t,url:"/messages",method:"POST"})},pasteCallback:function(e,t){return attachments_list.getElementsByTagName("div").length>=10?unt.toast({html:settings.lang.getValue("error_atts")}):pages.elements.fileUploader({onFileSelected:function(e,t,n){return uploads.getURL().then(function(e){return n.setLoading(!0),uploads.upload(e,t[0],function(e){return codes.callbacks.uploadResolve(e,n)}).then(function(e){return n.setLoading(!1),n.close(),attachments_list.appendChild(pages.parsers.attachment(e,function(){return pages.parsers.attachmentsValid(attachments_list,write_data)?u.getSendItem().enable():u.getSendItem().disable()})),pages.parsers.attachmentsValid(attachments_list,write_data)?u.getSendItem().enable():u.getSendItem().disable()}).catch(function(e){let t=settings.lang.getValue("upload_error");unt.toast({html:t}),n.setLoading(!1),n.close()})}).catch(function(e){let t=settings.lang.getValue("upload_error");unt.toast({html:t}),n.setLoading(!1),n.close()})},afterClose:function(){return pages.parsers.attachmentsValid(attachments_list,write_data)?u.getSendItem().enable():u.getSendItem().disable()}}).selectFile(t).open()},attachmentsItemCallback:function(e){return attachments_list.getElementsByTagName("div").length>=10?unt.toast({html:settings.lang.getValue("error_atts")}):pages.elements.contextMenu([[settings.lang.getValue("photo"),function(){return pages.elements.fileUploader({onFileSelected:function(e,t,n){return n.setLoading(!0),uploads.getURL().then(function(e){return uploads.upload(e,t[0],function(e){return codes.callbacks.uploadResolve(e,n)}).then(function(e){return n.setLoading(!1),attachments_list.appendChild(pages.parsers.attachment(e,function(){return pages.parsers.attachmentsValid(attachments_list,write_data)?u.getSendItem().enable():u.getSendItem().disable()})),pages.parsers.attachmentsValid(attachments_list,write_data)?u.getSendItem().enable():u.getSendItem().disable(),n.close()}).catch(function(e){let t=settings.lang.getValue("upload_error");return unt.toast({html:t}),n.setLoading(!1)})}).catch(function(e){let t=settings.lang.getValue("upload_error");return unt.toast({html:t}),n.setLoading(!1)})},afterClose:function(){return pages.parsers.attachmentsValid(attachments_list,write_data)?u.getSendItem().enable():u.getSendItem().disable()}}).open()}],[settings.lang.getValue("poll"),function(){return poll.pinned(attachments_list)?unt.toast({html:settings.lang.getValue("upload_error")}):poll.creator(function(e,t){let n=pages.elements.createPollElement(e.poll,function(){return pages.parsers.attachmentsValid(attachments_list,write_data)?u.getSendItem().enable():u.getSendItem().disable()});return attachments_list.appendChild(n),pages.parsers.attachmentsValid(attachments_list,write_data)?u.getSendItem().enable():u.getSendItem().disable()}).show()}]]).open(e,!0)},sendItemCallback:function(e,t,a){let s,l=String(write_data.value),i=pages.parsers.attachmentsString(attachments_list),o="",u=String(n.s),p=messages.utils.getChatInstance(u),g={};if(!p.editMode){if(g={from_id:settings.users.current.user_id||0,id:0,text:l,attachments:pages.parsers.attachmentsArray(attachments_list),fwd:[],time:Math.floor(new Date/1e3)},document.getElementsByClassName("to_fwd")[0]){let e=document.getElementsByClassName("to_fwd")[0],t=e.fwdSelected;t.forEach(function(e){let t=messages.utils.getChatInstance(p.fwdPeer||u);g.fwd.push(t.messagesCache[e])}),e.remove(),o=t.join(",")+"_"+(p.fwdPeer||u),p.fwdPeer=null}u.startsWith("b")?g.bot_peer_id=Number(String(u).split("b").join("")):g.peer_id=Number(u)}if(!(l.isEmpty()&&i.isEmpty()&&o.isEmpty()))return t.setLoading(!0),p.editMode||((s=messages.elements.message(g,!0)).onclick=function(e){return codes.callbacks.messageCallback(this,p,d,chatHeader,e)},c.appendChild(s),c.scrollTo(0,c.scrollHeight)),write_data.value="",unt.updateTextFields(),unt.textareaAutoResize(write_data),attachments_list.innerHTML="",p.editMode&&t.setIcon(unt.Icon.SEND),p.editMode?function(){p.isSaving=!0;let e=Number(document.getElementsByClassName("selected")[0].parentNode.parentNode.id);return p.saveMessage(e,l,i,o).then(function(e){p.isSaving=!1,r.close(),t.setLoading(!1),t.disable()}).catch(function(e){p.isSaving=!1,t.setLoading(!1)})}():function e(){return pages.messages.alreadyTyping=!1,clearTimeout(pages.messages.lastTimeout),p.sendMessage(l,i,o).then(function(e){document.getElementById(e)&&s.remove(),s.id=e,g.id=e,t.setLoading(!1),t.disable(),s.setSending(!1),realtime.connect.pending[e]=s}).catch(function(n){t.setLoading(!1),t.disable(),s.setError(function(t){return pages.elements.contextMenu([[settings.lang.getValue("repeat"),function(){return s.setSending(!0),e()}],[settings.lang.getValue("delete"),function(){return s.remove()}]]).open(t)})})}()}}),p=!1;u.addItem(unt.Icon.KEYBOARD,"chat-keyboard-toggle",function(e,t,n){p=!p,e||(p=n),p&&(t.innerHTML=unt.Icon.HIDE_KEYBOARD,o.keyboard&&o.keyboard.elements&&u.getElementsByClassName("odiv")[0].appendChild(o.keyboard.elements.keyboard)),p||(t.innerHTML=unt.Icon.KEYBOARD,u.getElementsByClassName("odiv")[0].innerHTML="")}).hide(),u.getSendItem().disable(),u.onkeydown=function(e){if(17===e.keyCode&&(u.isPressed=!0),!ui.isMobile()&&!u.isPressed&&e.keyCode===unt.keys.ENTER)return e.preventDefault(),u.arguments[1].sendItemCallback(e,u.getSendItem(),u.arguments[1].sendItemCallback);!ui.isMobile()&&u.isPressed&&e.keyCode===unt.keys.ENTER&&(write_data.value+="\r\n",unt.updateTextFields(),unt.textareaAutoResize(write_data),write_data.focus())},u.onkeyup=function(e){17===e.keyCode&&(u.isPressed=!1)};let g=d.addItem(unt.Icon.DELETE,"delete",new Function),m=d.addItem(unt.Icon.EDIT,"edit",function(e,t){d.style.display="none",chatHeader.style.display="none",r.style.display="",o.editMode=!0,u.getSendItem().setIcon(unt.Icon.SAVE);let n=document.querySelectorAll(".selected")[0],a=Number(n.parentNode.parentNode.id),s=o.messagesCache[a];if(s.text&&(write_data.value=s.text,unt.updateTextFields(),unt.textareaAutoResize(write_data)),s.attachments.length>0&&s.attachments.forEach(function(e){attachments_list.appendChild(pages.parsers.attachment(e,function(e){return pages.parsers.attachmentsValid(attachments_list,write_data)?u.getSendItem().enable():u.getSendItem().disable()}))}),s.fwd.length>0){let e=new Selection;s.fwd.forEach(function(t){e.push(t.id)});let t=pages.elements.buildFwdItem(e,function(){return pages.parsers.attachmentsValid(attachments_list,write_data)?u.getSendItem().enable():u.getSendItem().disable()});u.insertAdjacentElement("afterbegin",t)}return pages.parsers.attachmentsValid(attachments_list,write_data)?u.getSendItem().enable():u.getSendItem().disable()});d.addItem(unt.Icon.REPLY,"reply",function(e,t){document.getElementsByClassName("to_fwd")[0]&&document.getElementsByClassName("to_fwd")[0].remove();let n=pages.elements.buildFwdItem(o.selectedMessages);return u.insertAdjacentElement("afterbegin",n),u.getSendItem().enable(),d.close()}),d.addItem(unt.Icon.FWD,"fwd",function(){let e=[];o.selectedMessages.forEach(function(t){return e.push(t)});let t={action:"fwd",fwdFrom:o.peer_id,fwdSelected:e};return d.close(),ui.go("https://"+window.location.host+"/messages",!1,!1,!1,!1,t)});m.disable(),g.disable(),u.id="messagesInput",s.metadata.permissions&&(s.metadata.permissions.is_muted||s.metadata.permissions.is_kicked)&&u.setErrorMessage(settings.lang.getValue("cant_chat")),s.chat_info.is_multi_chat||s.chat_info.data.can_write_messages||u.setErrorMessage(settings.lang.getValue("cant_chat"));let h=document.createElement("div");c.appendChild(h),h.style.position="sticky",h.style.top="40%";let f=pages.elements.getLoader();f.setArea(40),h.appendChild(f),l.appendChild(u),t.appendChild(l),ui.bindItems(),o.getInfo().then(function(t){o.getMessages(a).then(function(t){let s=t.list,l=(t.pinned,document.getElementById("messages_"+n.s));if(e&&"fwd"===e.action){e.fwdFrom;let t=e.fwdSelected,n=new Selection;t.forEach(function(e){n.push(e)}),o.selectedMessages=n,o.fwdPeer=e.fwdFrom,document.getElementsByClassName("to_fwd")[0]&&document.getElementsByClassName("to_fwd")[0].remove();let a=pages.elements.buildFwdItem(o.selectedMessages);u.insertAdjacentElement("afterbegin",a),d.close(),u.getSendItem().enable()}let i=null;for(let e=0;e<s.length;e++){let t=s[e],n=messages.elements.message(t);n.onclick=function(e){return codes.callbacks.messageCallback(this,o,d,chatHeader,e)};let a=pages.parsers.time(t.time,!1,!0);if(!o.createdDates[a]){let e=document.createElement("line");e.innerHTML=a,l&&l.appendChild(e),o.createdDates[a]=a}l&&l.appendChild(n),i=t}if(1===a&&(i&&i.keyboard&&!o.keyboard&&(o.keyboard={elements:{keyboard:pages.elements.buildKeyboard(i.keyboard.keyboard,o)},params:i.keyboard.params,items:i.keyboard.keyboard}),o.keyboard)){let e=document.getElementsByClassName("chat-keyboard-toggle")[0];e.show(),o.keyboard.params.autoShow&&e.click()}return o.createdDates={},f.hide(),l.scrollTo(0,l.scrollHeight),ui.bindItems()})})})}else{if(document.title="yunNet. - "+settings.lang.getValue("messages"),ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("messages")),e)"fwd"===e.action&&t.appendChild(pages.elements.backArrowButton(settings.lang.getValue("select_a_dialog"),function(t){return t.preventDefault(),ui.go("https://"+window.location.host+"/messages?s="+e.fwdFrom)})),"invite_to_chat"===e.action&&t.appendChild(pages.elements.backArrowButton(settings.lang.getValue("invite_to_chat"),function(e){return e.preventDefault(),ui.go(null,!0)}));else{let e=pages.elements.createFAB(unt.Icon.ADD,null,[[unt.Icon.EDIT,function(e,t){return ui.go("https://"+window.location.host+"/friends",!1,!1,!1,!0,{subaction:"write"})}],[unt.Icon.FRIENDS,function(){return pages.chats.create()}]]);t.appendChild(e)}let n=pages.elements.getLoader(),l=document.createElement("div");l.id="messages_list",t.appendChild(l);let i=!1,d=pages.elements.createButton(unt.Icon.ADD,settings.lang.getValue("load_more"),function(){s(a++)});function s(t=1,a=!1){return messages.get(30*((Number(t)>0?Number(t):1)-1),30,a).then(function(a){if(a.length>0){for(let t=0;t<a.length;t++){let n=a[t],s=pages.elements.messages.dialog(n,{onContext:function(e,t,a){let s=pages.elements.contextMenu([[settings.lang.getValue("clear_messages_history"),function(e){return pages.elements.confirm("",settings.lang.getValue("chat_clear_confirmation"),function(e){if(e)return messages.utils.getChatInstance(n.peer_id||"b"+-1*n.bot_peer_id).clearHistory().catch(function(e){return unt.toast({html:settings.lang.getValue("upload_error")})})})}]]);if(s.open)return s.open(t)}},e);e&&"invite_to_chat"===e.action&&(s.onclick=function(t){return t.preventDefault(),pages.elements.loadingMode(),messages.utils.getChatInstance(n.peer_id||"b"+-1*n.bot_peer_id).addMembers([e.user_id]).then(function(e){if(pages.elements.loadingMode().getInstance().close(),e)return ui.go("https://"+window.location.host+"/messages?s="+(n.peer_id||"b"+-1*n.bot_peer_id))}).catch(function(e){let t=e.errorCode,n=settings.lang.getValue("upload_error");return 2===t&&(n=settings.lang.getValue("level_error")),3===t&&(n=settings.lang.getValue("uninvitable_1")),4===t&&(n=settings.lang.getValue("uninvitable_2")),pages.elements.loadingMode().getInstance().close(),unt.toast({html:n})})}),s&&l.appendChild(s)}a.length>=20?d.style.display="":d.style.display="none",i=!1}if(a.length<=0&&1===t){l.style.display="none";let e=pages.elements.alertWindow(unt.Icon.CLEAR,settings.lang.getValue("no_messages"),settings.lang.getValue("no_messages_text"));e.id="no_messages",l.parentNode.appendChild(e)}return ui.bindItems(),n.hide()}).catch(function(e){l.style.display="none";let t=pages.elements.uploadError();return l.parentNode.appendChild(t),ui.bindItems(),n.hide()})}d.style.display="none",t.appendChild(d),n.style.marginTop="10px",t.appendChild(n),l.classList.add("collection"),l.classList.add("card"),ui.bindItems(),s(a++,e&&"invite_to_chat"===e.action)}},elements:{buildKeyboard:function(e,t=!1){let n=document.createElement("div");return n.style.padding="7px",e.forEach(function(e){let a=document.createElement("div");a.classList.add("valign-wrapper"),e.forEach(function(e){let n=document.createElement("a");n.classList=["card unselectable waves-effect"],n.style.width="100%",n.style.margin="4px",n.style.textAlign="center",n.style.padding="10px",n.style.backgroundColor="#"+e.color[0]+e.color[1]+e.color[2],n.style.color="#"+e.textColor[0]+e.textColor[1]+e.textColor[2],n.innerText=e.text,n.style.cursor="pointer",a.appendChild(n),t&&n.addEventListener("click",function(){t.sendMessage(e.text,"","")})}),n.appendChild(a)}),n},alert:function(e){return new Promise(function(t){let n=pages.elements.createWindow();n.getContent().innerHTML=e;let a=n.getFooter(),s=document.createElement("a");return s.classList=["btn btn-flat waves-effect modal-close"],s.innerText="OK",s.onclick=function(){return t()},a.appendChild(s),n})},createPollElement:function(e,t){let n=document.createElement("div");n.classList.add("card"),n.style="background-color: #818181 !important",n.style.textAlign="center",n.style.cursor="pointer",n.style.padding="5px",n.style.color="white",n.style.margin=0,n.onclick=function(e){return pages.elements.contextMenu([[settings.lang.getValue("edit"),new Function],[settings.lang.getValue("delete"),function(){n.remove(),t&&t()}]]).open(e)};let a=document.createElement("div");a.style.width=a.style.height="100%";let s=document.createElement("div");return s.innerText=settings.lang.getValue("poll"),a.appendChild(s),n.appendChild(a),s.style.position="absolute",s.style.top="45%",s.style.left="50%",s.style.marginRight="-50%",s.style.transform="translate(-50%, -50%)",n.style.width=n.style.height="54px",n.setAttribute("attachment","poll"+e.owner_id+"_"+e.id+"_"+e.access_key),n},loadingMode:function(){if(pages.elements.loadingMode.already)return pages.elements.loadingMode.preloader;let e=document.createElement("div");e.classList.add("modal"),ui.isMobile()&&e.classList.add("bottom-sheet"),pages.elements.menuBody().appendChild(e);let t=document.createElement("div");t.classList.add("modal-content"),e.appendChild(t);let n=document.createElement("div");t.appendChild(n),n.classList.add("valign-wrapper");let a=pages.elements.getLoader();n.appendChild(a);let s=document.createElement("div");n.appendChild(s),s.innerText=settings.lang.getValue("loading"),s.style.marginLeft="15px",s.style.marginBottom="5px";let l=unt.Modal.init(e,{startingTop:"35%",endingTop:"40%",dismissible:!1,onCloseEnd:function(){return pages.elements.loadingMode.already=!1,pages.elements.loadingMode.preloader=void 0,e.remove()}});return l&&(e.getInstance=function(){return l},l.open()),pages.elements.loadingMode.already=!0,pages.elements.loadingMode.preloader=e,e},tokenItem:function(e,t){let n=document.createElement("div");n.classList.add("card"),n.classList.add("collection-item"),n.classList.add("full_section"),n.classList.add("valign-wrapper");let a=document.createElement("div");n.appendChild(a),a.style.width="100%";let s="bots";0===e.app_id?a.innerText="Owner: "+(e.owner.name||e.owner.first_name+" "+e.owner.last_name):(s="apps",a.innerText="APP ID:"+e.app_id);let l=document.createElement("a");return l.style.marginTop="4px",l.style.cursor="pointer",l.innerHTML=unt.Icon.EDIT,n.appendChild(l),l.onclick=function(e){if(t)return t(e)},n},createChecker:function(e,t){let n=document.createElement("form");n.action="#";let a=document.createElement("p");n.appendChild(a);let s=document.createElement("label");a.appendChild(s);let l=document.createElement("input");s.appendChild(l),l.type="checkbox",l.classList.add("filled-in");let i=document.createElement("span");return s.appendChild(i),i.innerText=e||"",l.oninput=function(e){if(t)return t(e,n)},n.setChecked=function(e){return l.checked=e||!1,n},n.checked=function(){return l.checked},n.setDisabled=function(e){return l.disabled=e||!1,n},n},createTabs:function(e=[]){let t=document.createElement("ul");return t.classList=["tabs card"],t.style.margin=0,t.style.width="fit-content",t.style.marginTop="5px",t.style.marginBottom="-8px",e.forEach(function(e){let n=e[0],a=e[1],s=document.createElement("li");s.classList.add("tab"),t.appendChild(s);let l=document.createElement("a");s.appendChild(l),l.onclick=function(e){return a(e,s)},l.style.cursor="pointer",l.style.maxWidth="120px",l.innerText=n||""}),t},createWindow:function(){let e=document.createElement("div");e.classList.add("modal"),ui.isMobile()&&e.classList.add("bottom-sheet");let t=document.createElement("div");t.classList.add("modal-content"),e.appendChild(t);let n=document.createElement("div");n.classList.add("modal-footer"),e.appendChild(n),e.getContent=function(){return t},e.getFooter=function(){return n},pages.elements.menuBody().appendChild(e);let a=unt.Modal.init(e,{onCloseEnd:function(){return e.remove()}});return a.open(),e.getInstance=function(){return a},e},setupCounters:function(e){return new Promise(function(t){if("object"!=typeof e)return t(!1);let n=document.getElementById("messages_item");n&&(e.messages>0?n.innerText=String(e.messages):n.innerText="");let a=document.getElementById("notifications_item");a&&(e.notifications>0?a.innerText=String(e.notifications):a.innerText="");let s=document.getElementById("friends_item");return s&&(e.friends>0?s.innerText=String(e.friends):s.innerText=""),t(!0)})},notification:function(e){console.log(e);let t=document.createElement("div"),n=e.data.time||Math.floor(new Date/1e3);t.classList.add("card"),t.classList.add("collection-item"),t.classList.add("avatar");let a=e.data.user_id?new Image:document.createElement("i");e.data.user_id&&settings.users.get(e.data.user_id).then(function(e){a.src=e.photo_url,ui.bindItems()}).catch(function(e){}),a.classList.add("circle"),t.appendChild(a);let s=e.type,l=document.createElement("span");l.classList.add("title"),t.appendChild(l);let i=document.createElement("b");l.appendChild(i);let d=document.createElement("div");t.appendChild(d);let r=document.createElement("small");t.appendChild(r),r.innerHTML=pages.parsers.time(n),"account_login"!==s&&"login"!==s||(i.innerHTML=settings.lang.getValue("note_logged"),d.innerHTML=settings.lang.getValue("logged_text").replace("%ip%",e.data.ip)),"deleted_friend"===s&&(i.innerHTML=settings.lang.getValue("you_deleted_from_friends"),settings.users.get(e.data.user_id).then(function(e){return d.innerHTML=settings.lang.getValue("deleted_you_friend").replace("%usernick%",e.is_deleted?settings.lang.getValue("deleted_account"):'<a href="/'+(e.name?"bot"+e.bot_id:"id"+e.user_id)+'">'+(e.name||e.first_name+" "+e.last_name)+"</a>"),ui.bindItems()}).catch(function(e){})),"friendship_requested"===s&&(i.innerHTML=settings.lang.getValue("friends_adding"),settings.users.get(e.data.user_id).then(function(e){return d.innerHTML=settings.lang.getValue("want_to_add").replace("%usernick%",e.is_deleted?settings.lang.getValue("deleted_account"):'<a href="/'+(e.name?"bot"+e.bot_id:"id"+e.user_id)+'">'+(e.name||e.first_name+" "+e.last_name)+"</a>"),ui.bindItems()}).catch(function(e){})),"friendship_accepted"===s&&(i.innerHTML=settings.lang.getValue("friends_added"),settings.users.get(e.data.user_id).then(function(e){return d.innerHTML=settings.lang.getValue("added_you").replace("(а)",2===e.gender?"а":"").replace("%usernick%",e.is_deleted?settings.lang.getValue("deleted_account"):'<a href="/'+(e.name?"bot"+e.bot_id:"id"+e.user_id)+'">'+(e.name||e.first_name+" "+e.last_name)+"</a>"),ui.bindItems()}).catch(function(e){})),"post_like"===s&&(i.innerHTML=settings.lang.getValue("post_like"),settings.users.get(e.data.user_id).then(function(t){return d.innerHTML=settings.lang.getValue("post_liked").replace("(а)",2===t.gender?"а":"").replace("%username%",t.is_deleted?settings.lang.getValue("deleted_account"):'<a href="/'+(t.name?"bot"+t.bot_id:"id"+t.user_id)+'">'+(t.name||t.first_name+" "+t.last_name)+"</a>").replace("%wall%","/wall"+e.data.data.wall_id+"_"+e.data.data.post_id),ui.bindItems()}).catch(function(e){})),"photo_like"===s&&(i.innerHTML=settings.lang.getValue("photo_like"),settings.users.get(e.data.user_id).then(function(t){return d.innerHTML=settings.lang.getValue("photo_liked").replace("(а)",2===t.gender?"а":"").replace("%username%",t.is_deleted?settings.lang.getValue("deleted_account"):'<a href="/'+(t.name?"bot"+t.bot_id:"id"+t.user_id)+'">'+(t.name||t.first_name+" "+t.last_name)+"</a>").replace("%photo%","/photo"+e.data.data.owner_id+"_"+e.data.data.id+"_"+e.data.data.access_key),ui.bindItems()}).catch(function(e){}));let o=document.createElement("div");o.classList.add("secondary-content"),t.appendChild(o);let c=document.createElement("div");o.appendChild(c),c.classList.add("valign-wrapper");let u=document.createElement("div");c.appendChild(u),u.innerHTML=unt.Icon.DONE_ALL,u.style.cursor="pointer",u.onclick=function(t){let n=pages.elements.getLoader();return n.classList.add("hide-loader"),u.appendChild(n),u.getElementsByTagName("svg")[0].style.display="none",n.setArea(20),notifications.hide(e.id)},e.is_hidden&&(u.style.display="none");let p=document.createElement("div");return c.appendChild(p),p.innerHTML=unt.Icon.CLOSE,p.style.cursor="pointer",p.style.marginLeft="10px",p.onclick=function(t){let n=pages.elements.getLoader();return n.classList.add("read-loader"),p.appendChild(n),p.getElementsByTagName("svg")[0].style.display="none",n.setArea(20),notifications.read(e.id)},t.id=e.id,t},theme:function(e=null){let t=document.createElement("div");t.style.cursor="pointer",t.classList=["card collection-item"];let n=document.createElement("div");n.classList.add("valign-wrapper"),t.appendChild(n);let a=document.createElement("div");a.style.width="100%",n.appendChild(a),a.innerHTML=e?e.data.title:"Default theme";let s=settings.get().theming.current_theme,l=e?"theme"+e.owner_id+"_"+e.id:null,i=[];if(s!==l&&i.push([settings.lang.getValue("apply"),function(){return load.style.display="",load_indicator.style.display="",load_text_info.innerText=settings.lang.getValue("theme_updating"),themes.apply(l)}]),e&&1!==e.id&&i.push([settings.lang.getValue("delete"),function(){return pages.elements.confirm("",settings.lang.getValue("delete_theme")+"?",function(t){if(t)return themes.delete(e.owner_id,e.id).then(function(){return ui.go(window.location.href,!1,!0,!1,!0)}).catch(function(e){return ui.go({html:settings.lang.getValue("upload_error")})})})}]),e&&e.owner_id===settings.users.current.user_id&&i.push([settings.lang.getValue("edit"),function(){return ui.go("https://"+window.location.host+"/themes?section=installed&mode=edit",!1,!1,!1,!0,{theme:e})}]),t.themeData=l||null,s===l){let e=document.createElement("div");e.innerHTML=unt.Icon.SAVE,e.style.marginTop="5px",e.getElementsByTagName("svg")[0].classList.add("appliedThemeIcon"),n.appendChild(e)}else n.style.paddingBottom=n.style.paddingTop="10px";return t.oncontextmenu=t.onclick=function(e){if(e.preventDefault(),!(i.length<=0))return pages.elements.contextMenu(i).open(e)},t},audioItem:function(e,t=null,n=null){let a=document.createElement("div");a.classList=["card collection-item avatar valign-wrapper"],a.setAttribute("internalData",e.service.internal_credentials),a.style.paddingLeft="20px",a.boundAudio=audios.audiosList[e.service.internal_credentials]||new Audio(e.url),a.boundAudio.boundObject=e,audios.audiosList[e.service.internal_credentials]||(audios.audiosList[e.service.internal_credentials]=a.boundAudio,audios.audioIndex.push(e.service.internal_credentials));let s=pages.elements.createFAB(unt.Icon.PLAY,new Function);s.classList.remove("fixed-action-btn"),s.classList=["scale-transition scale-out"],4===a.boundAudio.readyState&&s.classList.remove("scale-out"),a.boundAudio.addEventListener("canplaythrough",function(e){s.classList.remove("scale-out")}),s.onclick=function(){return a.boundAudio.paused?a.boundAudio.play():a.boundAudio.pause()},a.boundAudio.addEventListener("pause",function(e){t&&audios.audiosList[audios.current].paused&&t.getControlButton().setIcon(unt.Icon.PLAY),n&&audios.audiosList[audios.current].paused&&(n.getControlButton().setIcon(unt.Icon.PLAY),n.style.display=""),s.setIcon(unt.Icon.PLAY)}),a.boundAudio.addEventListener("ended",function(a){t&&(t.style.display="none",t.getControlButton().setIcon(unt.Icon.PLAY)),n&&(n.getControlButton().setIcon(unt.Icon.PLAY),n.style.display="none"),audios.current=null,audios.playNext(e.service.internal_credentials),s.setIcon(unt.Icon.PLAY)}),a.boundAudio.addEventListener("play",function(a){audios.pauseAll(e.service.internal_credentials),t&&(t.getControlButton().setIcon(unt.Icon.PAUSE),t.style.display="",t.setArtist(e.artist),t.setTitle(e.title)),n&&(n.getControlButton().setIcon(unt.Icon.PAUSE),n.style.display="",n.setData(e.title+" - "+e.artist)),audios.current=e.service.internal_credentials,s.setIcon(unt.Icon.PAUSE),t.getRange().getInput().setAttribute("max",String(audios.audiosList[audios.current].duration))}),a.boundAudio.addEventListener("timeupdate",function(n){t&&audios.current===e.service.internal_credentials&&(t.getRange().getInput().value=Number(audios.audiosList[audios.current].currentTime),t.getMaxTime().innerText=pages.parsers.durations(parseInt(audios.audiosList[audios.current].currentTime)))}),t&&(audios.current&&(audios.audiosList[audios.current].paused||t.getControlButton().setIcon(unt.Icon.PAUSE),t.setArtist(audios.audiosList[audios.current].boundObject.artist),t.setTitle(audios.audiosList[audios.current].boundObject.title),t.getRange().getInput().setAttribute("max",String(audios.audiosList[audios.current].duration))),t.getRange().getInput().oninput=function(e){audios.audiosList[audios.current].currentTime=Number(this.value)}),a.appendChild(s);let l=document.createElement("div"),i=document.createElement("span");i.classList.add("title"),l.appendChild(i);let d=document.createElement("b");i.appendChild(d),d.innerText=e.title;let r=document.createElement("p");r.classList.add("hidet"),l.appendChild(r),r.innerText=e.artist,l.style.marginLeft="15px",a.appendChild(l);let o=document.createElement("div");return o.classList.add("secondary-content"),a.appendChild(o),o.innerText=pages.parsers.durations(e.duration),audios.current===e.service.internal_credentials&&s.setIcon(unt.Icon.PAUSE),a},createInputField:function(e,t=!1){let n=document.createElement("div");n.classList.add("input-field");let a=document.createElement("input");n.appendChild(a),a.type="text";let s="input_"+getRandomInt(100,1e7);a.id=s;let l=document.createElement("label");return t&&l.classList.add("active"),l.innerText=e,l.setAttribute("for",s),n.appendChild(l),n.getValue=function(){return a.value},n.setDisabled=function(e){return a.disabled=e||!1,n},n.setType=function(e){return a.type=e,n},n.getInput=function(){return a},n.maxLength=function(e){return a.setAttribute("maxlength",String(e)),n},n.setText=function(e){return Number(a.getAttribute("maxlength"))<=String(e).length&&(a.value=e),n},n.setReadOnly=function(e=!0){return e?a.setAttribute("readonly","true"):a.removeAttribute("readonly"),n},n},uploadError:function(){let e=document.createElement("div");e.classList=["card full_section"];let t=document.createElement("div");e.appendChild(t),t.classList.add("valign-wrapper");let n=document.createElement("div");t.appendChild(n),n.innerText=settings.lang.getValue("upload_error"),n.style.width="100%";let a=document.createElement("div");t.appendChild(a);let s=pages.elements.createFAB(unt.Icon.REFRESH,function(){return ui.go(window.location.href,!1,!0,!1,!0,{})});return s.classList.remove("fixed-action-btn"),a.appendChild(s),e},createSwitchButton:function(e=[]){let t=document.createElement("ul");return t.classList.add("collapsible"),e.forEach(function(e,n){let a=document.createElement("li");t.appendChild(a);let s=document.createElement("div");s.classList.add("collapsible-header"),s.classList.add("alink-name"),a.appendChild(s),s.style="align-items: center; position: relative",s.innerHTML=e[0];let l=document.createElement("div");s.appendChild(l),l.style.marginLeft="8px",l.innerText=e[1];let i=document.createElement("div");s.appendChild(i),i.classList.add("switch"),i.style="right: 0; margin-bottom: 5px; position: absolute";let d=document.createElement("label");i.appendChild(d);let r=document.createElement("input");d.appendChild(r),r.type="checkbox",r.oninput=function(t){return e[2](t,r)};let o=document.createElement("span");o.classList.add("lever"),d.appendChild(o),r.checked=Boolean(e[3])}),t.selectItem=function(e,n){let a=t.getElementsByClassName("collapsible-header")[e];if(a){let e=a.getElementsByTagName("input")[0];e&&(e.checked=n)}return t},t},createSelector:function(e="default",t=[]){let n=document.createElement("div");return n.classList.add("collection"),t.forEach(function(t,a){let s=document.createElement("p");n.appendChild(s);let l=document.createElement("label");s.appendChild(l);let i=document.createElement("input");l.appendChild(i),i.classList.add("with-gap"),i.type="radio",i.name=e;let d=document.createElement("span");l.appendChild(d),d.innerText=t[0],i.oninput=function(e){return t[1](e,s)}}),n.selectItem=function(e){let t=n.getElementsByTagName("p")[e];if(t){let e=t.getElementsByTagName("input")[0];e&&e.setAttribute("checked",!0)}return n},n},createCollapsible:function(e=[]){let t=document.createElement("ul");return t.classList.add("collapsible"),e.forEach(function(e,n){let a=document.createElement("li");t.appendChild(a);let s=document.createElement("div");s.classList.add("collapsible-header"),a.appendChild(s);let l=document.createElement("div");l.classList.add("collapsible-body"),a.appendChild(l),s.innerHTML=e[0];let i=document.createElement("div");i.style.marginLeft="10px",i.style.marginTop="1px",s.appendChild(i),i.innerText=e[1]}),t.getHeader=function(e){return t.getElementsByClassName("collapsible-header")[e]||null},t.getBody=function(e){return t.getElementsByClassName("collapsible-body")[e]||null},t},createButton:function(e,t,n,a="black",s=[]){let l=document.createElement("ul");l.classList.add("collapsible");let i=document.createElement("li");if(l.appendChild(i),s.length>0)s.forEach(function(t,n){let a=document.createElement("div");i.appendChild(a),a.classList.add("collapsible-header"),String(e).isEmpty()||(a.innerHTML=t[0]);let s=document.createElement("div");a.appendChild(s),s.innerHTML=t[1],String(e).isEmpty()||(s.style.marginLeft="10px"),s.style.marginTop="1px",s.style.color=t[3]||"black",a.onclick=function(e){return t[2]?t[2](e):null}});else{let s=document.createElement("div");i.appendChild(s),s.classList.add("collapsible-header"),String(e).isEmpty()||(s.innerHTML=e);let d=document.createElement("div");s.appendChild(d),d.innerHTML=t,String(e).isEmpty()||(d.style.marginLeft="10px"),d.style.marginTop="1px",d.style.color=a,l.onclick=function(e){return n?n(e):null}}return l},createFAB:function(e,t,n=[]){let a=document.createElement("div");a.classList.add("fixed-action-btn");let s=document.createElement("a");a.appendChild(s),s.classList=["btn-floating btn-large waves-effect waves-light "+["red","yellow","green","blue"][getRandomInt(0,2)]],s.innerHTML=e,s.getElementsByTagName("svg")[0].style.fill="white",s.getElementsByTagName("svg")[0].style.marginTop="28%",s.onclick=function(e){if(t)return t(e,s)};let l=document.createElement("ul");return n.length>0&&(a.appendChild(l),n.forEach(function(e){let t=e[0],n=e[1];if(!t||!n)return;let a=document.createElement("li");l.appendChild(a);let s=document.createElement("a");a.appendChild(s),s.classList=["btn-floating waves-effect waves-light "+["red","yellow","green"][getRandomInt(0,2)]],s.innerHTML=t,s.getElementsByTagName("svg")[0].style.fill="white",s.getElementsByTagName("svg")[0].style.marginTop="20%",a.onclick=function(e){return n(e,a)}})),a.setIcon=function(e){return s.innerHTML=e,s.getElementsByTagName("svg")[0].style.fill="white",s.getElementsByTagName("svg")[0].style.marginTop="28%",a},a},appItem:function(e){let t=document.createElement("a");t.classList=["card collection-item avatar"],t.href="/app"+e.id;let n=document.createElement("img");n.classList.add("circle"),t.appendChild(n),n.src=e.photo_url;let a=document.createElement("span");a.classList.add("title");let s=document.createElement("b");a.appendChild(s),s.innerHTML=e.title||"",t.appendChild(a);let l=document.createElement("p");return t.appendChild(l),l.innerText="APP ID: "+e.id,t},userItem:function(e){let t=document.createElement("a");t.classList=["card collection-item avatar"];let n=document.createElement("img");t.appendChild(n),n.src=e.photo_url,e.account_type||(n.src="https://dev.yunnet.ru/images/default.png"),n.classList.add("circle");let a=document.createElement("span");a.classList.add("title");let s=document.createElement("b");if(a.appendChild(s),s.innerText=e.name||e.first_name+" "+e.last_name,e.account_type||(s.innerText=settings.lang.getValue("deleted_account")),e.is_verified){a.classList.add("valign-wrapper");let e=document.createElement("div");a.appendChild(e),e.style.marginLeft="5px",e.innerHTML=unt.Icon.PALETTE_ANIM,e.getElementsByTagName("svg")[0].height.baseVal.value=15,e.getElementsByTagName("svg")[0].width.baseVal.value=15}t.appendChild(a),t.href="bot"===e.account_type?"/bot"+e.bot_id:"/id"+e.user_id,e.account_type||(t.href=e.user_id?"/id"+e.user_id:"/bot"+e.bot_id);let l=pages.parsers.getOnlineState(e);e.account_type||(l="");let i=document.createElement("p");return t.appendChild(i),i.innerText=l,t},buildRightMenu:function(){let e=document.createElement("div"),t=null,n=null,a=null,s=null;if(ui.isMobile()){e=document.createElement("ul"),s=document.getElementsByClassName("nav-wrapper")[0].getElementsByTagName("ul")[0],(a=document.createElement("li")).id="dropDownLi";let l=document.createElement("ul");a.appendChild(l);let i=document.createElement("li");l.appendChild(i);let d=document.createElement("a");d.classList.add("dropdown-trigger"),d.id="ui_info",d.setAttribute("data-target","ui_items"),i.appendChild(d),d.style.padding=0,d.style.marginLeft="-15px";let r=document.createElement("h");t=r,d.appendChild(r);let o=document.createElement("i");o.classList.add("right"),d.appendChild(o),o.innerHTML='<svg class="unt_icon" style="fill: white" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M7 10l5 5 5-5z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg>',(n=document.createElement("ul")).classList.add("dropdown-content"),n.id="ui_items",i.appendChild(n)}else e.classList.add("collection"),e.style.marginRight="20%";return e.addItem=function(a,s){if(!a)throw new TypeError("Text must be provided");if(!s)throw new TypeError("Callback must be provided");if(ui.isMobile()){let e=document.createElement("li");n.appendChild(e),e.select=function(){t.innerText=e.innerText};let l=document.createElement("a");return l.classList.add("waves-effect"),l.innerText=a,e.appendChild(l),l.onclick=function(t){return s(t,e)},e}{let t=e,n=document.createElement("a");return n.classList.add("collection-item"),n.classList.add("waves-effect"),n.onclick=function(e){return s(e,n)},n.innerText=a,n.select=function(){return e.querySelectorAll(".active-left").forEach(function(e){e.classList.remove("active-left")}),n.classList.add("active-left"),n},t.appendChild(n),n}},e.append=function(){try{ui.isMobile()?(nav_header_title.innerHTML="",s.appendChild(a),n.style.width="unset",n.style.height="unset"):document.getElementsByClassName("col s3")[1].appendChild(e)}catch(e){}return e},e},buildFwdItem:function(e,t){let n=document.createElement("div"),a=[];e.forEach(function(e){return a.push(e)}),n.fwdSelected=a,n.classList.add("to_fwd"),n.style.padding="5px 10px 0 10px";let s=document.createElement("blockquote");n.appendChild(s);let l=document.createElement("div");s.appendChild(l);let i=document.createElement("b");l.appendChild(i),i.innerText=settings.lang.getValue("rs");let d=document.createElement("div");return s.appendChild(d),d.innerHTML=settings.lang.getValue("selects")+": "+e.length+"/100",n.onclick=function(e){n.remove(),t&&t(e)},n.id="fwditem",n},hate:function(e){let t=pages.elements.menuBody().clear();if(document.title="yunNet.",ui.isMobile())try{nav_burger_icon.style.display="none",nav_header_title.innerText="Error message"}catch(e){}else{let e=document.getElementsByClassName("col s3"),t=e[0],n=e[1];t.innerHTML=n.innerHTML=""}let n="Unable to connect to flex API";null===e&&(n+=": Incorrect response. Do you have internet connection?"),!0===e&&(n+=": API is blocked. important data can not load now. Try again later");let a=pages.elements.alertWindow(unt.Icon.LOCKED,"Error",n),s=document.querySelectorAll("a");for(let e=0;e<s.length;e++)s[e].onclick||s[e].href.isEmpty()||(s[e].setAttribute("disabled","true"),s[e].onclick=function(e){return e.preventDefault()});unt.AutoInit(),ui.isMobile()||(document.getElementsByClassName("row")[0].style.justifyContent="center");try{site_loader.style.display="none",setTimeout(function(){return load.remove()},1e3)}catch(e){}return load_indicator.style.display="none",pages.elements.alert("Sorry, but client-side API is temporaly hidden. Please, go later.").then(function(e){load.style.display="none"}),t.appendChild(a)},messages:{getSubstring:function(e){if(e.chat_info.is_multi_chat){if(e.metadata.permissions){if(e.metadata.permissions.is_leaved)return settings.lang.getValue("you_leaved");if(e.metadata.permissions.is_kicked)return settings.lang.getValue("you_kicked")}return"ru"===settings.lang.getValue("id")?e.chat_info.data.members_count+" "+pages.parsers.morph(e.chat_info.data.members_count,pages.parsers.forms.MEMBERS_RUSSIAN):e.chat_info.data.members_count>1?e.chat_info.data.members_count+" member":e.chat_info.data.members_count+" members"}return e.chat_info.is_bot_chat?settings.lang.getValue("bot"):e.chat_info.data.account_type?pages.parsers.getOnlineState(e.chat_info.data):"..."},buildEditHeader:function(e){if(ui.isMobile()){let t=document.createElement("div");t.classList.add("nav-wrapper"),t.id="editHeader";let n=document.createElement("ul");t.appendChild(n);let a=document.createElement("li");n.appendChild(a),a.classList.add("valign-wrapper");let s=document.createElement("a");a.appendChild(s),s.classList.add("valign-wrapper"),s.style.width="100%";let l=document.createElement("i");s.appendChild(l),l.innerHTML=unt.Icon.CLOSE,s.onclick=function(t){if(e)return e(t,s)},l.getElementsByTagName("svg")[0].style.fill="white",l.getElementsByTagName("svg")[0].classList.add("unt_icon");let i=document.createElement("div");return s.appendChild(i),i.classList.add("credentials"),i.innerHTML=settings.lang.getValue("edit"),t.close=function(){return e(null,t)},t}{let t=document.createElement("div");t.classList.add("card"),t.classList.add("valign-wrapper"),t.style="padding: 15px; flex-wrap: wrap; width: 100%",t.id="editHeader";let n=document.createElement("div");n.classList.add("valign-wrapper"),n.style.width="100%",t.appendChild(n);let a=document.createElement("div");a.classList.add("back-btn"),n.appendChild(a);let s=document.createElement("a");a.appendChild(s),s.classList.add("alink-name"),s.innerHTML=unt.Icon.CLOSE,s.onclick=function(t){if(e)return e(t,s)};let l=document.createElement("div");n.appendChild(l),l.classList=["credentials dial-data valign-wrapper"],l.style.width="100%";let i=document.createElement("div");l.appendChild(i),l.style.marginBottom="7px";let d=document.createElement("div");return l.appendChild(d),d.classList.add("valign-wrapper"),i.style.width="100%",i.innerText=settings.lang.getValue("edit"),t.close=function(){return e(null,t)},t}},buildActionsHeader:function(e="",t=[],n){if(ui.isMobile()){let a=document.createElement("div");a.classList.add("nav-wrapper");let s=document.createElement("ul");a.appendChild(s);let l=document.createElement("li");s.appendChild(l),l.classList.add("valign-wrapper");let i=document.createElement("a");l.appendChild(i),i.classList.add("valign-wrapper"),i.style.width="100%";let d=document.createElement("i");i.appendChild(d),d.innerHTML=unt.Icon.CLOSE,i.onclick=function(e){if(n)return n(e,i)},d.getElementsByTagName("svg")[0].style.fill="white",d.getElementsByTagName("svg")[0].classList.add("unt_icon");let r=document.createElement("div");i.appendChild(r),r.classList.add("credentials"),a.setText=function(e){r.innerText=String(e)};let o=document.createElement("ul");return a.appendChild(o),o.classList.add("right"),a.addItem=function(e,t,n){if(!e)return null;if(!n)return null;let a=document.createElement("li");o.appendChild(a);let s=document.createElement("a");a.appendChild(s),s.href="#";let l=document.createElement("i");return l.style.marginTop="2px",s.appendChild(l),l.innerHTML=e,l.getElementsByTagName("svg")[0].style.fill="white",s.onclick=function(e){return e.preventDefault(),n(e,s)},s.enable=function(){return a.style.display=""},s.disable=function(){return a.style.display="none"},s.classList.add(t),s},String(e).isEmpty()||a.setText(e),t instanceof Array&&t.forEach(function(e){let t=e[0],n=e[1],s=e[2];return a.addItem(t,n,s)}),a.close=function(){return n(null,a)},a}{let a=document.createElement("div");a.classList.add("card"),a.classList.add("valign-wrapper"),a.style="padding: 15px; flex-wrap: wrap; width: 100%";let s=document.createElement("div");s.classList.add("valign-wrapper"),s.style.width="100%",a.appendChild(s);let l=document.createElement("div");l.classList.add("back-btn"),s.appendChild(l);let i=document.createElement("a");l.appendChild(i),i.classList.add("alink-name"),i.innerHTML=unt.Icon.CLOSE,i.onclick=function(e){if(n)return n(e,i)};let d=document.createElement("div");s.appendChild(d),d.classList=["credentials dial-data valign-wrapper"],d.style.width="100%";let r=document.createElement("div");d.appendChild(r),d.style.marginBottom="7px";let o=document.createElement("div");return d.appendChild(o),o.classList.add("valign-wrapper"),r.style.width="100%",a.setText=function(e){r.innerText=String(e)},a.addItem=function(e,t,n){if(!e)return null;if(!n)return null;let a=document.createElement("a");return a.href="#",o.appendChild(a),a.classList.add("alink-name"),a.innerHTML=e,a.style.marginLeft="8px",a.getElementsByTagName("svg")[0].style.marginTop="25%",a.onclick=function(e){return e.preventDefault(),n(e,a)},a.enable=function(){return a.style.display=""},a.disable=function(){return a.style.display="none"},a.classList.add(t),a},String(e).isEmpty()||a.setText(e),t instanceof Array&&t.forEach(function(e){let t=e[0],n=e[1],s=e[2];return a.addItem(t,n,s)}),a.close=function(){return n(null,a)},a}},buildChatHeader:function(e){if(ui.isMobile()){let t=document.createElement("li");t.id="liDifferent",document.getElementsByClassName("nav-wrapper")[0].id="chatHeader";let n=document.createElement("div");n.classList.add("valign-wrapper"),n.style.height="56px",n.style.width="250px",t.appendChild(n);let a=document.createElement("img");n.appendChild(a),a.alt="",a.classList.add("circle"),a.classList.add("chat-photo"),a.height=a.width=32,e&&(a.src=e.chat_info.data.photo_url);let s=document.createElement("a");n.appendChild(s),e.chat_info.is_multi_chat?s.href="/messages?s="+e.peer_id+"&action=info":s.href="/"+(e.chat_info.is_bot_chat?"bot"+-1*e.bot_peer_id:"id"+e.peer_id);let l=document.createElement("div");s.appendChild(l),l.style.height="100%";let i=document.createElement("div");l.appendChild(i),i.style.height="20px",i.classList.add("chat-title"),e?e.chat_info.is_multi_chat?i.innerText=e.chat_info.data.title:(i.innerText=e.chat_info.data.name||e.chat_info.data.first_name+" "+e.chat_info.data.last_name,e.chat_info.data.account_type||(i.innerText=settings.lang.getValue("deleted_account"),a.src="https://dev.yunnet.ru/images/default.png")):i.innerText="Chat";let d=document.createElement("subtext_m");l.appendChild(d),d.classList.add("members-info"),d.innerHTML=pages.elements.messages.getSubstring(e),t.close=function(){return callback(null,t)};let r=document.createElement("subtext_m");r.id="typingState",l.appendChild(r),r.style.display="none",r.classList.add("valign-wrapper"),r.innerHTML='<div style="height: 56px">'+unt.Icon.TYPING+"</div>";let o=document.createElement("div");return o.classList.add("typing-info"),r.appendChild(o),o.style.height="56px",o.style.overflow="hidden",o.style.marginLeft="10px",t}{let t=document.createElement("div");t.classList.add("card"),t.id="chatHeader",t.style="padding: 15px; flex-wrap: wrap; width: 100%; margin-bottom: 3px";let n=document.createElement("div");n.classList.add("valign-wrapper");let a=document.createElement("div");a.classList.add("back-btn"),n.appendChild(a);let s=document.createElement("a");a.appendChild(s),s.href="/messages",s.classList.add("alink-name"),s.innerHTML='<svg class="unt_icon" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"></path><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"></path></svg>';let l=document.createElement("div");l.classList=["dial-data credentials full-width valign-wrapper"];let i=document.createElement("div");l.appendChild(i),i.style="min-width: 60px; max-width: 200px";let d=document.createElement("a");d.classList=["alink-name hidet"],i.appendChild(d);let r=document.createElement("div");r.classList.add("members-info"),i.appendChild(r);let o=document.createElement("small");r.appendChild(o),o.style="color: lightgrey; margin-top: 2px",o.innerText=pages.elements.messages.getSubstring(e);let c=document.createElement("div");i.appendChild(c),c.id="typingState";let u=document.createElement("small");u.classList.add("valign-wrapper"),c.appendChild(u),u.style="color: lightgrey; margin-top: 2px",c.style.display="none",u.innerHTML=unt.Icon.TYPING;let p=document.createElement("div");u.appendChild(p),p.classList.add("credentials"),p.classList.add("typing-info");let g=document.createElement("div");g.classList.add("data-right"),g.style.marginLeft="auto",l.appendChild(g);let m=document.createElement("img");g.appendChild(m),m.alt="",m.classList.add("circle"),m.classList.add("chat-photo"),m.height=m.width=40,e&&(m.src=e.chat_info.data.photo_url),d.classList.add("chat-title"),e?e.chat_info.is_multi_chat?(d.innerText=e.chat_info.data.title,d.href="/messages?s="+(e.peer_id||"b"+-1*e.bot_peer_id)+"&action=info"):(d.innerText=e.chat_info.data.name||e.chat_info.data.first_name+" "+e.chat_info.data.last_name,e.chat_info.data.account_type||(d.innerText=settings.lang.getValue("deleted_account"),m.src="https://dev.yunnet.ru/images/default.png"),d.href="/"+("bot"===e.chat_info.data.account_type?e.chat_info.data.screen_name||"bot"+e.chat_info.data.bot_id:e.chat_info.data.screen_name||"id"+e.chat_info.data.user_id)):d.innerText="Chat",n.appendChild(l);let h=document.createElement("div");return t.appendChild(n),t.appendChild(h),t.close=function(){return callback(null,t)},t}},dialog:function(e,t={},n=null){let a=document.createElement("a");a.classList=["card collection-item avatar"],a.onclick=function(t){return t.preventDefault(),ui.go("https://"+window.location.host+"/messages?s="+(e.chat_info.is_bot_chat?"b"+-1*e.bot_peer_id:e.peer_id),!1,!1,!1,!!n,n)};let s=document.createElement("img");s.classList.add("circle"),s.alt="",s.src=e.chat_info.data.photo_url,a.appendChild(s);let l=document.createElement("span");a.appendChild(l);let i=document.createElement("b");if(i.classList.add("hidet"),l.appendChild(i),l.classList.add("title"),e.chat_info.is_multi_chat)i.innerText=e.chat_info.data.title;else if(i.innerText=e.chat_info.data.name||e.chat_info.data.first_name+" "+e.chat_info.data.last_name,e.chat_info.data.account_type||(i.innerText=settings.lang.getValue("deleted_account"),s.src="https://dev.yunnet.ru/images/default.png"),e.chat_info.data.is_verified){l.classList.add("valign-wrapper");let e=document.createElement("div");l.appendChild(e),e.style.marginLeft="5px",e.innerHTML=unt.Icon.PALETTE_ANIM,e.getElementsByTagName("svg")[0].height.baseVal.value=15,e.getElementsByTagName("svg")[0].width.baseVal.value=15}let d=e.last_message?messages.utils.toDefaultObject(e.last_message):null;if(!d)return null;let r=document.createElement("div");r.innerText="Setting up preview...";messages.utils.getPreviewString(d).then(function(t){r.innerText=t,e.last_message&&e.last_message.event&&"invited_user"===e.last_message.event.action&&settings.users.get(e.last_message.event.to_id||settings.users.current.user_id).then(function(e){r.innerText=r.innerText.replace("%when%",e.name||e.first_name+" "+e.last_name)}).catch(function(e){r.innerText=r.innerText.replace("%when%",settings.lang.getValue("deleted_account"))})});r.classList.add("hidet"),a.appendChild(r);let o=document.createElement("div");o.classList.add("secondary-content"),a.appendChild(o);let c=document.createElement("small");if(o.appendChild(c),c.innerText=pages.parsers.time(d.time),!e.metadata.is_read_by_me){a.classList.add("unreaded");let t=document.createElement("div");a.appendChild(t),t.classList.add("thirdary-content"),t.innerText=pages.parsers.niceString(e.metadata.unread_count)}return"function"==typeof t.onContext&&(a.oncontextmenu=function(n){return n.preventDefault(),t.onContext(a,n,e)}),a.id="dial_"+(e.bot_peer_id?"b"+-1*e.bot_peer_id:e.peer_id),a}},inputForm:function(e="",t={onInputCallback:null,attachmentsItemCallback:null,sendItemCallback:null,pasteCallback:null}){let n=document.createElement("div");n.draggable=!0;let a=document.createElement("div");a.id="drag-manager",n.appendChild(a),a.style.width="100%",a.style.padding="100px",a.classList.add("center"),a.innerText=settings.lang.getValue("files_here_text");let s=!1;a.style.display="none",a.addEventListener("dragover",function(e){e.preventDefault(),s||(s=!0,a.style.backgroundColor="lightgrey")}),a.addEventListener("dragleave",function(e){e.preventDefault(),s=!1,a.style.backgroundColor=""}),a.addEventListener("drop",function(e){return e.preventDefault(),a.style.backgroundColor="",a.style.display="none",t.pasteCallback(e,e.dataTransfer.files)}),n.classList=["card halign-wrapper inputchat hidesc"],n.style.margin=0;let l=document.createElement("div");l.style.display="none",n.appendChild(l);let i=document.createElement("div");l.appendChild(i),i.classList.add("container");let d=document.createElement("p");i.appendChild(d);let r=document.createElement("div");r.id="attachments_list",r.style.overflow="auto",n.appendChild(r),r.classList=["valign-wrapper"];let o=document.createElement("div");n.appendChild(o);let c=document.createElement("div");c.classList=["odiv"],n.appendChild(c),o.classList.add("valign-wrapper"),o.style.width="100%",o.style.paddingRight=o.style.paddingLeft="10px";let u=document.createElement("div");o.appendChild(u),u.style.width="100%";let p=document.createElement("textarea");p.id="write_data",p.placeholder=String(e),u.appendChild(p),p.classList=["materialize-textarea hidesc"],p.setAttribute("rows","1"),p.style="overflow-y: inherit; max-height: 250px !important; height: 43px;",p.oninput=function(e){return t.onInputCallback(e,p)},p.onpaste=function(e){e.clipboardData.files.length>0&&t.pasteCallback&&t.pasteCallback(e,e.clipboardData.files)};let g=document.createElement("div");o.appendChild(g),g.classList.add("valign-wrapper"),g.style="margin-top: auto; margin-bottom: 10px";let m=document.createElement("a");g.appendChild(m),m.classList.add("dark-its"),m.style.marginLeft="10px",m.innerHTML=unt.Icon.ATTACHMENT,m.onclick=function(e){return t.attachmentsItemCallback(e,m)};let h=document.createElement("a");g.appendChild(h),h.classList.add("dark-its"),h.style.marginLeft="10px",h.innerHTML=unt.Icon.SEND,h.onclick=function(e){return h.classList.contains("disabled")?null:t.sendItemCallback(e,h,t.sendItemCallback)};let f=document.createElement("div");g.appendChild(f),f.style.marginLeft="10px",f.style.marginRight="5px";let y=pages.elements.getLoader();return f.appendChild(y),y.setArea(20),n.getAttachmentsItem=function(){return m},n.addItem=function(e,t,n){let a=document.createElement("a");return g.insertAdjacentElement("afterbegin",a),a.hide=function(){return a.style.display="none",a},a.show=function(){return a.style.display="",a},a.addEventListener("click",function(e){return n(e,a)}),a.classList.add("dark-its"),a.classList.add(t),a.style.marginLeft="10px",a.innerHTML=e,a.getCallbackFunction=function(){return n},a},h.setLoading=function(e){return e?(h.style.display="none",f.style.display=""):(h.style.display="",f.style.display="none"),n},h.setIcon=function(e){return h.innerHTML=e},h.disable=function(){return h.classList.add("disabled")},h.enable=function(){return h.classList.remove("disabled")},n.getSendItem=function(){return h},n.setErrorMessage=function(e){return d.innerText=e,l.style.display="",r.style.display="none",o.style.display="none",n},n.hideErrorMessage=function(){return d.innerText="",l.style.display="none",r.style.display="",o.style.display="",n},n.arguments=arguments,h.setLoading(!1)},postEditor:function(e){if(!settings.users.current)return null;if(e.owner_id!==settings.users.current.user_id)return null;let t=document.createElement("div");t.classList.add("modal"),t.classList.add("bottom-sheet"),t.open=function(){document.body.appendChild(t);let e=unt.Modal.init(t,{onCloseEnd:function(){return t.remove()}});return e&&e.open(),unt.textareaAutoResize(o),unt.updateTextFields(),t.style.top=0,t.style.width=t.style.height="100%",t.style.borderRadius=0,!0},t.close=function(){return unt.Modal.getInstance(t).close()};let n=document.createElement("div");n.classList.add("modal-content");let a=document.createElement("div");n.appendChild(a),a.classList.add("valign-wrapper"),a.style.width="100%";let s=document.createElement("div");a.appendChild(s),s.style.width="100%",s.innerText=settings.lang.getValue("edit_post");let l=document.createElement("div");l.style.cursor="pointer",l.style.marginTop="5px",a.appendChild(l),l.innerHTML=unt.Icon.CLOSE,l.addEventListener("click",function(){t.close()}),n.appendChild(document.createElement("br"));let i=document.createElement("div");i.classList.add("modal-footer"),i.classList.add("valign-wrapper"),t.appendChild(n),t.appendChild(i);let d=document.createElement("div");d.classList.add("valign-wrapper"),n.appendChild(d);let r=document.createElement("div");d.appendChild(r),r.classList.add("input-field"),r.style.width="100%";let o=document.createElement("textarea");r.appendChild(o),o.classList.add("materialize-textarea"),o.id="editorArea";let c=document.createElement("label");r.appendChild(c),c.setAttribute("for",o.id),String(e.text).isEmpty()||c.classList.add("active"),c.innerHTML=settings.lang.getValue("write_a_post"),o.innerHTML=String(e.text),unt.updateTextFields();let u=document.createElement("div");n.appendChild(u),u.classList.add("valign-wrapper"),e.attachments&&e.attachments.forEach(function(e){u.appendChild(pages.parsers.attachment(e,function(){return pages.parsers.attachmentsValid(u,o)?g.removeAttribute("disabled"):g.setAttribute("disabled","true")}))}),o.oninput=function(){return pages.parsers.attachmentsValid(u,o)?g.removeAttribute("disabled"):g.setAttribute("disabled","true")};let p=document.createElement("div");i.appendChild(p),p.style.marginLeft="10px",p.innerHTML=unt.Icon.ATTACHMENT,p.onclick=function(){return pages.elements.contextMenu([[settings.lang.getValue("photo"),function(){return pages.elements.fileUploader({onFileSelected:function(e,t,n){return n.setLoading(!0),uploads.getURL().then(function(e){return uploads.upload(e,t[0],function(e){return codes.callbacks.uploadResolve(e,n)}).then(function(e){return n.setLoading(!1),u.appendChild(pages.parsers.attachment(e,function(){pages.parsers.attachmentsValid(u,o)?g.removeAttribute("disabled"):g.setAttribute("disabled","true")})),n.close()}).catch(function(e){let t=settings.lang.getValue("upload_error");return unt.toast({html:t}),n.setLoading(!1)})}).catch(function(e){let t=settings.lang.getValue("upload_error");return unt.toast({html:t}),n.setLoading(!1)})},afterClose:function(e,t){pages.parsers.attachmentsValid(u,o)?g.removeAttribute("disabled"):g.setAttribute("disabled","true")}}).open()}],[settings.lang.getValue("poll"),function(){return poll.pinned(u)?unt.toast({html:settings.lang.getValue("upload_error")}):poll.creator(function(e,t){let n=pages.elements.createPollElement(e.poll,function(){pages.parsers.attachmentsValid(u,o)?g.removeAttribute("disabled"):g.setAttribute("disabled","true")});u.appendChild(n),pages.parsers.attachmentsValid(u,o)?g.removeAttribute("disabled"):g.setAttribute("disabled","true")}).show()}]]).open(event,!0)};let g=document.createElement("a");return g.style.marginLeft="auto",i.appendChild(g),g.innerHTML="Continue",g.classList=["btn-flat alink-name waves-effect modal-close"],g.innerHTML=settings.lang.getValue("continue"),g.setAttribute("disabled","true"),g.onclick=function(){let n=pages.parsers.attachmentsString(u);return g.setAttribute("disabled","true"),posts.actions.edit(e.user_id,e.id,String(o.value),n).then(function(e){g.removeAttribute("disabled");let n=document.getElementById("wall"+e.user_id+"_"+e.id),a=pages.elements.post(e);return t.close(),n?n.replaceWith(a):document.getElementById("posts_list")?posts_list.prepend(a):news_list.prepend(a)}).catch(function(e){g.removeAttribute("disabled");let t=settings.lang.getValue("upload_error");return unt.toast({html:t})})},t},getLoader:function(e=!0){if(e){let e=document.createElement("div");return e.hide=function(){return this.style.display="none",this},e.show=function(){return this.style.display="",this},e.setArea=function(t){let n=e.getElementsByTagName("svg")[0];return n?(n.width.baseVal.value=Number(t),n.height.baseVal.value=Number(t),!0):null},e.setColor=function(t){let n=e.getElementsByTagName("path")[0];return n&&(n.style.fill=t),e},e.classList.add("center"),e.innerHTML=unt.Icon.LOADER,e}{let e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("viewBox","0 0 100 100");let t=document.createElementNS("http://www.w3.org/2000/svg","circle");return e.appendChild(t),t.setAttribute("cx","50"),t.setAttribute("cy","50"),t.setAttribute("r","45"),t.style.maxWidth="100px",t.style.fill="transparent",t.style.stroke="var(--unt-loader-color, #42a5f5)",t.style.strokeWidth="10px",t.style.borderStyle="dashed",t.style.strokeLinecap="round",t.style.transformOrigin="50% 50%",t.style.strokeDasharray="283",t.style.strokeDashoffset="0",e.style.overflow="visible",e.hide=function(){return e.style.display="none"},e.show=function(){return e.style.display=""},e.setArea=function(t){return!isNaN(Number(t))&&(!(Number(t)<=0)&&(e.style.width=t+"px"))},e.setProgress=function(e=0){if(isNaN(Number(e)))return!1;if(e>100||e<0)return!1;let n=Number(Number(t.style.strokeDasharray)-Number(t.style.strokeDasharray)*Number(e)/100);return t.style.strokeDashoffset=n},e.setColor=function(n){return t.style.stroke=n,e},e.setArea(40),e.classList.add("center"),e}},menuBody:function(){let e=ui.isMobile()?document.getElementById("menu"):document.getElementsByClassName("col s6")[0];return e.addEventListener("drop",function(e){return e.preventDefault()}),e.addEventListener("dragstart",function(e){return e.preventDefault()}),e.clear=function(){let t=document.createElement("div");return e.innerHTML="",e.appendChild(t),t},e.getCurrent=function(){return e.getElementsByTagName("div")[0]},e},wallInput:function(e={attachFileCallback:null,publishSettingsCallback:null,publishCallback:null,inputTextCallback:null,photoUrl:settings.users.current.photo_url,hideInputButton:!1,pasteCallback:null}){let t=document.createElement("ul");t.classList.add("collapsible");let n=document.createElement("li"),a=document.createElement("div"),s=document.createElement("div");a.classList.add("collapsible-header"),s.classList.add("collapsible-body");let l=document.createElement("div");l.classList.add("valign-wrapper");let i=document.createElement("div"),d=document.createElement("div");i.innerHTML=unt.Icon.HAND,d.innerText=settings.lang.getValue("write_a_post"),d.style="margin-left: 10px; margin-bottom: 5px",l.appendChild(i),l.appendChild(d);let r=document.createElement("div");r.classList.add("valign-wrapper");let o=document.createElement("img");o.alt="",o.src=e.photoUrl||settings.user.current_user.photo_url,o.width=32,o.height=32,o.classList.add("circle"),r.appendChild(o);let c=document.createElement("div");c.style="width: 100%; margin-left: 15px",c.classList.add("input-field");let u=document.createElement("textarea");u.oninput=function(t){return e.inputTextCallback(t,u)},u.onpaste=function(t){t.clipboardData.files.length>0&&e.pasteCallback&&e.pasteCallback(t,t.clipboardData.files)},u.classList.add("materialize-textarea"),u.type="text",u.style="height: 43px;",u.id="write_text";let p=document.createElement("label");p.setAttribute("for",u.id),p.innerText=settings.lang.getValue("write_a_post"),c.appendChild(u),c.appendChild(p),r.appendChild(c);let g=document.createElement("div");g.classList.add("valign-wrapper"),g.id="attachments";let m=document.createElement("div");m.id="tools",m.classList.add("valign-wrapper");let h=document.createElement("div");h.id="items_tools",h.classList.add("valign-wrapper");let f=document.createElement("a");f.onclick=function(t){return e.publishSettingsCallback(t,f)},f.id="publish_settings",f.innerHTML=unt.Icon.SETTINGS,h.appendChild(f),attachFileItem=document.createElement("a"),attachFileItem.onclick=function(t){return e.attachFileCallback(t,attachFileItem)},attachFileItem.id="attach_file",attachFileItem.style="margin-left: 10px",attachFileItem.innerHTML=unt.Icon.ATTACHMENT,h.appendChild(attachFileItem),m.appendChild(h);let y=document.createElement("div");y.id="publish",y.style="text-align: end; width: 100%";let _=document.createElement("a");_.onclick=function(t){return e.publishCallback(t,_)},_.id="submit_data",_.classList=["btn-floating red btn-large waves-effect waves-light scale-transition"],_.innerHTML='<i><svg style="margin-top: 28%; fill: white" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/></svg></i>',y.appendChild(_),e.hideInputButton&&_.classList.add("scale-out");let v=document.createElement("div");return v.id="loader_file_ui_publish",v.style.display="none",v.innerHTML='<svg width="40" height="40" viewBox="0 0 50 50"><path id="loader_ui_spin" transform="rotate(61.2513 25 25)" d="M25,5A20.14,20.14,0,0,1,45,22.88a2.51,2.51,0,0,0,2.49,2.26h0A2.52,2.52,0,0,0,50,22.33a25.14,25.14,0,0,0-50,0,2.52,2.52,0,0,0,2.5,2.81h0A2.51,2.51,0,0,0,5,22.88,20.14,20.14,0,0,1,25,5Z" fill="#42a5f5"><animateTransform attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.3s" repeatCount="indefinite"></animateTransform></path></svg>',y.appendChild(v),m.appendChild(y),s.appendChild(r),s.appendChild(g),s.appendChild(m),a.appendChild(l),n.appendChild(a),n.appendChild(s),t.appendChild(n),_.setLoading=function(e){return e?(_.style.display="none",v.style.display=""):(_.style.display="",v.style.display="none"),!0},t.showInputButton=function(){return _.classList.remove("scale-out")},t.hideInputButton=function(){return _.classList.add("scale-out")},t.getLoader=function(){return _},t},actionsMenu:function(e=[],t=!1,n=!1,a=!1){let s=document.createElement("ul");s.classList.add("collapsible");let l=document.createElement("li");s.appendChild(l);let i=document.createElement("div"),d=document.createElement("div");i.classList.add("collapsible-header"),d.classList.add("collapsible-body"),l.appendChild(i),l.appendChild(d),i.innerHTML=unt.Icon.DOWN_ARROW,t&&(i.innerHTML=unt.Icon.LOCKED),n||(i.innerHTML=unt.Icon.LOCKED),a&&(i.innerHTML=unt.Icon.LOCKED);let r=document.createElement("div");if(t&&(r.innerText=settings.lang.getValue("you_blocked")),n||(r.innerText=settings.lang.getValue("need_login")),n&&!t&&(r.innerText=settings.lang.getValue("actions")),a&&(r.innerText=settings.lang.getValue("you_kicked")),r.style["margin-left"]="10px",i.appendChild(r),e instanceof Array){let t=document.createElement("div");t.classList.add("collection"),d.appendChild(t),e.forEach(function(e){let n=e[0],a=e[1],s=e[2]||"no";if("string"!=typeof n)throw new TypeError("Button name must be a string");if("function"!=typeof a)throw new TypeError("Click handler must be a function");let l=document.createElement("a");return l.classList.add("collection-item"),l.innerText=n,l.onclick=function(e){return a(e,l)},l.classList.add(s),t.appendChild(l)})}return s},comment:function(e){let t=settings.users.current&&Number(settings.users.current.user_id)||0,n=document.createElement("div");n.classList.add("collection-item"),n.classList.add("avatar");let a=document.createElement("img");a.classList.add("circle"),n.appendChild(a);let s=document.createElement("span");n.appendChild(s);let l=document.createElement("a");s.appendChild(l),l.href=e.owner_id>0?"/id"+e.owner_id:"/bot"+-1*e.owner_id;let i=document.createElement("b");if(l.appendChild(i),l.classList.add("alink-name"),i.innerText="...",i.classList.add("title"),e.text){let t=document.createElement("div");t.classList.add("comment-text-hidden"),n.appendChild(t),t.onclick=function(){return t.classList.contains("comment-text-hidden")?t.classList.remove("comment-text-hidden"):t.classList.add("comment-text-hidden")},t.innerHTML=nl2br(htmlspecialchars(e.text)).linkify()}if(e.attachments){let t=pages.elements.attachmentsGroup(e.attachments),a=document.createElement("div");a.appendChild(document.createElement("br")),n.appendChild(a),a.appendChild(t)}if(settings.users.current){let a=document.createElement("div");a.classList.add("secondary-content"),a.onclick=n.oncontextmenu=function(a){return a.preventDefault(),e.owner_id===t?pages.elements.contextMenu([[settings.lang.getValue("edit"),new Function],[settings.lang.getValue("delete"),function(){return pages.elements.confirm("",settings.lang.getValue("delete_comment")+"?",function(t){if(t){let t=String(String(window.location.href.split(window.location.host)[1]).split("/wall")[1]).split("_"),a=Number(t[0]),s=Number(t[1]),l=Number(e.comment_id);return posts.comments.delete(a,s,l).then(function(){return n.remove()}).catch(function(e){let t=settings.lang.getValue("upload_error");return unt.toast({html:t})})}})}]]).open(a):pages.elements.contextMenu([[settings.lang.getValue("report"),new Function]]).open(a)},a.innerHTML=unt.Icon.MORE,n.appendChild(a)}let d=document.createElement("div");d.classList.add("valign-wrapper"),n.appendChild(d);let r=pages.parsers.time(e.time),o=document.createElement("small");return o.style.color="lightgrey",o.style.width="100%",d.appendChild(o),o.innerHTML=r,n.classList.add("card"),n.style.borderRadius=0,settings.users.get(e.owner_id).then(function(e){if(i.innerText="bot"===e.account_type?e.name:e.first_name+" "+e.last_name,a.src=e.photo_url,e.is_verified){s.classList.add("valign-wrapper");let e=document.createElement("div");s.appendChild(e),e.style.marginLeft="5px",e.innerHTML=unt.Icon.PALETTE_ANIM,e.getElementsByTagName("svg")[0].height.baseVal.value=13,e.getElementsByTagName("svg")[0].width.baseVal.value=13}if(settings.users.current){let t=document.createElement("a");t.style.cursor="pointer",d.appendChild(t),t.innerHTML=unt.Icon.REPLY,t.onclick=function(){try{return write_data.value="@"+(e.screen_name?e.screen_name:e.name?"bot"+e.bot_id:"id"+e.user_id)+" ("+(e.name||e.first_name)+"), ",unt.textareaAutoResize(write_data),unt.updateTextFields(),write_data.focus()}catch(e){return t.remove()}}}}).catch(function(e){i.innerText=settings.lang.getValue("deleted_account"),a.src="https://dev.yunnet.ru/images/default.png"}),n},post:function(e,t=!0,n=!1,a=!1){e.text||(e.text=""),e.comments||(e.comments={count:0});const s=unt.Icon.PIN,l=unt.Icon.LIKE_SET,i=unt.Icon.LIKE,d=unt.Icon.COMMENTS;let r=document.createElement("div");r.classList.add("card"),r.classList.add("full_section"),r.id="wall"+e.user_id+"_"+e.id,t&&(r.oncontextmenu=function(t){return t.preventDefault(),pages.parsers.menu.posts.buildContextMenu(e).open(t)});let o=document.createElement("div");o.classList.add("valign-wrapper"),o.classList.add("post_info_and_actions"),r.appendChild(o);let c=document.createElement("a");c.classList.add("post_owner"),c.classList.add("valign-wrapper"),c.href=e.owner_id>0?"/id"+e.owner_id:"/bot"+-1*e.owner_id,c.style.width="100%",o.appendChild(c);let u=document.createElement("img");u.classList.add("circle"),u.alt="",u.width=32,u.height=32,c.appendChild(u);let p=document.createElement("div");p.classList.add("credentials"),p.classList.add("halign-wrapper"),c.appendChild(p);let g=document.createElement("div");g.classList.add("name_data"),g.classList.add("alink-name"),p.appendChild(g);let m=document.createElement("div");m.classList.add("valign-wrapper"),g.appendChild(m);let h=document.createElement("div"),f=document.createElement("div");f.style.transform="rotate(45deg)",f.style["margin-left"]="5px",f.style["margin-top"]="3px",h.innerText=settings.lang.getValue("loading"),m.appendChild(h),m.appendChild(f),e.is_pinned&&(f.innerHTML=s);let y=document.createElement("div"),_=document.createElement("small");if(_.style.color="lightgrey",y.appendChild(_),_.innerHTML=pages.parsers.time(e.time),g.appendChild(y),settings.users.current&&settings.users.current.user_id>0&&t){let t=document.createElement("a");t.classList.add("actions-btn"),t.onclick=function(t){return pages.parsers.menu.posts.buildContextMenu(e).open(t)},t.style.color="black",t.style["margin-left"]="15px",t.innerHTML=unt.Icon.MORE,o.appendChild(t)}r.appendChild(document.createElement("br"));let v=document.createElement("div");if(e.event){"updated_photo"===e.event.type&&(v.style.color="lightgrey",v.innerHTML=settings.lang.getValue("updated_profile_photo"),r.appendChild(v),r.appendChild(document.createElement("br")))}let w=document.createElement("div");w.style.width="100%",a&&(w.style.overflow="auto",w.style.maxHeight="370px"),w.innerHTML=nl2br(htmlspecialchars(e.text)).linkify(),a||(w.onclick=function(t){if("A"!==t.target.nodeName)return ui.isMobile()?ui.go("https://"+window.location.host+"/wall"+e.user_id+"_"+e.id):pages.parsers.menu.posts.openWindowPost(e)}),r.appendChild(w);let E=!1;if(!n&&e.text.length>256){w.classList.add("post_data");let e=document.createElement("div");e.style.cursor="pointer",e.style.color="#2196f3",e.innerText=settings.lang.getValue("show_more"),e.onclick=function(t){E?(w.classList.add("post_data"),e.innerText=settings.lang.getValue("show_more")):(w.classList.remove("post_data"),e.innerText=settings.lang.getValue("hide")+"..."),E=!E},r.appendChild(e)}let b=pages.elements.attachmentsGroup(e.attachments);r.appendChild(b),r.appendChild(document.createElement("br"));let L=document.createElement("div");L.classList.add("post_counters"),L.classList.add("valign-wrapper");let C=null;if(settings.users.current){C=document.createElement("div"),settings.users.current.user_id>0?C.onclick=function(){return likes.set("wall"+e.user_id+"_"+e.id,function(e,t,n){1===e&&(C.getElementsByClassName("not_like")[0].style.display="none",C.getElementsByClassName("liked_ok")[0].style.display=""),0===e&&(C.getElementsByClassName("not_like")[0].style.display="",C.getElementsByClassName("liked_ok")[0].style.display="none");let a=C.getElementsByClassName("count")[0];a&&(a.innerHTML=t)})}:C.onclick=function(){return ui.go(window.location.host)},C.id="like_it",C.classList.add("valign-wrapper");let t=document.createElement("div");t.classList.add("valign-wrapper"),t.innerHTML=i+l;let n=document.createElement("div");n.classList.add("count"),n.style["margin-left"]="6px",n.style["font-size"]="115%",C.appendChild(t),C.appendChild(n),e.like_me&&(C.getElementsByClassName("not_like")[0].style.display="none",C.getElementsByClassName("liked_ok")[0].style.display=""),e.likes>0&&(C.getElementsByClassName("count")[0].innerHTML=String(Number(e.likes)))}let T=document.createElement("div");T.classList.add("valign-wrapper"),T.innerHTML=d,settings.users.current&&L.appendChild(C);let x="";if(t){let t=document.createElement("div");t.classList.add("valign-wrapper"),settings.users.current&&(t.style["margin-left"]="10px"),t.onclick=function(){return ui.go("https://"+window.location.host+"/wall"+e.user_id+"_"+e.id)},(x=document.createElement("div")).classList.add("comms_count"),x.style="margin-left: 6px; margin-right: 6px; font-size: 115%",t.appendChild(T),t.appendChild(x),L.appendChild(t)}return r.appendChild(L),e.comments.count>0&&(x.innerHTML=String(Number(e.comments.count))),settings.users.get(e.owner_id).then(function(e){if(v&&(v.innerHTML=settings.lang.getValue("updated_profile_photo").replace("(а)",2===e.gender?"а":"")),u.src=e.photo_url,h.innerText=e.user_id?e.first_name+" "+e.last_name:e.name,e.is_verified){let e=document.createElement("div");e.style.marginLeft="5px",h.appendChild(e),h.classList.add("valign-wrapper");let t=document.createElement("div");t.style.margin=0,t.style.cursor="pointer",t.style.width=t.style.height="20px",t.style.borderRadius="30px",t.innerHTML=unt.Icon.PALETTE_ANIM,e.appendChild(t)}}).catch(function(e){u.src="https://dev.yunnet.ru/images/default.png",h.innerText=settings.lang.getValue("deleted_account")}),r},attachmentsGroup:function(e=[],t=!1){let n=document.createElement("div");t&&(n.id="out_atts"),n.classList.add("attachments"),n.style.maxWidth="340px";let a=[],s=null;for(let t=0;t<e.length;t++)"poll"===e[t].type?s=e[t]:a.push(e[t]);if(s&&a.push(s),a.length>0){let e=!1,t=!1,s=!1,l=1,i=null,d=100;for(let r=0;r<a.length&&!(r>=10);r++){if("poll"===a[r].type){let e=document.createElement("div");e.boundAttachment=a[r],e.setAttribute("attachment","poll"+a[r].poll.owner_id+"_"+a[r].poll.id+"_"+a[r].poll.access_key),e.classList.add("card"),e.classList.add("full_section"),e.style="background-color: #909090 !important",n.appendChild(e);let t=document.createElement("div");t.style.textAlign="center";let s=document.createElement("b");t.appendChild(s),s.style.color="var(--unt-poll-title-color, white)",e.appendChild(t),s.innerText=a[r].poll.data.title;let l=document.createElement("div");pollInfoText=document.createElement("small"),l.style.textAlign="center",pollInfoText.style.color="var(--unt-poll-info-color, lightgrey)",e.appendChild(l),l.appendChild(pollInfoText),pollInfoText.innerText=(a[r].poll.data.is_anonymous?settings.lang.getValue("poll_anonymous"):settings.lang.getValue("poll_public"))+" • "+pages.parsers.time(a[r].poll.creation_time),e.appendChild(document.createElement("br"));let i=document.createElement("div");i.style.display="grid",i.style.width="100%",e.appendChild(i);let d=!1,o=!0;a[r].poll.variants_list.forEach(function(e){let t=document.createElement("a");t.classList=["card waves-effect waves-light valign-wrapper hidet-aone"],t.style="background-color: gray !important";let n=document.createElement("div");t.appendChild(n),n.innerText=e.text,t.style.cursor="pointer",t.style.display="flex",t.style.justifyContent="space-between",t.style.padding="10px",t.style.margin="3px",t.style.color="white",t.style.zIndex=0;let a=document.createElement("div");t.appendChild(a);let s=pages.elements.getLoader().setColor("white");s.setArea(15),s.style.display="none",a.appendChild(s);let l=document.createElement("div");return l.innerHTML=unt.Icon.SAVE,a.appendChild(l),l.getElementsByTagName("svg")[0].height.baseVal.value=15,l.getElementsByTagName("svg")[0].width.baseVal.value=15,l.style.display="none",t.addEventListener("click",function(e){if(!d)return d=!0,s.style.display="",setTimeout(function(){s.style.display="none",l.style.display="",o=!0},2e3)}),i.appendChild(t)})}if("photo"===a[r].type){if(r>=0&&r<=1&&!e){let t=document.createElement("div");t.classList.add("attachments_line_1"),e=!0,l=1,d=50;let a=document.createElement("p");t.appendChild(a),a.classList.add("valign-wrapper"),a.style.height="150px",i=a,n.appendChild(t)}if(r>=2&&r<=4&&!t){let e=document.createElement("div");e.classList.add("attachments_line_2"),t=!0,l=2,d=33.3;let a=document.createElement("p");e.appendChild(a),a.classList.add("valign-wrapper"),a.style.height="100px",i=a,n.appendChild(e)}if(r>=5&&r<=9&&!s){let e=document.createElement("div");e.classList.add("attachments_line_3"),s=!0,l=3,d=20;let t=document.createElement("p");e.appendChild(t),t.classList.add("valign-wrapper"),t.style.height="50px",i=t,n.appendChild(e)}let o=document.createElement("div");o.style.height="100%",o.style.maxWidth="100%",o.style.margin="2px",i.appendChild(o);let c=new Image;c.width=a[r].photo.meta.width,c.height=a[r].photo.meta.height,o.appendChild(c),c.loading="lazy",c.src=a[r].photo.url.main,c.classList.add("attachment_tile"),c.style.minWidth=d,c.setAttribute("attachment","photo"+a[r].photo.owner_id+"_"+a[r].photo.id+"_"+a[r].photo.access_key),c.boundAttachment=a[r],c.onclick=function(){return photos.show(this,a[r].photo)}}}}return n},alertWindow:function(e,t,n){let a=document.createElement("div");a.id="alertWindow",a.classList.add("card");let s=document.createElement("div");s.classList=["container center"],a.appendChild(s),s.appendChild(document.createElement("br"));let l=document.createElement("div");l.innerHTML=e;let i=l.getElementsByTagName("svg")[0];s.appendChild(i),i.width.baseVal.value=96,i.height.baseVal.value=96;let d=document.createElement("div");s.appendChild(d);let r=document.createElement("h4"),o=document.createElement("b");o.innerText=String(t),r.appendChild(o),d.appendChild(r),String(n).isEmpty()||d.appendChild(document.createElement("br"));let c=document.createElement("div");return c.innerText=String(n),d.appendChild(c),String(n).isEmpty()||d.appendChild(document.createElement("br")),a},backArrowButton:function(e,t){let n=document.createElement("ul");n.classList.add("collapsible");let a=document.createElement("li");n.appendChild(a);let s=document.createElement("div");s.classList.add("collapsible-header"),a.appendChild(s);let l=document.createElement("div");l.classList.add("valign-wrapper"),s.appendChild(l);let i=document.createElement("a");i.innerHTML=unt.Icon.BACK_ARROW,i.onclick=function(e){return t?t(e):ui.go(null,!0)},l.appendChild(i);let d=document.createElement("div");return d.style.marginLeft="10px",d.style.marginBottom="5px",d.innerHTML=e||settings.lang.getValue("back"),n.setText=function(e){d.innerHTML=e||settings.lang.getValue("back")},l.appendChild(d),n},contextMenu:function(e=[]){if(ui.isMobile()){let t=document.createElement("div");t.classList=["modal bottom-sheet"];let n=document.createElement("div");t.appendChild(n);let a=document.createElement("div");return a.classList.add("collection"),a.style.backgroundColor="inherit",n.appendChild(a),e.forEach(function(e){let n=document.createElement("a");n.classList.add("unselectable"),n.style.backgroundColor="inherit";let s=e[0],l=e[1];if("string"!=typeof s)throw new TypeError("Only strings as text allowed");if("function"!=typeof l)throw new TypeError("Only functions allowed to onclick handler");n.innerText=s,n.addEventListener("click",function(e){return l(e,n,t),t.close()}),n.classList=["collection-item alink-name"],a.appendChild(n)}),t.open=function(){document.body.appendChild(this);let e=unt.Modal.init(this,{onCloseEnd:function(){return t.remove()}});return e?e.open():null},t.close=function(){let e=unt.Modal.getInstance(t);return e?e.close():null},t}{let t=null;document.getElementById("tmp-dropdown")?(t=document.getElementById("tmp-dropdown")).innerHTML="":(t=document.createElement("ul")).classList.add("dropdown-content");let n=null;return document.getElementById("tmp-trigger")?n=document.getElementById("tmp-trigger"):(n=document.createElement("a")).id="tmp-trigger",e.forEach(function(e){let a=document.createElement("li");a.classList.add("unselectable");let s=e[0],l=e[1];if("string"!=typeof s)throw new TypeError("Only strings as text allowed");if("function"!=typeof l)throw new TypeError("Only functions allowed to onclick handler");let i=document.createElement("a");return a.appendChild(i),i.innerText=s,i.addEventListener("click",function(e){return l(e,i,t),t.close()}),t.id="tmp-dropdown",t.open=function(e,a=!1){if(!e)return null;let s=Number(e.pageX),l=Number(e.pageY);return n.classList.add("dropdown-trigger"),n.setAttribute("data-target",t.id),document.getElementById(n.id)||document.body.appendChild(n),document.getElementById(t.id)||document.body.appendChild(t),unt.Dropdown.init(n,{onCloseEnd:function(){n.remove(),t.remove()}}).open(),this.style.position="absolute",this.style.top=String(a?l-100:l)+"px",this.style.left=String(s)+"px",this.style.width="auto",this.style.height="",!0},t.close=function(){let e=unt.Dropdown.getInstance(n);return e?e.close():null},t.appendChild(a)}),t}},confirm:function(e,t,n,a=!0){let s=document.createElement("div");s.classList.add("modal"),ui.isMobile()&&s.classList.add("bottom-sheet");let l=document.createElement("div");l.classList.add("modal-content");let i=document.createElement("div");i.classList.add("modal-footer"),s.appendChild(l),s.appendChild(i);let d=document.createElement("a");d.classList=["waves-effect btn-flat"],a||d.classList.remove("modal-close"),d.innerText=settings.lang.getValue("no"),i.appendChild(d);let r=document.createElement("a");if(r.classList=["waves-effect btn-flat"],a||r.classList.remove("modal-close"),r.innerText=settings.lang.getValue("yes"),i.appendChild(r),!n)return null;if(!String(e).isEmpty()){let t=document.createElement("h4");t.innerText=String(e),l.appendChild(t)}let o=document.createElement("p");String(e).isEmpty()&&(o=document.createElement("div")),o.innerHTML=String(t),l.appendChild(o),document.body.appendChild(s);let c=unt.Modal.init(s,{endingTop:a?"35%":"10%",onCloseEnd:function(){if(s.remove(),!u)return n(!1,c,r,d)}}),u=!1;return r.addEventListener("click",function(){n(!0,c,r,d),u=!0,a&&c.close()}),d.addEventListener("click",function(){n(!1,c,r,d),u=!0,a&&c.close()}),c&&c.open(),s.getBody=function(){return l},s},fileUploader:function(e={onFileSelected:null,afterClose:null,fileTypes:"image/*"}){let t=document.createElement("div");t.classList.add("modal"),ui.isMobile()&&t.classList.add("bottom-sheet");let n=document.createElement("div");t.appendChild(n),n.classList.add("modal-content"),n.innerHTML="<h4>"+settings.lang.getValue("select_a_file")+"</h4>";let a=document.createElement("div");t.appendChild(a),a.style.marginLeft="27px",a.style.marginRight="27px";let s=document.createElement("form");a.appendChild(s);let l=document.createElement("div");s.appendChild(l),l.classList=["file-field input-field"];let i=document.createElement("div");l.appendChild(i),i.classList=["btn"];let d=document.createElement("span");i.appendChild(d),d.innerText=settings.lang.getValue("select_file");let r=document.createElement("input");i.appendChild(r),r.type="file",r.accept=e.fileTypes||"image/*",r.oninput=function(n){return e.onFileSelected(n,n.target.files,t)},t.selectFile=function(n){return t.getElementsByClassName("file-path")[0].value=n[0].name,e.onFileSelected(new Event("input"),n,t),t};let o=document.createElement("div");l.appendChild(o),o.classList=["file-path-wrapper"];let c=document.createElement("input");o.appendChild(c),c.classList=["file-path validate"],c.placeholder=settings.lang.getValue("selected"),c.type="text";let u=document.createElement("div");t.appendChild(u),u.classList.add("modal-footer");let p=document.createElement("a");u.appendChild(p),p.classList=["btn-flat"];let g=document.createElement("div");g.innerText=settings.lang.getValue("continue"),g.classList.add("modal-close"),g.onclick=function(n){return e.afterClose(n,t)};let m=pages.elements.getLoader(!1);return m.style.display="none",m.setArea(20),m.classList.remove("center"),p.appendChild(m),p.appendChild(g),t.setLoading=function(e){return e?(m.setProgress(0),m.style.display="",g.style.display="none"):(m.style.display="",g.style.display="none"),!0},t.setProgress=function(e){return m.setProgress(e)},t.toggleFileSelection=function(){return"true"===r.getAttribute("disabled")?(r.setAttribute("disabled","false"),c.setAttribute("disabled","false")):(r.setAttribute("disabled","true"),c.setAttribute("disabled","true")),!0},t.open=function(){return document.body.appendChild(t),unt.Modal.init(t,{dismissible:!1,onCloseEnd:function(){return t.remove()}}).open(),t},t.close=function(){return unt.Modal.getInstance(t).close()},t.addFooterItem=function(e,n){if(String(e).isEmpty())return null;if("function"!=typeof n)return null;let a=document.createElement("a");u.insertAdjacentElement("afterbegin",a),a.classList=["btn-flat"];let s=document.createElement("div");s.innerText=e,a.appendChild(s);let l=pages.elements.getLoader();return l.style.display="none",l.setArea(20),l.classList.remove("center"),a.appendChild(l),a.setLoading=function(e){l.style.display="",s.style.display="none"},n&&(a.onclick=function(e){return n(e,a,t)}),a},t.style.overflow="hidden",t}},parsers:{attachmentsValid:function(e,t){return e.getElementsByTagName("div").length>0||!String(t.value).isEmpty()},typingText:function(e,t=null){t||(t=document.createElement("div")),t.innerHTML="";for(let n=0;n<e.length;n++){let a=e[n];settings.users.get(a).then(function(a){n>2?3===n&&(t.innerHTML+=settings.lang.getValue("and_more")+" "+(e.length-n)+" ","ru"===settings.lang.getValue("id")?t.innerHTML+=pages.parsers.morph(e.length-n,pages.parsers.forms.PEOPLE_RUSSIAN):t.innerHTML+=settings.lang.getValue("people")):(t.innerHTML+=(a.name||a.first_name+" "+a.last_name.substr(0,1))+".",n!==e.length-1&&(t.innerHTML+=", "))}).catch(function(e){})}},durations:function(e){let t=parseInt(e/60);t<10&&(t="0"+t);let n=e-60*t;return n<10&&(n="0"+n),t+":"+n},niceString:function(e){let t=String(e);return e>=1e3&&(t=Number(parseFloat(Number(e)/1e3)).toFixed(1)+"K"),e>=1e6&&(t=Number(parseFloat(Number(e)/1e6)).toFixed(1)+"М"),e>=1e9&&(t=Number(parseFloat(Number(e)/1e9)).toFixed(1)+"В"),t},attachmentsString:function(e){let t="",n=e.getElementsByTagName("div");for(let e=0;e<n.length;e++)"null"!==String(n[e].getAttribute("attachment"))&&(t+=n[e].getAttribute("attachment")+",");return t},attachmentsArray:function(e){let t=[],n=e.getElementsByTagName("div");for(let e=0;e<n.length;e++)n[e].boundAttachment&&t.push(n[e].boundAttachment);return t},menu:{posts:{buildContextMenu:function(e){if(!settings.users.current)return null;let t=[];return e.owner_id===settings.users.current.user_id?(e.user_id===settings.users.current.user_id&&(e.is_pinned?t.push([settings.lang.getValue("unpin"),function(){let t=ui.userVisited||settings.users.current.user_id,n=document.getElementById("posts_list"),a=!0;null===n?n=document.getElementById("news_list"):a=!1,posts.actions.pin(e).then(function(e){posts.getAll(a?0:t,0,20).then(function(e){if(n.innerHTML="",e.length>0){for(let t=0;t<e.length;t++){let a=pages.elements.post(e[t]);n.appendChild(a)}return n.style.display=""}{let e=pages.elements.alertWindow(unt.Icon.CLEAR,settings.lang.getValue("no_posts"),settings.lang.getValue("no_posts_t"));return profileBody.appendChild(e)}})})}]):t.push([settings.lang.getValue("pin"),function(){let t=settings.users.current.user_id,n=document.getElementById("posts_list"),a=!0;null===n?n=document.getElementById("news_list"):a=!1,posts.actions.pin(e).then(function(e){posts.getAll(a?0:t,0,20).then(function(e){if(n.innerHTML="",e.length>0){for(let t=0;t<e.length;t++){let a=pages.elements.post(e[t]);n.appendChild(a)}return n.style.display=""}{let e=pages.elements.alertWindow(unt.Icon.CLEAR,settings.lang.getValue("no_posts"),settings.lang.getValue("no_posts_t"));return profileBody.appendChild(e)}})})}])),e.event||t.push([settings.lang.getValue("edit"),function(t,n,a){return pages.elements.postEditor(e).open()}]),t.push([settings.lang.getValue("delete"),function(t,n,a){let s=settings.lang.getValue("delete_post_confirm");return pages.elements.confirm("",s,function(t){t&&posts.actions.delete(e.user_id,e.id).then(function(t){if(!t){let e=settings.lang.getValue("upload_error");return unt.toast({html:e})}{let t=ui.userVisited||settings.users.current.user_id,n=document.getElementById("posts_list"),a=!0;null===n?n=document.getElementById("news_list"):a=!1,posts.actions.pin(e).then(function(e){posts.getAll(a?0:t,0,20).then(function(e){if(n.innerHTML="",e.length>0){for(let t=0;t<e.length;t++){let a=pages.elements.post(e[t]);n.appendChild(a)}return n.style.display=""}{let e=pages.elements.alertWindow(unt.Icon.CLEAR,settings.lang.getValue("no_posts"),settings.lang.getValue("no_posts_t"));return n.style.display="none",n.parentNode.appendChild(e)}})})}})})}])):(t.push([settings.lang.getValue("report"),new Function]),e.user_id===settings.users.current.user_id&&t.push([settings.lang.getValue("delete"),function(t,n,a){let s=settings.lang.getValue("delete_post_confirm");return pages.elements.confirm("",s,function(t){t&&posts.actions.delete(e.user_id,e.id).then(function(t){if(!t){let e=settings.lang.getValue("upload_error");return unt.toast({html:e})}{let t=ui.userVisited||settings.users.current.user_id,n=document.getElementById("posts_list"),a=!0;null===n?n=document.getElementById("news_list"):a=!1,posts.actions.pin(e).then(function(e){posts.getAll(a?0:t,0,20).then(function(e){if(n.innerHTML="",e.length>0){for(let t=0;t<e.length;t++){let a=pages.elements.post(e[t]);n.appendChild(a)}return n.style.display=""}{let e=pages.elements.alertWindow(unt.Icon.CLEAR,settings.lang.getValue("no_posts"),settings.lang.getValue("no_posts_t"));return n.style.display="none",n.parentNode.appendChild(e)}})})}})})}])),pages.elements.contextMenu(t)},openWindowPost:function(e){let t=document.createElement("div");t.classList.add("modal"),document.body.appendChild(t);let n=unt.Modal.init(t,{onCloseEnd:function(){return t.remove()}}),a=pages.elements.post(e,!0,!0,!0);return a.classList.remove("card"),t.appendChild(a),n.open()}}},time:function(e,t=!1,n=!1){if(!e)return"";let a=new Date(1e3*Number(e)),s=String(a.getFullYear()),l=a.getMonth()+1<10?"0"+String(a.getMonth()+1):String(a.getMonth()+1),i=a.getDate()<10?"0"+String(a.getDate()):String(a.getDate()),d=a.getHours()<10?"0"+String(a.getHours()):String(a.getHours()),r=a.getMinutes()<10?"0"+String(a.getMinutes()):String(a.getMinutes());return t?d+":"+r:n?i+"."+l+"."+s:i+"."+l+"."+s+", "+d+":"+r},forms:{MINUTE_RUSSIAN:["минуту","минуты","минут"],HOURS_RUSSIAN:["час","часа","часов"],DAYS_RUSSIAN:["день","дня","дней"],MONTH_RUSSIAN:["месяц","месяца","месяцев"],WEEK_RUSSIAN:["неделю","недели","недель"],YEAR_RUSSIAN:["год","года","лет"],MEMBERS_RUSSIAN:["участник","участника","участников"],PEOPLE_RUSSIAN:["человек","человека","человек"]},attachment:function(e,t){if("photo"===e.type){let n=document.createElement("div");n.boundAttachment=e;let a=document.createElement("img");return n.appendChild(a),a.src=e.photo.url.main,a.style.width=a.style.height="100%",n.style.width=n.style.height="64px",n.style.padding="5px",n.style.background="transparent",n.style.cursor="pointer",n.setAttribute("attachment","photo"+e.photo.owner_id+"_"+e.photo.id+"_"+e.photo.access_key),n.onclick=function(){if(n.remove(),t)return t(n)},n}if("poll"===e.type){let n=pages.elements.createPollElement(e.poll,t);return n.boundAttachment=e,n}},morph:function(e,t=this.forms.MINUTE_RUSSIAN){let n=(e=Math.abs(e)%100)%10;return e>10&&e<20?t[2]:n>1&&n<5?t[1]:1===n?t[0]:t[2]},getOnlineState:function(e){if(e.is_banned)return settings.lang.getValue("user_banned");if("user"===e.account_type){if(e.online.is_online)return settings.lang.getValue("online");if(e.online.hidden_online)return settings.lang.getValue("hidden_online");return""===pages.parsers.time(e.online.last_online_time)?settings.lang.getValue("offline"):settings.lang.getValue("was_online").replace("(а)",2===e.gender?"а":"")+" "+pages.parsers.time(e.online.last_online_time)}return settings.lang.getValue("bot")}}};function getCurrentTime(){return Math.floor(new Date/1e3)}var welcome={hehe:{no:{goodbye:function(){welcome.to.data.is.level=0,welcome.to.data.is.score=0,welcome.to.area&&(welcome.to.area.clear(),welcome.to.area.remove(),welcome.to.area=null),clearInterval(welcome.to.data.is.local),clearTimeout(welcome.to.data.is.timeout)}}},to:{area:null,fail:function(e,t){0!==welcome.to.data.is.level&&(pages.elements.alert("Level failed.\n\nLevel: "+welcome.to.data.is.level+"\nScore: "+welcome.to.data.is.score).then(function(){return welcome.to.level(e,t)}),welcome.to.data.is.level=0,welcome.to.data.is.score=0,clearInterval(welcome.to.data.is.local),clearTimeout(welcome.to.data.is.timeout))},level:function(e,t){this.area&&(this.area.clear(),this.area.remove());let n=60-1*welcome.to.data.is.level;n<=10&&(n=10);let a=document.createElement("div");a.clear=function(){let e=a.querySelectorAll(".game-round");for(let t=0;t<e.length;t++)e[t].delete();clearInterval(welcome.to.data.is.local),clearTimeout(welcome.to.data.is.timeout),a.innerHTML=""},a.classList.add("game-area"),a.style.width="100%",a.style.height="calc(100% - 75px)",welcome.to.data.is.level+=1,e.appendChild(a),t.innerHTML=welcome.to.data.now();let s=pages.elements.getLoader(!1);t.insertAdjacentElement("beforeend",s),s.setArea(20),s.style.marginLeft="10px";let l=document.createElement("div");l.style.marginLeft="5px",l.innerText=n,t.insertAdjacentElement("beforeend",l),this.area=a,this.area.clear();let i=1;welcome.to.data.is.level>=10&&(i=welcome.to.data.is.level-9),i>40&&(i=40);let d=getRandomInt(1,i);setTimeout(function(){for(let e=0;e<d;e++){let e=welcome.to.round();welcome.to.area.appendChild(e)}welcome.to.area.addEventListener("click",function(n){return n.target.classList.contains("game-round")?0!==welcome.to.data.is.level?(n.target.delete(),welcome.to.data.is.score+=1,levelstats.innerHTML=welcome.to.data.now(),0===welcome.to.how.much()?welcome.to.level(e,t):void 0):void 0:welcome.to.fail(e,t)})},200);let r=n;return welcome.to.data.is.local=setInterval(function(){n-=1,s.setProgress(n/r*100),l.innerText=n},1e3),welcome.to.data.is.timeout=setTimeout(function(){return welcome.to.fail(e,t)},1e3*n),a},how:{much:function(){let e=welcome.to.area;return e?e.querySelectorAll(".game-round").length:0}},round:function(){let e=document.createElement("div");e.classList.add("game-round");let t=["blue","white","pink","green","red","yellow"],n=t[getRandomInt(0,t.length-1)];e.style.backgroundColor=n,e.style.width=e.style.height=getRandomInt(40,120)+"px",e.style.borderRadius="120px",e.style.position="fixed",e.style.top=getRandomInt(80,this.area.clientHeight-100)+"px",e.style.left=getRandomInt(0,this.area.clientWidth-100)+"px";let a=2e3-30*welcome.to.data.is.level;return a<300&&(a=300),e.boundTimeout=setInterval(function(){e.style.top=getRandomInt(80,welcome.to.area.clientHeight-100)+"px",e.style.left=getRandomInt(0,welcome.to.area.clientWidth-100)+"px"},a),e.delete=function(){return clearInterval(e.boundTimeout),e.remove()},e},data:{is:{level:0,score:0,timeout:0},now:function(){return'<div id="levelstats">Level: <b>'+this.is.level+"</b>, Score: <b>"+this.is.score+"</b></div>"}},something:{game:function(){let e=document.createElement("div");e.classList.add("modal"),e.classList.add("bottom-sheet"),e.classList.add("unselectable"),e.addEventListener("dragstart",function(e){return e.preventDefault()}),e.addEventListener("dragend",function(e){return e.preventDefault()}),e.style="background-color: black !important",e.open=function(){document.body.appendChild(e);let t=unt.Modal.init(e,{onCloseEnd:function(){return e.remove()}});return t&&t.open(),e.style.top=0,e.style.width=e.style.height="100%",e.style.borderRadius=0,!0};let t=document.createElement("div");e.appendChild(t),t.classList.add("valign-wrapper"),t.style.width="100%";let n=document.createElement("div");t.appendChild(n),n.classList.add("valign-wrapper"),n.style.width="100%",n.style.color="white",t.style.padding="20px",n.innerHTML=welcome.to.data.now();let a=document.createElement("div");return a.style.cursor="pointer",a.style.marginTop="5px",t.appendChild(a),a.innerHTML=unt.Icon.CLOSE,a.getElementsByTagName("svg")[0].style.fill="white",a.addEventListener("click",function(){if(0!==welcome.to.data.is.level)return pages.elements.confirm("",settings.lang.getValue("logout")+"?",function(t){t&&(clearTimeout(welcome.to.data.is.timeout),welcome.hehe.no.goodbye(),unt.Modal.getInstance(e).close())})}),welcome.to.level(e,n),e.open()},out:function(){if(!settings.users.current)return welcome.to.something.game();let e=document.createElement("div");e.classList.add("modal"),e.classList.add("bottom-sheet"),e.classList.add("unselectable"),e.addEventListener("dragstart",function(e){return e.preventDefault()}),e.addEventListener("dragend",function(e){return e.preventDefault()}),e.style="background-color: black !important";let t=document.createElement("div");e.appendChild(t),t.classList.add("valign-wrapper"),t.style.width="100%";let n=document.createElement("div");t.appendChild(n),n.style.width="100%",n.style.color="white",t.style.padding="20px",n.innerText="What is it?";let a=document.createElement("div");a.style.cursor="pointer",a.style.marginTop="5px",t.appendChild(a),a.innerHTML=unt.Icon.CLOSE,a.getElementsByTagName("svg")[0].style.fill="white",a.addEventListener("click",function(){return pages.elements.confirm("",settings.lang.getValue("logout")+"?",function(t){if(t)return clearTimeout(welcome.to.data.is.timeout),welcome.hehe.no.goodbye(),unt.Modal.getInstance(e).close()})});let s=document.createElement("div");e.appendChild(s),s.style.width="100%";let l=document.createElement("div");l.style.position="absolute",l.style.top="50%",l.style.left="50%",l.style.marginRight="-50%",l.style.transform="translate(-50%, -50%)",s.appendChild(l);let i=document.createElement("div");i.style.textAlign="-webkit-center",l.appendChild(i);let d=document.createElement("img");d.classList.add("circle"),d.width=d.height=135,d.src=settings.users.current.photo_url,i.appendChild(d),l.appendChild(document.createElement("br"));let r=document.createElement("div");r.classList.add("center"),r.style.color="white",r.style.fontSize="x-large",l.appendChild(r);let o=document.createElement("b");r.appendChild(o),o.innerText=settings.users.current.first_name+" "+settings.users.current.last_name;let c=document.createElement("div");c.classList.add("center"),c.style.color="lightgrey",c.style.fontSize="large",c.innerText="@"+(settings.users.current.screen_name?settings.users.current.screen_name:"id"+settings.users.current.user_id),l.appendChild(c),e.open=function(){document.body.appendChild(e);let t=unt.Modal.init(e,{onCloseEnd:function(){return e.remove()}});return t&&t.open(),e.style.top=0,e.style.width=e.style.height="100%",e.style.borderRadius=0,!0};let u=document.createElement("div");e.appendChild(u),u.style.position="absolute",u.style.bottom=0,u.style.padding="20px",u.style.width="100%",u.classList.add("center");let p=pages.elements.createFAB(unt.Icon.PLAY,function(){e.innerHTML="";let t=document.createElement("div");t.style.position="absolute",t.style.top="50%",t.style.left="50%",t.style.marginRight="-50%",t.style.transform="translate(-50%, -50%)",e.appendChild(t);let n=pages.elements.getLoader().setColor("white");return t.appendChild(n),setTimeout(function(){return unt.Modal.getInstance(e).close(),welcome.to.something.game()},2e3)});return p.classList.remove("fixed-action-btn"),u.appendChild(p),e.open()}}}};