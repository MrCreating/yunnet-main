const dev={auth:{agree:function(e=0,t=[]){return new Promise(function(n,a){let s=new FormData;return s.append("action","resolve_auth"),s.append("app_id",Number(e)),s.append("permissions",t.join(",")),ui.Request({url:"/flex",data:s,method:"POST",success:function(e){return(e=JSON.parse(e)).error?a(new TypeError("Unable to fetch the token")):n(e)}})})}},go:function(e=window.location.href,t=!1,n=!1,a=!1,s=!0,i=null){if(settings.data.test.isBlocked)return unt.toast({html:"API is blocked. Unable to go."});try{ui.isMobile()?unt.Sidenav.getInstance(langs).close():unt.Dropdown.getInstance(langs).close()}catch(e){}if(document.getElementsByClassName("image-view")[0])return document.getElementsByClassName("image-view")[0].remove();a||(t?((e=ui.urls[ui.urls.length-1])||(e="/"),ui.urls.splice(ui.urls.length-1,1),ui.urls.length<=0&&(ui.canBack=!1)):n||(ui.urls.push(window.location.href),ui.canBack=!0));let l=document.getElementsByClassName("modal");for(let e=0;e<l.length;e++){let t=unt.Modal.getInstance(l[e]);t&&t.close()}return n||history.pushState(null,document.title,e),dev.parse(null,i)},parse:function(e=null,t=null){let n=document.getElementsByClassName("carousel");for(let e=0;e<n.length;e++)n[e].remove();let a=window.location.href.split(window.location.host)[1].split("?")[0];ui.isMobile()&&(nav_back_arrow_icon.style.display="none",nav_burger_icon.style.display="",nav_header_title.innerText="",ui.canBack&&(nav_back_arrow_icon.style.display="",nav_burger_icon.style.display="none"));let s=String(String(String(a).split(window.location.host)[1]).split("?")[0]);return"undefined"===s&&(s=a),dev.isUrlDefault(s)?("/"===s&&dev.pages.main(t),"/methods"===s&&dev.pages.methods(t),"/apps"===s&&dev.pages.apps(t),"/bots"===s&&dev.pages.bots(t)):dev.pages.notfound(),ui.bindItems(),unt.AutoInit()},isUrlDefault:function(e){return e=String(e.split("?")[0]).toLowerCase(),-1!==["/","/methods","/apps","/bots"].indexOf(e)},actions:{methods:{execute:function(e,t){return new Promise(function(n,a){let s=new FormData;for(let e in t)s.append(e,t[e]);let i=_xmlHttpGet();return i.onreadystatechange=function(){if(4!==i.readyState)return;let e=i.responseText;return n(JSON.parse(e))},i.open("POST","https://api.yunnet.ru/"+e+"?auth=local"),i.withCredentials=!0,i.send(s)})},getInfo:function(e){return dev.actions.methods.getInfo.list||(dev.actions.methods.getInfo.list={}),new Promise(function(t,n){if(dev.actions.methods.getInfo.list[e])return t(dev.actions.methods.getInfo.list[e]);let a=new FormData;return a.append("action","get_method_info"),a.append("method_name",String(e)),ui.Request({url:"/methods",data:a,method:"POST",success:function(a){try{return t(dev.actions.methods.getInfo.list[e]=JSON.parse(a))}catch(e){return n(e)}}})})},getList:function(){return new Promise(function(e,t){if(dev.actions.methods.getList.list)return e(dev.actions.methods.getList.list);let n=new FormData;return n.append("action","get_methods_list"),ui.Request({url:"/methods",data:n,method:"POST",success:function(n){try{return e(dev.actions.methods.getList.list=JSON.parse(n))}catch(e){return t(e)}}})})}}},tokens:{create:function(e=[],t=0,n=0){return new Promise(function(a,s){let i=new FormData;return i.append("action","create_token"),i.append("permissions",e.join(",")),0!==t&&i.append("bot_id",Number(t)),0!==n&&i.append("app_id",Number(n)),ui.Request({data:i,url:"/apps",method:"POST",success:function(e){return(e=JSON.parse(e)).error?s(new TypeError("Unable to fetch tokens")):a(e.response)}})})},updatePermissions:function(e,t=[]){return new Promise(function(n,a){let s=new FormData;return s.append("action","update_token"),s.append("token_id",Number(e)||0),s.append("permissions",t.join(",")),ui.Request({data:s,url:"/apps",method:"POST",success:function(e){return(e=JSON.parse(e)).error?a(new TypeError("Unable to fetch tokens")):n(e.success)}})})},delete:function(e){return new Promise(function(t,n){let a=new FormData;return a.append("action","delete_token"),a.append("token_id",Number(e)),ui.Request({data:a,url:"/apps",method:"POST",success:function(e){return(e=JSON.parse(e)).error?n(new TypeError("Unable to fetch tokens")):t(e)}})})}},bots:{getTokens:function(e){return new Promise(function(t,n){let a=new FormData;return a.append("action","get_tokens"),a.append("bot_id",Number(e)),ui.Request({data:a,url:"/bots",method:"POST",success:function(e){return(e=JSON.parse(e)).error?n(new TypeError("Unable to fetch tokens")):t(e)}})})},create:function(e=""){return new Promise(function(t,n){if(e.isEmpty())return n(new TypeError("Title is empty"));if(e.length>64)return n(new TypeError("Title is too long"));let a=new FormData;return a.append("action","create_bot"),a.append("bot_name",e),ui.Request({url:"/bots",method:"POST",data:a,success:function(e){return(e=JSON.parse(e)).error?n(new TypeError("Unable to create a new bot")):t(e)}})})},setScreenName:function(e,t=""){return new Promise(function(n,a){let s=new FormData;return s.append("bot_id",Number(e)),s.append("action","change_screen_name"),s.append("new_screen_name",String(t)),ui.Request({data:s,method:"POST",url:"/bots",success:function(e){if((e=JSON.parse(e)).error){let t=new TypeError("Unable to change screen name.");return e.error_message&&(t.errorMessage=e.error_message),a(t)}n(e.state)}})})},setPrivacy:function(e,t,n){return!!["can_write_messages","can_write_on_wall","can_invite_to_chats"][Number(t)-1]&&(!isNaN(Number(n))&&(!(Number(n)<0||Number(n)>2)&&new Promise(function(a,s){let i=new FormData;return i.append("action","set_privacy_settings"),i.append("bot_id",Number(e)),i.append("group_id",Number(t)),i.append("new_value",Number(n)),ui.Request({url:"/bots",data:i,method:"POST",success:function(e){return(e=JSON.parse(e)).unauth?settings.reLogin():e.error?s(new TypeError("Settings changing failed")):a(!0)}})})))},setTitle:function(e,t){return new Promise(function(n,a){let s=new FormData;return s.append("action","set_title"),s.append("bot_id",Number(e)),s.append("new_title",String(t)),ui.Request({data:s,url:"/bots",method:"POST",success:function(e){return(e=JSON.parse(e)).error?a(new TypeError("Unable to change photo!")):n(e.state)}})})},setPhoto:function(e,t=null){return new Promise(function(n,a){let s=new FormData;return s.append("bot_id",Number(e)),t?(s.append("action","set_photo"),s.append("photo",String(t))):s.append("action","delete_photo"),ui.Request({url:"/bots",data:s,method:"POST",success:function(e){return(e=JSON.parse(e)).error?a(new TypeError("Unable to change photo!")):n(e.state)}})})},get:function(){return new Promise(function(e,t){let n=new FormData;return n.append("action","get_bots_list"),ui.Request({url:"/flex",data:n,method:"POST",success:function(n){return(n=JSON.parse(n)).error?t(new TypeError("Unable to fetch bots list.")):n.unauth?settings.reLogin():e(n)}})})}},apps:{getTokens:function(e){return new Promise(function(t,n){let a=new FormData;return a.append("action","get_tokens"),a.append("app_id",Number(e)),ui.Request({data:a,url:"/apps",method:"POST",success:function(e){return(e=JSON.parse(e)).error?n(new TypeError("Unable to fetch tokens")):t(e)}})})},create:function(e=""){return new Promise(function(t,n){if(e.isEmpty())return n(new TypeError("Title is empty"));if(e.length>64)return n(new TypeError("Title is too long"));let a=new FormData;return a.append("action","create_app"),a.append("app_title",e),ui.Request({url:"/apps",method:"POST",data:a,success:function(e){return(e=JSON.parse(e)).error?n(new TypeError("Unable to create a new app")):t(e)}})})},delete:function(e){return new Promise(function(t,n){let a=new FormData;return a.append("action","delete_app"),a.append("app_id",Number(e)||0),ui.Request({data:a,method:"POST",url:"/apps",success:function(e){return(e=JSON.parse(e)).error?n(new TypeError("Unable to change photo!")):t(e.success)}})})},setTitle:function(e,t){return new Promise(function(n,a){let s=new FormData;return s.append("action","set_title"),s.append("app_id",Number(e)),s.append("new_title",String(t)),ui.Request({data:s,url:"/apps",method:"POST",success:function(e){return(e=JSON.parse(e)).error?a(new TypeError("Unable to change photo!")):n(e.success)}})})},setPhoto:function(e,t=null){return new Promise(function(n,a){let s=new FormData;return s.append("app_id",Number(e)),t?(s.append("action","set_photo"),s.append("photo",String(t))):s.append("action","delete_photo"),ui.Request({url:"/apps",data:s,method:"POST",success:function(e){return(e=JSON.parse(e)).error?a(new TypeError("Unable to change photo!")):n(e.success)}})})},getById:function(e){return new Promise(function(t,n){let a=new FormData;return a.append("action","get_app_by_id"),a.append("app_id",Number(e)||0),ui.Request({url:"/flex",data:a,method:"POST",success:function(e){return(e=JSON.parse(e)).error?n(new TypeError("Unable to fetch app info.")):t(e)}})})},get:function(e=1,t=30){return new Promise(function(n,a){let s=new FormData;return s.append("action","get_apps_list"),s.append("offset",30*Number(e)-30||0),s.append("count",Number(t)||30),ui.Request({url:"/flex",data:s,method:"POST",success:function(e){return(e=JSON.parse(e)).error?a(new TypeError("Unable to fetch apps list.")):e.unauth?settings.reLogin():n(e)}})})}},pages:{notfound:function(){let e=pages.elements.menuBody().clear(),t=document.createElement("div");t.classList=["card full_section"],e.appendChild(t);let n=document.createElement("div");t.appendChild(n),n.innerText=settings.lang.getValue("user_not_found"),n.classList.add("center"),document.title="yunNet."},sub:{tokenMenu:function(e,t,n,a,s={}){if(1===e){let e=document.createElement("div");e.classList.add("card"),e.classList.add("full_section");let t=pages.elements.createInputField(settings.lang.getValue("token"),!0).setType("text");e.appendChild(t),t.getInput().setAttribute("readonly","true"),a.appendChild(e),t.getInput().value=s.token}let i=s.permissions||[],l=document.createElement("div");a.appendChild(l),l.classList.add("card"),l.classList.add("full_section");let o=document.createElement("div");l.appendChild(o),o.innerText=settings.lang.getValue("set_new_permissions")+":";let r=document.createElement("div");l.appendChild(r),r.classList.add("collection");let d=document.createElement("a");d.classList.add("collection-item"),d.innerText=settings.lang.getValue("friends");let u=document.createElement("a");u.classList.add("collection-item"),u.innerText=settings.lang.getValue("messages");let c=document.createElement("a");c.classList.add("collection-item"),c.innerText=settings.lang.getValue("settings");let p=document.createElement("a");p.classList.add("collection-item"),p.innerText=settings.lang.getValue("management"),r.appendChild(d),r.appendChild(u),r.appendChild(c),r.appendChild(p),-1!==i.indexOf(1)&&d.classList.add("active"),-1!==i.indexOf(2)&&u.classList.add("active"),-1!==i.indexOf(3)&&c.classList.add("active"),-1!==i.indexOf(4)&&p.classList.add("active"),d.onclick=function(){d.classList.toggle("active");let e=i.indexOf(1);-1!==e?i.splice(e,1):i.push(1)},u.onclick=function(){u.classList.toggle("active");let e=i.indexOf(2);-1!==e?i.splice(e,1):i.push(2)},c.onclick=function(){c.classList.toggle("active");let e=i.indexOf(3);-1!==e?i.splice(e,1):i.push(3)},p.onclick=function(){p.classList.toggle("active");let e=i.indexOf(4);-1!==e?i.splice(e,1):i.push(4)},a.appendChild(pages.elements.createButton("",settings.lang.getValue("continue"),function(){return 0===e?(ui.go(window.location.href),dev.tokens.create(i,"bots"===t?n:0,"apps"===t?n:0).then(function(e){e.token;let t=pages.elements.createWindow(),n=t.getFooter(),a=t.getContent();n.remove();let s=pages.elements.createInputField(settings.lang.getValue("token"),!0).setType("text");s.getInput().setAttribute("readonly","true"),s.getInput().value=e.token;let i=document.createElement("div");i.innerText=settings.lang.getValue("key_created"),a.appendChild(i),a.appendChild(s)}).catch(function(e){return unt.toast({html:settings.lang.getValue("upload_error")})})):1===e?dev.tokens.updatePermissions(s.id,i).then(function(e){return unt.toast({html:settings.lang.getValue("saved")})}).catch(function(e){return unt.toast({html:settings.lang.getValue("upload_error")})}):void 0})),1===e&&a.appendChild(pages.elements.createButton("",settings.lang.getValue("delete_key"),function(){return pages.elements.confirm("",settings.lang.getValue("delete_key")+"?",function(e){if(e)return dev.tokens.delete(s.id).then(function(){return ui.go(window.location.href,!1,!1,!1,!1)}).catch(function(e){return unt.toast({html:settings.lang.getValue("upload_error")})})})},"red"))},tokensEditor:function(e,t){let n=pages.elements.menuBody().clear(),a="tokens";"create"===t.tokenAction&&(a="create_token"),"edit"===t.tokenAction&&(a="edit"),ui.isMobile()?nav_header_title.innerText=settings.lang.getValue(a):ui.canBack&&n.appendChild(pages.elements.backArrowButton(settings.lang.getValue(a)),function(e){return ui.go(null,!0)});let s=t[e.substr(0,3)];if("create"===t.tokenAction)return dev.pages.sub.tokenMenu(0,e,"apps"===e?t.app.id:t.bot.bot_id,n);if("edit"===t.tokenAction)return dev.pages.sub.tokenMenu(1,e,0,n,t.token);{n.appendChild(pages.elements.createButton(unt.Icon.ADD,settings.lang.getValue("create_token"),function(){return t.tokenAction="create",ui.go(window.location.href,!1,!1,!1,!0,t)}));let a=pages.elements.getLoader();a.style.marginTop="15px",n.appendChild(a);let i=document.createElement("div");return n.appendChild(i),i.classList.add("card"),i.classList.add("collection"),i.style.display="none",dev[e].getTokens(s.bot_id||s.id).then(function(s){return s.length>0?(s.forEach(function(n){let a=pages.elements.tokenItem(n,function(a){return t.tokenAction="edit",t.token=n,ui.go("https://"+window.location.host+"/"+e+"?action=edit&section=tokens",!1,!1,!1,!0,t)});i.appendChild(a)}),i.style.display="",a.hide()):(a.hide(),n.appendChild(pages.elements.alertWindow(unt.Icon.DEV,settings.lang.getValue("no_keys_bot"),settings.lang.getValue("no_keys_text"))))}).catch(function(e){return a.hide(),n.appendChild(pages.elements.uploadError())})}}},main:function(){if(settings.users.current&&settings.users.current.is_banned)return pages.unauth.banned();ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("main")),pages.elements.menuBody().clear().appendChild(pages.elements.alertWindow(unt.Icon.DEV,settings.lang.getValue("welcome_dev"),settings.lang.getValue("welcome_dev_text")))},methods:function(){if(settings.users.current&&settings.users.current.is_banned)return pages.unauth.banned();ui.isMobile()&&(nav_header_title.innerText="API");let e=pages.elements.menuBody().clear(),t=new URLParser(window.location.href).parse().section||"",n=["getstarted","methods","method","widgets","keyboard"];if(-1===n.indexOf(t))e.appendChild(pages.elements.createButton(unt.Icon.DEV,settings.lang.getValue("get_started"),function(){return ui.go("https://"+window.location.host+"/methods?section=getstarted")})),e.appendChild(pages.elements.createButton(unt.Icon.ATTACHMENT,settings.lang.getValue("methods_list"),function(){return ui.go("https://"+window.location.host+"/methods?section=methods")})),e.appendChild(pages.elements.createButton(unt.Icon.GROUP,settings.lang.getValue("widgets_and_auth"),function(){return ui.go("https://"+window.location.host+"/methods?section=widgets")}));else{if(t===n[0])return dev.methods.getstarted();if(t===n[1])return dev.methods.methodslist();if(t===n[2])return dev.methods.methodinfo();if(t===n[3])return dev.methods.widgets();if(t===n[4])return dev.methods.keyboard()}},apps:function(e){if(settings.users.current&&settings.users.current.is_banned)return pages.unauth.banned();ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("apps"));let t=pages.elements.menuBody().clear();if(!settings.users.current)return window.location.href="https://yunnet.ru/";let n=new URLParser(window.location.href).parse();if("edit"===n.action){if(e&&e.app&&e.app.owner_id===settings.users.current.user_id){if("tokens"===n.section)return dev.pages.sub.tokensEditor("apps",e);ui.isMobile()?nav_header_title.innerText=settings.lang.getValue("edit_app"):ui.canBack&&t.appendChild(pages.elements.backArrowButton(settings.lang.getValue("edit_app")),function(e){return ui.go(null,!0)});let a=pages.chats.elements.window();t.appendChild(a);let s=a.getElementsByTagName("input")[0],i=a.getElementsByTagName("img")[0];return s.placeholder=settings.lang.getValue("application_title"),s.value=e.app.title,i.src=e.app.photo_url,s.oninput=function(t){return s.value.isEmpty()||s.value===e.app.title?a.getCreateButton().classList.add("scale-out"):a.getCreateButton().classList.remove("scale-out")},i.onclick=function(t){return pages.elements.fileUploader({onFileSelected:function(t,n,a){return a.setLoading(!0),uploads.getURL().then(function(t){return uploads.upload(t,n[0],function(e){return codes.callbacks.uploadResolve(e,a)}).then(function(t){a.setLoading(!1);let n="photo"+t.photo.owner_id+"_"+t.photo.id+"_"+t.photo.access_key;return i.src=t.photo.url.main,dev.apps.setPhoto(e.app.id,n).then(function(){return a.close()})}).catch(function(e){return a.setLoading(!1),unt.toast({html:settings.lang.getValue("upload_error")})})})},afterClose:function(){}}).open().addFooterItem(settings.lang.getValue("delete_a_photo"),function(t,n,a){return i.src="https://dev.yunnet.ru/images/default.png",dev.apps.setPhoto(e.app.id).then(function(){return a.close()})})},a.getCreateButton().onclick=function(){return s.classList.remove("wrong"),s.value.length>32?s.classList.add("wrong"):(s.disabled=!0,a.getCreateButton().classList.add("scale-out"),dev.apps.setTitle(e.app.id,s.value).then(function(){s.disabled=!1,e.app.title=s.value}).catch(function(e){return a.getCreateButton().classList.remove("scale-out"),s.disabled=!1,unt.toast({html:settings.lang.getValue("upload_error")})}))},t.appendChild(pages.elements.createButton("",settings.lang.getValue("tokens"),function(t){return ui.go("https://"+window.location.host+"/apps?action=edit&section=tokens",!1,!1,!1,!0,e)})),void t.appendChild(pages.elements.createButton("",settings.lang.getValue("delete_application"),function(t){return pages.elements.confirm("",settings.lang.getValue("delete_application")+"?",function(t){if(t)return dev.apps.delete(e.app.id).then(function(e){return ui.go("https://"+window.location.host+"/apps")}).catch(function(e){return unt.toast({html:settings.lang.getValue("upload_error")})})})},"red"))}return ui.go("https://"+window.location.host+"/apps",!1,!1,!1,!1,null)}{let e=pages.elements.getLoader();e.style.marginTop="15px",t.appendChild(e);let n=document.createElement("div");return t.appendChild(n),n.style.display="none",n.classList=["card collection"],t.appendChild(pages.elements.createFAB(unt.Icon.ADD,function(){let e=pages.elements.createWindow(),t=document.createElement("a");t.innerText=settings.lang.getValue("continue"),t.classList=["btn-flat waves-effect"];let n=document.createElement("div");n.innerText=settings.lang.getValue("create_app"),e.getContent().appendChild(n),e.getContent().appendChild(document.createElement("br"));let a=pages.elements.createInputField(settings.lang.getValue("application_title"),!1).maxLength(64).setType("text");e.getContent().appendChild(a),t.onclick=function(e){return a.getInput().classList.remove("wrong"),a.getValue().isEmpty()||a.getValue().length>64?a.getInput().classList.add("wrong"):(t.classList.add("disabled"),a.getInput().disabled=!0,dev.apps.create(a.getValue()).then(function(e){return ui.go("https://"+window.location.host+"/apps")}).catch(function(e){return t.classList.remove("disabled"),a.getInput().disabled=!1,unt.toast({html:settings.lang.getValue("upload_error")})}))},e.getFooter().appendChild(t)})),dev.apps.get().then(function(a){if(a.length<=0)return e.hide(),t.appendChild(pages.elements.alertWindow(unt.Icon.CLEAR,settings.lang.getValue("no_apps"),settings.lang.getValue("no_apps_text")));a.forEach(function(e){let t=pages.elements.appItem(e);t.onclick=function(t){return t.preventDefault(),ui.go("/apps?action=edit",!1,!1,!1,!0,{app:e})};let a=document.createElement("div");t.appendChild(a),a.classList.add("secondary-content"),a.innerHTML=unt.Icon.EDIT,n.appendChild(t)}),e.hide(),n.style.display=""}).catch(function(n){let a=pages.elements.uploadError();return e.hide(),t.appendChild(a)})}},bots:function(e){if(settings.users.current&&settings.users.current.is_banned)return pages.unauth.banned();ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("bots"));let t=pages.elements.menuBody().clear();if(!settings.users.current)return window.location.href="https://yunnet.ru/";let n=new URLParser(window.location.href).parse();if("edit"===n.action){if(e&&e.bot&&e.bot.owner_id===settings.users.current.user_id){if("tokens"===n.section)return dev.pages.sub.tokensEditor("bots",e);ui.isMobile()?nav_header_title.innerText=settings.lang.getValue("edit_bot"):ui.canBack&&t.appendChild(pages.elements.backArrowButton(settings.lang.getValue("edit_bot")),function(e){return ui.go(null,!0)});let a=pages.chats.elements.window();t.appendChild(a);let s=a.getElementsByTagName("input")[0],i=a.getElementsByTagName("img")[0];s.placeholder=settings.lang.getValue("bot_name"),s.value=e.bot.name,i.src=e.bot.photo_url,s.oninput=function(t){return s.value.isEmpty()||s.value===e.bot.name?a.getCreateButton().classList.add("scale-out"):a.getCreateButton().classList.remove("scale-out")},i.onclick=function(t){return pages.elements.fileUploader({onFileSelected:function(t,n,a){return a.setLoading(!0),uploads.getURL().then(function(t){return uploads.upload(t,n[0],function(e){return codes.callbacks.uploadResolve(e,a)}).then(function(t){a.setLoading(!1);let n="photo"+t.owner_id+"_"+t.id+"_"+t.access_key;return i.src=t.url.main,dev.bots.setPhoto(e.bot.bot_id,n).then(function(){return a.close()})}).catch(function(e){return a.setLoading(!1),unt.toast({html:settings.lang.getValue("upload_error")})})})},afterClose:function(){}}).open().addFooterItem(settings.lang.getValue("delete_a_photo"),function(t,n,a){return i.src="https://dev.yunnet.ru/images/default.png",dev.bots.setPhoto(e.bot.bot_id).then(function(){return a.close()})})},a.getCreateButton().onclick=function(){return s.classList.remove("wrong"),s.value.length>32?s.classList.add("wrong"):(s.disabled=!0,a.getCreateButton().classList.add("scale-out"),dev.bots.setTitle(e.bot.bot_id,s.value).then(function(){s.disabled=!1,e.bot.name=s.value}).catch(function(e){return a.getCreateButton().classList.remove("scale-out"),s.disabled=!1,unt.toast({html:settings.lang.getValue("upload_error")})}))};let l=document.createElement("div");l.classList=["card full_section"],t.appendChild(l);let o=pages.elements.createInputField(settings.lang.getValue("bot_link"),!0).maxLength(32).setType("text");l.appendChild(o),o.getInput().value=e.bot.screen_name||"bot"+e.bot.bot_id;let r=pages.elements.createFAB(unt.Icon.SAVE,function(t){return r.getElementsByTagName("a")[0].classList.add("disabled"),o.getInput().disabled=!0,dev.bots.setScreenName(e.bot.bot_id,o.getInput().value).then(function(t){r.getElementsByTagName("a")[0].classList.remove("disabled"),o.getInput().disabled=!1,r.classList.add("scale-out"),1===t&&(e.bot.screen_name=o.getInput().value),0===t&&(delete e.bot.screen_name,o.getInput().value="bot"+e.bot.bot_id)}).catch(function(e){return r.getElementsByTagName("a")[0].classList.remove("disabled"),o.getInput().disabled=!1,unt.toast({html:e.errorMessage?e.errorMessage:settings.lang.getValue("upload_error")})})});o.getInput().oninput=function(){o.getInput().value===e.bot.screen_name?r.classList.add("scale-out"):r.classList.remove("scale-out")},r.classList.remove("fixed-action-btn"),r.classList.add("scale-transition"),r.classList.add("scale-out");let d=document.createElement("div");d.appendChild(r),l.appendChild(d),d.style.width="100%",d.style.textAlign="end",t.appendChild(pages.elements.createButton("",settings.lang.getValue("tokens"),function(t){return ui.go("https://"+window.location.host+"/bots?action=edit&section=tokens",!1,!1,!1,!0,e)}));let u=pages.elements.createCollapsible([[unt.Icon.MESSAGES,settings.lang.getValue("who_can_write_to_bot")],[unt.Icon.WALL,settings.lang.getValue("who_can_write_on_bot_wall")],[unt.Icon.CHATS,settings.lang.getValue("who_can_invite_to_chat_bot")]]);return t.appendChild(u),u.getBody(0).appendChild(pages.elements.createSelector("can_write_messages",[[settings.lang.getValue("all"),function(){dev.bots.setPrivacy(e.bot.bot_id,1,0)}],[settings.lang.getValue("only_subscribers"),function(){dev.bots.setPrivacy(e.bot.bot_id,1,1)}],[settings.lang.getValue("nobody"),function(){dev.bots.setPrivacy(e.bot.bot_id,1,2)}]]).selectItem(e.bot.privacy.can_write_messages)),u.getBody(1).appendChild(pages.elements.createSelector("can_write_on_wall",[[settings.lang.getValue("all"),function(){dev.bots.setPrivacy(e.bot.bot_id,2,0)}],[settings.lang.getValue("only_subscribers"),function(){dev.bots.setPrivacy(e.bot.bot_id,2,1)}],[settings.lang.getValue("nobody"),function(){dev.bots.setPrivacy(e.bot.bot_id,2,2)}]]).selectItem(e.bot.privacy.can_write_on_wall)),void u.getBody(2).appendChild(pages.elements.createSelector("can_comment_posts",[[settings.lang.getValue("all"),function(){dev.bots.setPrivacy(e.bot.bot_id,3,0)}],[settings.lang.getValue("only_subscribers"),function(){dev.bots.setPrivacy(e.bot.bot_id,3,1)}],[settings.lang.getValue("nobody"),function(){dev.bots.setPrivacy(e.bot.bot_id,3,2)}]]).selectItem(e.bot.privacy.can_invite_to_chats))}return ui.go("https://"+window.location.host+"/bots",!1,!1,!1,!1,null)}{let e=pages.elements.getLoader();e.style.marginTop="15px",t.appendChild(e);let n=document.createElement("div");return t.appendChild(n),n.style.display="none",n.classList=["card collection"],dev.bots.get().then(function(a){if(a.length<30&&t.appendChild(pages.elements.createFAB(unt.Icon.ADD,function(){let e=pages.elements.createWindow(),t=document.createElement("a");t.innerText=settings.lang.getValue("continue"),t.classList=["btn-flat waves-effect"];let n=document.createElement("div");n.innerText=settings.lang.getValue("create_bot"),e.getContent().appendChild(n),e.getContent().appendChild(document.createElement("br"));let a=pages.elements.createInputField(settings.lang.getValue("bot_name"),!1).maxLength(64).setType("text");e.getContent().appendChild(a),t.onclick=function(e){return a.getInput().classList.remove("wrong"),a.getValue().isEmpty()||a.getValue().length>64?a.getInput().classList.add("wrong"):(t.classList.add("disabled"),a.getInput().disabled=!0,dev.bots.create(a.getValue()).then(function(e){return ui.go("https://"+window.location.host+"/bots")}).catch(function(e){return t.classList.remove("disabled"),a.getInput().disabled=!1,unt.toast({html:settings.lang.getValue("upload_error")})}))},e.getFooter().appendChild(t)})),a.length<=0)return e.hide(),t.appendChild(pages.elements.alertWindow(unt.Icon.CLEAR,settings.lang.getValue("no_bots"),settings.lang.getValue("no_bots_text")));a.forEach(function(e){let t=pages.elements.userItem(e);t.onclick=function(t){return t.preventDefault(),ui.go("/bots?action=edit",!1,!1,!1,!0,{bot:e})};let a=document.createElement("div");t.appendChild(a),a.classList.add("secondary-content"),a.innerHTML=unt.Icon.EDIT,n.appendChild(t)}),e.hide(),n.style.display=""}).catch(function(n){let a=pages.elements.uploadError();return e.hide(),t.appendChild(a)})}}},settings:{lang:{values:{},getValue:function(e="*",t=!0){return dev.settings.lang.values[e]&&!t?dev.settings.lang.values[e]:dev.settings.lang.values[e]||t?new Promise(function(t,n){let a=new FormData;return a.append("action","get_dev_lang_value"),a.append("value",e),ui.Request({url:"/flex",data:a,method:"POST",success:function(a){return(a=JSON.parse(a)).error?n(new TypeError("Unable to find language value")):("*"===e?dev.settings.lang.values=a[0]:dev.settings.lang.values[e]=a.value,t(a.value||a))}})}):""}}},methods:{editors:{keyboard:function(){let e=document.createElement("div");e.classList.add("modal"),e.classList.add("bottom-sheet"),e.classList.add("unselectable"),e.addEventListener("dragstart",function(e){return e.preventDefault()}),e.addEventListener("dragend",function(e){return e.preventDefault()});let t=document.createElement("div");e.appendChild(t),t.classList.add("valign-wrapper"),t.style.width="100%";let n=document.createElement("div");t.appendChild(n),n.style.width="100%",t.style.padding="20px",n.innerText=settings.lang.getValue("keyboard_editor");let a=document.createElement("div");return a.style.cursor="pointer",a.style.marginTop="5px",t.appendChild(a),a.innerHTML=unt.Icon.CLOSE,a.addEventListener("click",function(){return unt.Modal.getInstance(e).close()}),e.open=function(){document.body.appendChild(e);let t=unt.Modal.init(e,{onCloseEnd:function(){return e.remove()}});return t&&t.open(),e.style.top=0,e.style.width=e.style.height="100%",e.style.borderRadius=0,!0},e.open()}},widgets:function(){let e=pages.elements.menuBody().clear(),t=settings.get();t&&t.theming.backButton&&ui.canBack&&!ui.isMobile()&&e.appendChild(pages.elements.backArrowButton(settings.lang.getValue("widgets_and_auth")),function(e){return ui.go(null,!0)}),ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("widgets_and_auth")),e.appendChild(pages.elements.createButton(unt.Icon.KEYBOARD,dev.settings.lang.getValue("bots_keyboard",!1),function(){return ui.go("https://"+window.location.host+"/methods?section=keyboard")}))},keyboard:function(){let e=pages.elements.menuBody().clear(),t=settings.get();t&&t.theming.backButton&&ui.canBack&&!ui.isMobile()&&e.appendChild(pages.elements.backArrowButton(dev.settings.lang.getValue("bots_keyboard",!1)),function(e){return ui.go(null,!0)}),ui.isMobile()&&(nav_header_title.innerText=dev.settings.lang.getValue("bots_keyboard",!1));let n=document.createElement("div");n.classList.add("card"),n.classList.add("full_section"),e.appendChild(n);let a=document.createElement("div");a.classList.add("center");let s=document.createElement("b");a.appendChild(s),s.innerText=dev.settings.lang.getValue("bots_keyboard",!1),n.appendChild(a),n.appendChild(document.createElement("br"));let i=document.createElement("div");i.innerHTML=dev.settings.lang.getValue("bots_keyboard_1",!1),n.appendChild(i);let l=document.createElement("pre");n.appendChild(l);let o=document.createElement("code");l.appendChild(o),o.style.backgroundColor="aliceblue",o.innerHTML="[\n  [\n    {...}, {...}, {...}\n  ],\n  [\n    {...}, {...}\n  ]\n]";let r=document.createElement("div");n.appendChild(r),r.innerHTML=dev.settings.lang.getValue("bots_keyboard_2",!1);let d=document.createElement("pre");n.appendChild(d);let u=document.createElement("code");d.appendChild(u),u.style.backgroundColor="aliceblue",u.innerHTML="{\n  params: {\n    autoShow: false || true,\n    oneTime: false || true\n  },\n  keyboard: [\n    [\n      {\n        id: 1,\n        color: [42, 42, 42],\n        textColor: [0, 0, 0],\n        text: 'Hello! :)'\n      }\n    ],\n    [\n      {\n        id: 1,\n        color: [255, 255, 255],\n        textColor: [0, 0, 0],\n        text: 'Goodbye! :)'\n      }\n    ]\n  ]\n}",e.appendChild(pages.elements.createButton(unt.Icon.ADD,settings.lang.getValue("create_keyboard"),function(){return dev.methods.editors.keyboard()}))},methodinfo:function(){let e=pages.elements.menuBody().clear(),t=settings.get();t&&t.theming.backButton&&ui.canBack&&!ui.isMobile()&&e.appendChild(pages.elements.backArrowButton(settings.lang.getValue("methods_list")),function(e){return ui.go(null,!0)}),ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("methods_list"));let n=pages.elements.getLoader();return n.style.marginTop="15px",e.appendChild(n),dev.actions.methods.getInfo(new URLParser(window.location.href).parse().method).then(function(t){n.hide();let a=document.createElement("div");a.classList.add("card"),a.classList.add("full_section"),a.classList.add("center"),e.appendChild(a);let s=document.createElement("b");s.innerText=t.header,a.appendChild(s),a.appendChild(document.createElement("br")),a.appendChild(document.createElement("br"));let i=document.createElement("div");if(i.innerHTML=t.description,a.appendChild(i),t.params&&t.params.length>0){let n=document.createElement("div");n.classList.add("card"),n.classList.add("full_section"),n.classList.add("center");let a=document.createElement("b");a.innerText=dev.settings.lang.getValue("params",!1),n.appendChild(a),e.appendChild(n);let s=document.createElement("table");s.classList.add("striped");let i=document.createElement("thead");s.appendChild(i);let l=document.createElement("tr");i.appendChild(l);let o=document.createElement("th"),r=document.createElement("th");i.appendChild(o),i.appendChild(r),o.innerText=dev.settings.lang.getValue("param_name",!1),r.innerText=dev.settings.lang.getValue("param_desc",!1),n.appendChild(s);let d=document.createElement("tbody");s.appendChild(d),t.params.forEach(function(e){let t=document.createElement("tr"),n=document.createElement("td");n.innerText=e,t.appendChild(n);let a=document.createElement("td");a.innerHTML=dev.settings.lang.getValue(e+"_param",!1),t.appendChild(a),d.appendChild(t)})}else{let t=document.createElement("div");t.classList.add("card"),t.classList.add("full_section"),t.classList.add("center"),t.innerText=dev.settings.lang.getValue("no_params",!1),e.appendChild(t)}if(settings.users.current){let n=document.createElement("div");n.classList.add("card"),n.classList.add("full_section"),n.classList.add("center");let a=document.createElement("b");a.innerText=dev.settings.lang.getValue("request",!1),n.appendChild(a),e.appendChild(n);let s=document.createElement("table");s.classList.add("striped");let i=document.createElement("thead");s.appendChild(i);let l=document.createElement("tr");i.appendChild(l);let o=document.createElement("th"),r=document.createElement("th");i.appendChild(o),i.appendChild(r),o.innerText=dev.settings.lang.getValue("params",!1),r.innerText=dev.settings.lang.getValue("result",!1),n.appendChild(s);let d=document.createElement("tbody");s.appendChild(d);let u=document.createElement("tr"),c=document.createElement("td");u.appendChild(c);let p=document.createElement("td");u.appendChild(p),d.appendChild(u);let g=document.createElement("div");c.appendChild(g),c.style.width="40%",t.params.forEach(function(e){let t=pages.elements.createInputField(e,!1);t.classList.add(e+"_param"),g.appendChild(t)});let m=document.createElement("div");p.appendChild(m);let h=document.createElement("pre");m.appendChild(h);let f=document.createElement("code");h.appendChild(f),f.style.wordBreak="break-word",f.style.whiteSpace="pre-wrap",f.style.width="100%";let b=pages.elements.createFAB(unt.Icon.SAVE,function(){_.style.display="",b.style.display="none";let e={};return t.params.forEach(function(t){let n=g.getElementsByClassName(t+"_param")[0].getValue();e[t]=n}),dev.actions.methods.execute(t.header,e).then(function(e){return _.style.display="none",b.style.display="",f.innerText=JSON.stringify(e,null,4)}).catch(function(e){return _.style.display="none",b.style.display="",unt.toast({html:settings.lang.getValue("upload_error")})})}),_=pages.elements.getLoader();_.style.display="none",b.classList.remove("fixed-action-btn"),b.classList.add("center"),g.appendChild(b),g.appendChild(_)}}).catch(function(t){return n.hide(),e.appendChild(pages.elements.uploadError())})},methodslist:function(){let e=pages.elements.menuBody().clear(),t=settings.get();t&&t.theming.backButton&&ui.canBack&&!ui.isMobile()&&e.appendChild(pages.elements.backArrowButton(settings.lang.getValue("methods_list")),function(e){return ui.go(null,!0)}),ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("methods_list"));let n=pages.elements.getLoader();return n.style.marginTop="15px",e.appendChild(n),dev.actions.methods.getList().then(function(t){n.hide();let a=[];for(let e in t)a.push([unt.Icon[e.toUpperCase()],e]);let s=pages.elements.createCollapsible(a);for(let e=0;e<a.length;e++){let n=s.getBody(e),i=document.createElement("div");i.classList.add("collection");let l=a[e][1];for(let e=0;e<t[l].length;e++){let n=document.createElement("a");n.classList.add("collection-item"),n.href="/methods?section=method&method="+l+"."+t[l][e],n.innerText=l+"."+t[l][e]+" - "+dev.settings.lang.getValue(l+"."+t[l][e],!1),i.appendChild(n)}n.appendChild(i)}return e.appendChild(s),ui.bindItems(),unt.AutoInit()}).catch(function(t){return n.hide(),e.appendChild(pages.elements.uploadError())})},getstarted:function(){let e=pages.elements.menuBody().clear(),t=settings.get();t&&t.theming.backButton&&ui.canBack&&!ui.isMobile()&&e.appendChild(pages.elements.backArrowButton(settings.lang.getValue("get_started")),function(e){return ui.go(null,!0)}),ui.isMobile()&&(nav_header_title.innerText=settings.lang.getValue("get_started"));let n=document.createElement("div");n.classList.add("card"),n.classList.add("full_section");let a=document.createElement("div");n.appendChild(a),a.style.width="100%",a.classList.add("center");let s=document.createElement("b");a.appendChild(s),s.innerText=settings.lang.getValue("get_started"),n.appendChild(document.createElement("br"));let i=document.createElement("div");n.appendChild(i);let l=document.createElement("div");l.innerHTML=dev.settings.lang.getValue("get_started_1",!1),i.appendChild(l),i.appendChild(document.createElement("br"));let o=document.createElement("pre");o.style="white-space: pre-wrap;background-color: #f0f0f0;padding: 5px;",o.innerHTML="<code>https://api.yunnet.ru/{method}?key={access_key}&{param1}={value1}&{param2}={value2}</code>",i.appendChild(o);let r=document.createElement("div");r.classList.add("card"),r.classList.add("full_section");let d=document.createElement("div");r.appendChild(d),d.style.width="100%",d.classList.add("center");let u=document.createElement("b");d.appendChild(u),u.innerText=dev.settings.lang.getValue("get_keys",!1),r.appendChild(document.createElement("br"));let c=document.createElement("div");r.appendChild(c);let p=document.createElement("div");p.innerHTML=dev.settings.lang.getValue("get_started_2",!1),c.appendChild(p);let g=document.createElement("div");g.classList.add("card"),g.classList.add("full_section");let m=document.createElement("div");g.appendChild(m),m.style.width="100%",m.classList.add("center");let h=document.createElement("b");m.appendChild(h),h.innerText=dev.settings.lang.getValue("apps_and_bots",!1),g.appendChild(document.createElement("br"));let f=document.createElement("div");g.appendChild(f);let b=document.createElement("div");b.innerHTML=dev.settings.lang.getValue("get_started_3",!1),f.appendChild(b),e.appendChild(n),e.appendChild(r),e.appendChild(g)}}};